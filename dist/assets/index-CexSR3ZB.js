import{r as Af,g as Tf,a as vg}from"./react-vendor-Bzgz95E1.js";import{G as Nr,p as jg,g as tc}from"./pdfjs-B2i6sGUR.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const g of m.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&o(g)}).observe(document,{childList:!0,subtree:!0});function x(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function o(d){if(d.ep)return;d.ep=!0;const m=x(d);fetch(d.href,m)}})();var Zo={exports:{}},Ys={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gf;function wg(){if(gf)return Ys;gf=1;var i=Symbol.for("react.transitional.element"),f=Symbol.for("react.fragment");function x(o,d,m){var g=null;if(m!==void 0&&(g=""+m),d.key!==void 0&&(g=""+d.key),"key"in d){m={};for(var b in d)b!=="key"&&(m[b]=d[b])}else m=d;return d=m.ref,{$$typeof:i,type:o,key:g,ref:d!==void 0?d:null,props:m}}return Ys.Fragment=f,Ys.jsx=x,Ys.jsxs=x,Ys}var xf;function Ng(){return xf||(xf=1,Zo.exports=wg()),Zo.exports}var a=Ng(),u=Af();const Vt=Tf(u);var Jo={exports:{}},Xs={},Ko={exports:{}},$o={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bf;function kg(){return bf||(bf=1,(function(i){function f(O,q){var J=O.length;O.push(q);e:for(;0<J;){var le=J-1>>>1,te=O[le];if(0<d(te,q))O[le]=q,O[J]=te,J=le;else break e}}function x(O){return O.length===0?null:O[0]}function o(O){if(O.length===0)return null;var q=O[0],J=O.pop();if(J!==q){O[0]=J;e:for(var le=0,te=O.length,ne=te>>>1;le<ne;){var se=2*(le+1)-1,re=O[se],ve=se+1,ae=O[ve];if(0>d(re,J))ve<te&&0>d(ae,re)?(O[le]=ae,O[ve]=J,le=ve):(O[le]=re,O[se]=J,le=se);else if(ve<te&&0>d(ae,J))O[le]=ae,O[ve]=J,le=ve;else break e}}return q}function d(O,q){var J=O.sortIndex-q.sortIndex;return J!==0?J:O.id-q.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;i.unstable_now=function(){return m.now()}}else{var g=Date,b=g.now();i.unstable_now=function(){return g.now()-b}}var k=[],j=[],S=1,p=null,T=3,y=!1,v=!1,z=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function N(O){for(var q=x(j);q!==null;){if(q.callback===null)o(j);else if(q.startTime<=O)o(j),q.sortIndex=q.expirationTime,f(k,q);else break;q=x(j)}}function D(O){if(z=!1,N(O),!v)if(x(k)!==null)v=!0,_||(_=!0,I());else{var q=x(j);q!==null&&V(D,q.startTime-O)}}var _=!1,K=-1,X=5,L=-1;function M(){return C?!0:!(i.unstable_now()-L<X)}function B(){if(C=!1,_){var O=i.unstable_now();L=O;var q=!0;try{e:{v=!1,z&&(z=!1,U(K),K=-1),y=!0;var J=T;try{t:{for(N(O),p=x(k);p!==null&&!(p.expirationTime>O&&M());){var le=p.callback;if(typeof le=="function"){p.callback=null,T=p.priorityLevel;var te=le(p.expirationTime<=O);if(O=i.unstable_now(),typeof te=="function"){p.callback=te,N(O),q=!0;break t}p===x(k)&&o(k),N(O)}else o(k);p=x(k)}if(p!==null)q=!0;else{var ne=x(j);ne!==null&&V(D,ne.startTime-O),q=!1}}break e}finally{p=null,T=J,y=!1}q=void 0}}finally{q?I():_=!1}}}var I;if(typeof w=="function")I=function(){w(B)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,ee=G.port2;G.port1.onmessage=B,I=function(){ee.postMessage(null)}}else I=function(){E(B,0)};function V(O,q){K=E(function(){O(i.unstable_now())},q)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(O){O.callback=null},i.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<O?Math.floor(1e3/O):5},i.unstable_getCurrentPriorityLevel=function(){return T},i.unstable_next=function(O){switch(T){case 1:case 2:case 3:var q=3;break;default:q=T}var J=T;T=q;try{return O()}finally{T=J}},i.unstable_requestPaint=function(){C=!0},i.unstable_runWithPriority=function(O,q){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var J=T;T=O;try{return q()}finally{T=J}},i.unstable_scheduleCallback=function(O,q,J){var le=i.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?le+J:le):J=le,O){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=J+te,O={id:S++,callback:q,priorityLevel:O,startTime:J,expirationTime:te,sortIndex:-1},J>le?(O.sortIndex=J,f(j,O),x(k)===null&&O===x(j)&&(z?(U(K),K=-1):z=!0,V(D,J-le))):(O.sortIndex=te,f(k,O),v||y||(v=!0,_||(_=!0,I()))),O},i.unstable_shouldYield=M,i.unstable_wrapCallback=function(O){var q=T;return function(){var J=T;T=q;try{return O.apply(this,arguments)}finally{T=J}}}})($o)),$o}var yf;function Sg(){return yf||(yf=1,Ko.exports=kg()),Ko.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pf;function Cg(){if(pf)return Xs;pf=1;var i=Sg(),f=Af(),x=vg();function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)t+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function m(e){var t=e,l=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(l=t.return),e=t.return;while(e)}return t.tag===3?l:null}function g(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function b(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function k(e){if(m(e)!==e)throw Error(o(188))}function j(e){var t=e.alternate;if(!t){if(t=m(e),t===null)throw Error(o(188));return t!==e?null:e}for(var l=e,s=t;;){var n=l.return;if(n===null)break;var r=n.alternate;if(r===null){if(s=n.return,s!==null){l=s;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===l)return k(n),e;if(r===s)return k(n),t;r=r.sibling}throw Error(o(188))}if(l.return!==s.return)l=n,s=r;else{for(var c=!1,h=n.child;h;){if(h===l){c=!0,l=n,s=r;break}if(h===s){c=!0,s=n,l=r;break}h=h.sibling}if(!c){for(h=r.child;h;){if(h===l){c=!0,l=r,s=n;break}if(h===s){c=!0,s=r,l=n;break}h=h.sibling}if(!c)throw Error(o(189))}}if(l.alternate!==s)throw Error(o(190))}if(l.tag!==3)throw Error(o(188));return l.stateNode.current===l?e:t}function S(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=S(e),t!==null)return t;e=e.sibling}return null}var p=Object.assign,T=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),w=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function I(e){return e===null||typeof e!="object"?null:(e=B&&e[B]||e["@@iterator"],typeof e=="function"?e:null)}var G=Symbol.for("react.client.reference");function ee(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===G?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case z:return"Fragment";case E:return"Profiler";case C:return"StrictMode";case D:return"Suspense";case _:return"SuspenseList";case L:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case w:return e.displayName||"Context";case U:return(e._context.displayName||"Context")+".Consumer";case N:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case K:return t=e.displayName||null,t!==null?t:ee(e.type)||"Memo";case X:t=e._payload,e=e._init;try{return ee(e(t))}catch{}}return null}var V=Array.isArray,O=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=x.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},le=[],te=-1;function ne(e){return{current:e}}function se(e){0>te||(e.current=le[te],le[te]=null,te--)}function re(e,t){te++,le[te]=e.current,e.current=t}var ve=ne(null),ae=ne(null),pe=ne(null),Pe=ne(null);function Le(e,t){switch(re(pe,t),re(ae,e),re(ve,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?_0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=_0(t),e=B0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}se(ve),re(ve,e)}function ca(){se(ve),se(ae),se(pe)}function Er(e){e.memoizedState!==null&&re(Pe,e);var t=ve.current,l=B0(t,e.type);t!==l&&(re(ae,e),re(ve,l))}function en(e){ae.current===e&&(se(ve),se(ae)),Pe.current===e&&(se(Pe),Vs._currentValue=J)}var Ar,mc;function Vl(e){if(Ar===void 0)try{throw Error()}catch(l){var t=l.stack.trim().match(/\n( *(at )?)/);Ar=t&&t[1]||"",mc=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ar+e+mc}var Tr=!1;function zr(e,t){if(!e||Tr)return"";Tr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var P=function(){throw Error()};if(Object.defineProperty(P.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(P,[])}catch(Z){var Y=Z}Reflect.construct(e,[],P)}else{try{P.call()}catch(Z){Y=Z}e.call(P.prototype)}}else{try{throw Error()}catch(Z){Y=Z}(P=e())&&typeof P.catch=="function"&&P.catch(function(){})}}catch(Z){if(Z&&Y&&typeof Z.stack=="string")return[Z.stack,Y.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=s.DetermineComponentFrameRoot(),c=r[0],h=r[1];if(c&&h){var A=c.split(`
`),F=h.split(`
`);for(n=s=0;s<A.length&&!A[s].includes("DetermineComponentFrameRoot");)s++;for(;n<F.length&&!F[n].includes("DetermineComponentFrameRoot");)n++;if(s===A.length||n===F.length)for(s=A.length-1,n=F.length-1;1<=s&&0<=n&&A[s]!==F[n];)n--;for(;1<=s&&0<=n;s--,n--)if(A[s]!==F[n]){if(s!==1||n!==1)do if(s--,n--,0>n||A[s]!==F[n]){var $=`
`+A[s].replace(" at new "," at ");return e.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",e.displayName)),$}while(1<=s&&0<=n);break}}}finally{Tr=!1,Error.prepareStackTrace=l}return(l=e?e.displayName||e.name:"")?Vl(l):""}function Wf(e,t){switch(e.tag){case 26:case 27:case 5:return Vl(e.type);case 16:return Vl("Lazy");case 13:return e.child!==t&&t!==null?Vl("Suspense Fallback"):Vl("Suspense");case 19:return Vl("SuspenseList");case 0:case 15:return zr(e.type,!1);case 11:return zr(e.type.render,!1);case 1:return zr(e.type,!0);case 31:return Vl("Activity");default:return""}}function hc(e){try{var t="",l=null;do t+=Wf(e,l),l=e,e=e.return;while(e);return t}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var Ur=Object.prototype.hasOwnProperty,Mr=i.unstable_scheduleCallback,Lr=i.unstable_cancelCallback,Pf=i.unstable_shouldYield,If=i.unstable_requestPaint,dt=i.unstable_now,em=i.unstable_getCurrentPriorityLevel,gc=i.unstable_ImmediatePriority,xc=i.unstable_UserBlockingPriority,tn=i.unstable_NormalPriority,tm=i.unstable_LowPriority,bc=i.unstable_IdlePriority,lm=i.log,am=i.unstable_setDisableYieldValue,Ia=null,ut=null;function gl(e){if(typeof lm=="function"&&am(e),ut&&typeof ut.setStrictMode=="function")try{ut.setStrictMode(Ia,e)}catch{}}var ft=Math.clz32?Math.clz32:rm,sm=Math.log,nm=Math.LN2;function rm(e){return e>>>=0,e===0?32:31-(sm(e)/nm|0)|0}var ln=256,an=262144,sn=4194304;function Ql(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function nn(e,t,l){var s=e.pendingLanes;if(s===0)return 0;var n=0,r=e.suspendedLanes,c=e.pingedLanes;e=e.warmLanes;var h=s&134217727;return h!==0?(s=h&~r,s!==0?n=Ql(s):(c&=h,c!==0?n=Ql(c):l||(l=h&~e,l!==0&&(n=Ql(l))))):(h=s&~r,h!==0?n=Ql(h):c!==0?n=Ql(c):l||(l=s&~e,l!==0&&(n=Ql(l)))),n===0?0:t!==0&&t!==n&&(t&r)===0&&(r=n&-n,l=t&-t,r>=l||r===32&&(l&4194048)!==0)?t:n}function es(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function im(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yc(){var e=sn;return sn<<=1,(sn&62914560)===0&&(sn=4194304),e}function Or(e){for(var t=[],l=0;31>l;l++)t.push(e);return t}function ts(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function om(e,t,l,s,n,r){var c=e.pendingLanes;e.pendingLanes=l,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=l,e.entangledLanes&=l,e.errorRecoveryDisabledLanes&=l,e.shellSuspendCounter=0;var h=e.entanglements,A=e.expirationTimes,F=e.hiddenUpdates;for(l=c&~l;0<l;){var $=31-ft(l),P=1<<$;h[$]=0,A[$]=-1;var Y=F[$];if(Y!==null)for(F[$]=null,$=0;$<Y.length;$++){var Z=Y[$];Z!==null&&(Z.lane&=-536870913)}l&=~P}s!==0&&pc(e,s,0),r!==0&&n===0&&e.tag!==0&&(e.suspendedLanes|=r&~(c&~t))}function pc(e,t,l){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-ft(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|l&261930}function vc(e,t){var l=e.entangledLanes|=t;for(e=e.entanglements;l;){var s=31-ft(l),n=1<<s;n&t|e[s]&t&&(e[s]|=t),l&=~n}}function jc(e,t){var l=t&-t;return l=(l&42)!==0?1:Dr(l),(l&(e.suspendedLanes|t))!==0?0:l}function Dr(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Rr(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function wc(){var e=q.p;return e!==0?e:(e=window.event,e===void 0?32:of(e.type))}function Nc(e,t){var l=q.p;try{return q.p=e,t()}finally{q.p=l}}var xl=Math.random().toString(36).slice(2),Ze="__reactFiber$"+xl,lt="__reactProps$"+xl,da="__reactContainer$"+xl,_r="__reactEvents$"+xl,cm="__reactListeners$"+xl,dm="__reactHandles$"+xl,kc="__reactResources$"+xl,ls="__reactMarker$"+xl;function Br(e){delete e[Ze],delete e[lt],delete e[_r],delete e[cm],delete e[dm]}function ua(e){var t=e[Ze];if(t)return t;for(var l=e.parentNode;l;){if(t=l[da]||l[Ze]){if(l=t.alternate,t.child!==null||l!==null&&l.child!==null)for(e=Y0(e);e!==null;){if(l=e[Ze])return l;e=Y0(e)}return t}e=l,l=e.parentNode}return null}function fa(e){if(e=e[Ze]||e[da]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function as(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(o(33))}function ma(e){var t=e[kc];return t||(t=e[kc]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ge(e){e[ls]=!0}var Sc=new Set,Cc={};function Fl(e,t){ha(e,t),ha(e+"Capture",t)}function ha(e,t){for(Cc[e]=t,e=0;e<t.length;e++)Sc.add(t[e])}var um=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ec={},Ac={};function fm(e){return Ur.call(Ac,e)?!0:Ur.call(Ec,e)?!1:um.test(e)?Ac[e]=!0:(Ec[e]=!0,!1)}function rn(e,t,l){if(fm(t))if(l===null)e.removeAttribute(t);else{switch(typeof l){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+l)}}function on(e,t,l){if(l===null)e.removeAttribute(t);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+l)}}function Ft(e,t,l,s){if(s===null)e.removeAttribute(l);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(l);return}e.setAttributeNS(t,l,""+s)}}function vt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Tc(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function mm(e,t,l){var s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var n=s.get,r=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(c){l=""+c,r.call(this,c)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(c){l=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hr(e){if(!e._valueTracker){var t=Tc(e)?"checked":"value";e._valueTracker=mm(e,t,""+e[t])}}function zc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var l=t.getValue(),s="";return e&&(s=Tc(e)?e.checked?"true":"false":e.value),e=s,e!==l?(t.setValue(e),!0):!1}function cn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var hm=/[\n"\\]/g;function jt(e){return e.replace(hm,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function qr(e,t,l,s,n,r,c,h){e.name="",c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"?e.type=c:e.removeAttribute("type"),t!=null?c==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+vt(t)):e.value!==""+vt(t)&&(e.value=""+vt(t)):c!=="submit"&&c!=="reset"||e.removeAttribute("value"),t!=null?Vr(e,c,vt(t)):l!=null?Vr(e,c,vt(l)):s!=null&&e.removeAttribute("value"),n==null&&r!=null&&(e.defaultChecked=!!r),n!=null&&(e.checked=n&&typeof n!="function"&&typeof n!="symbol"),h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"?e.name=""+vt(h):e.removeAttribute("name")}function Uc(e,t,l,s,n,r,c,h){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(e.type=r),t!=null||l!=null){if(!(r!=="submit"&&r!=="reset"||t!=null)){Hr(e);return}l=l!=null?""+vt(l):"",t=t!=null?""+vt(t):l,h||t===e.value||(e.value=t),e.defaultValue=t}s=s??n,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=h?e.checked:!!s,e.defaultChecked=!!s,c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"&&(e.name=c),Hr(e)}function Vr(e,t,l){t==="number"&&cn(e.ownerDocument)===e||e.defaultValue===""+l||(e.defaultValue=""+l)}function ga(e,t,l,s){if(e=e.options,t){t={};for(var n=0;n<l.length;n++)t["$"+l[n]]=!0;for(l=0;l<e.length;l++)n=t.hasOwnProperty("$"+e[l].value),e[l].selected!==n&&(e[l].selected=n),n&&s&&(e[l].defaultSelected=!0)}else{for(l=""+vt(l),t=null,n=0;n<e.length;n++){if(e[n].value===l){e[n].selected=!0,s&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function Mc(e,t,l){if(t!=null&&(t=""+vt(t),t!==e.value&&(e.value=t),l==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=l!=null?""+vt(l):""}function Lc(e,t,l,s){if(t==null){if(s!=null){if(l!=null)throw Error(o(92));if(V(s)){if(1<s.length)throw Error(o(93));s=s[0]}l=s}l==null&&(l=""),t=l}l=vt(t),e.defaultValue=l,s=e.textContent,s===l&&s!==""&&s!==null&&(e.value=s),Hr(e)}function xa(e,t){if(t){var l=e.firstChild;if(l&&l===e.lastChild&&l.nodeType===3){l.nodeValue=t;return}}e.textContent=t}var gm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Oc(e,t,l){var s=t.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,l):typeof l!="number"||l===0||gm.has(t)?t==="float"?e.cssFloat=l:e[t]=(""+l).trim():e[t]=l+"px"}function Dc(e,t,l){if(t!=null&&typeof t!="object")throw Error(o(62));if(e=e.style,l!=null){for(var s in l)!l.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var n in t)s=t[n],t.hasOwnProperty(n)&&l[n]!==s&&Oc(e,n,s)}else for(var r in t)t.hasOwnProperty(r)&&Oc(e,r,t[r])}function Qr(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),bm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dn(e){return bm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Gt(){}var Fr=null;function Gr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ba=null,ya=null;function Rc(e){var t=fa(e);if(t&&(e=t.stateNode)){var l=e[lt]||null;e:switch(e=t.stateNode,t.type){case"input":if(qr(e,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),t=l.name,l.type==="radio"&&t!=null){for(l=e;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+jt(""+t)+'"][type="radio"]'),t=0;t<l.length;t++){var s=l[t];if(s!==e&&s.form===e.form){var n=s[lt]||null;if(!n)throw Error(o(90));qr(s,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<l.length;t++)s=l[t],s.form===e.form&&zc(s)}break e;case"textarea":Mc(e,l.value,l.defaultValue);break e;case"select":t=l.value,t!=null&&ga(e,!!l.multiple,t,!1)}}}var Yr=!1;function _c(e,t,l){if(Yr)return e(t,l);Yr=!0;try{var s=e(t);return s}finally{if(Yr=!1,(ba!==null||ya!==null)&&(Wn(),ba&&(t=ba,e=ya,ya=ba=null,Rc(t),e)))for(t=0;t<e.length;t++)Rc(e[t])}}function ss(e,t){var l=e.stateNode;if(l===null)return null;var s=l[lt]||null;if(s===null)return null;l=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(l&&typeof l!="function")throw Error(o(231,t,typeof l));return l}var Yt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xr=!1;if(Yt)try{var ns={};Object.defineProperty(ns,"passive",{get:function(){Xr=!0}}),window.addEventListener("test",ns,ns),window.removeEventListener("test",ns,ns)}catch{Xr=!1}var bl=null,Zr=null,un=null;function Bc(){if(un)return un;var e,t=Zr,l=t.length,s,n="value"in bl?bl.value:bl.textContent,r=n.length;for(e=0;e<l&&t[e]===n[e];e++);var c=l-e;for(s=1;s<=c&&t[l-s]===n[r-s];s++);return un=n.slice(e,1<s?1-s:void 0)}function fn(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function mn(){return!0}function Hc(){return!1}function at(e){function t(l,s,n,r,c){this._reactName=l,this._targetInst=n,this.type=s,this.nativeEvent=r,this.target=c,this.currentTarget=null;for(var h in e)e.hasOwnProperty(h)&&(l=e[h],this[h]=l?l(r):r[h]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?mn:Hc,this.isPropagationStopped=Hc,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=mn)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=mn)},persist:function(){},isPersistent:mn}),t}var Gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=at(Gl),rs=p({},Gl,{view:0,detail:0}),ym=at(rs),Jr,Kr,is,gn=p({},rs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wr,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==is&&(is&&e.type==="mousemove"?(Jr=e.screenX-is.screenX,Kr=e.screenY-is.screenY):Kr=Jr=0,is=e),Jr)},movementY:function(e){return"movementY"in e?e.movementY:Kr}}),qc=at(gn),pm=p({},gn,{dataTransfer:0}),vm=at(pm),jm=p({},rs,{relatedTarget:0}),$r=at(jm),wm=p({},Gl,{animationName:0,elapsedTime:0,pseudoElement:0}),Nm=at(wm),km=p({},Gl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Sm=at(km),Cm=p({},Gl,{data:0}),Vc=at(Cm),Em={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Am={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Tm[e])?!!t[e]:!1}function Wr(){return zm}var Um=p({},rs,{key:function(e){if(e.key){var t=Em[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=fn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Am[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wr,charCode:function(e){return e.type==="keypress"?fn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?fn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Mm=at(Um),Lm=p({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qc=at(Lm),Om=p({},rs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wr}),Dm=at(Om),Rm=p({},Gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),_m=at(Rm),Bm=p({},gn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Hm=at(Bm),qm=p({},Gl,{newState:0,oldState:0}),Vm=at(qm),Qm=[9,13,27,32],Pr=Yt&&"CompositionEvent"in window,os=null;Yt&&"documentMode"in document&&(os=document.documentMode);var Fm=Yt&&"TextEvent"in window&&!os,Fc=Yt&&(!Pr||os&&8<os&&11>=os),Gc=" ",Yc=!1;function Xc(e,t){switch(e){case"keyup":return Qm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pa=!1;function Gm(e,t){switch(e){case"compositionend":return Zc(t);case"keypress":return t.which!==32?null:(Yc=!0,Gc);case"textInput":return e=t.data,e===Gc&&Yc?null:e;default:return null}}function Ym(e,t){if(pa)return e==="compositionend"||!Pr&&Xc(e,t)?(e=Bc(),un=Zr=bl=null,pa=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fc&&t.locale!=="ko"?null:t.data;default:return null}}var Xm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xm[e.type]:t==="textarea"}function Kc(e,t,l,s){ba?ya?ya.push(s):ya=[s]:ba=s,t=sr(t,"onChange"),0<t.length&&(l=new hn("onChange","change",null,l,s),e.push({event:l,listeners:t}))}var cs=null,ds=null;function Zm(e){U0(e,0)}function xn(e){var t=as(e);if(zc(t))return e}function $c(e,t){if(e==="change")return t}var Wc=!1;if(Yt){var Ir;if(Yt){var ei="oninput"in document;if(!ei){var Pc=document.createElement("div");Pc.setAttribute("oninput","return;"),ei=typeof Pc.oninput=="function"}Ir=ei}else Ir=!1;Wc=Ir&&(!document.documentMode||9<document.documentMode)}function Ic(){cs&&(cs.detachEvent("onpropertychange",ed),ds=cs=null)}function ed(e){if(e.propertyName==="value"&&xn(ds)){var t=[];Kc(t,ds,e,Gr(e)),_c(Zm,t)}}function Jm(e,t,l){e==="focusin"?(Ic(),cs=t,ds=l,cs.attachEvent("onpropertychange",ed)):e==="focusout"&&Ic()}function Km(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xn(ds)}function $m(e,t){if(e==="click")return xn(t)}function Wm(e,t){if(e==="input"||e==="change")return xn(t)}function Pm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mt=typeof Object.is=="function"?Object.is:Pm;function us(e,t){if(mt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var l=Object.keys(e),s=Object.keys(t);if(l.length!==s.length)return!1;for(s=0;s<l.length;s++){var n=l[s];if(!Ur.call(t,n)||!mt(e[n],t[n]))return!1}return!0}function td(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ld(e,t){var l=td(e);e=0;for(var s;l;){if(l.nodeType===3){if(s=e+l.textContent.length,e<=t&&s>=t)return{node:l,offset:t-e};e=s}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=td(l)}}function ad(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ad(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function sd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=cn(e.document);t instanceof e.HTMLIFrameElement;){try{var l=typeof t.contentWindow.location.href=="string"}catch{l=!1}if(l)e=t.contentWindow;else break;t=cn(e.document)}return t}function ti(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Im=Yt&&"documentMode"in document&&11>=document.documentMode,va=null,li=null,fs=null,ai=!1;function nd(e,t,l){var s=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ai||va==null||va!==cn(s)||(s=va,"selectionStart"in s&&ti(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),fs&&us(fs,s)||(fs=s,s=sr(li,"onSelect"),0<s.length&&(t=new hn("onSelect","select",null,t,l),e.push({event:t,listeners:s}),t.target=va)))}function Yl(e,t){var l={};return l[e.toLowerCase()]=t.toLowerCase(),l["Webkit"+e]="webkit"+t,l["Moz"+e]="moz"+t,l}var ja={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionrun:Yl("Transition","TransitionRun"),transitionstart:Yl("Transition","TransitionStart"),transitioncancel:Yl("Transition","TransitionCancel"),transitionend:Yl("Transition","TransitionEnd")},si={},rd={};Yt&&(rd=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);function Xl(e){if(si[e])return si[e];if(!ja[e])return e;var t=ja[e],l;for(l in t)if(t.hasOwnProperty(l)&&l in rd)return si[e]=t[l];return e}var id=Xl("animationend"),od=Xl("animationiteration"),cd=Xl("animationstart"),eh=Xl("transitionrun"),th=Xl("transitionstart"),lh=Xl("transitioncancel"),dd=Xl("transitionend"),ud=new Map,ni="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ni.push("scrollEnd");function Lt(e,t){ud.set(e,t),Fl(t,[e])}var bn=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},wt=[],wa=0,ri=0;function yn(){for(var e=wa,t=ri=wa=0;t<e;){var l=wt[t];wt[t++]=null;var s=wt[t];wt[t++]=null;var n=wt[t];wt[t++]=null;var r=wt[t];if(wt[t++]=null,s!==null&&n!==null){var c=s.pending;c===null?n.next=n:(n.next=c.next,c.next=n),s.pending=n}r!==0&&fd(l,n,r)}}function pn(e,t,l,s){wt[wa++]=e,wt[wa++]=t,wt[wa++]=l,wt[wa++]=s,ri|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function ii(e,t,l,s){return pn(e,t,l,s),vn(e)}function Zl(e,t){return pn(e,null,null,t),vn(e)}function fd(e,t,l){e.lanes|=l;var s=e.alternate;s!==null&&(s.lanes|=l);for(var n=!1,r=e.return;r!==null;)r.childLanes|=l,s=r.alternate,s!==null&&(s.childLanes|=l),r.tag===22&&(e=r.stateNode,e===null||e._visibility&1||(n=!0)),e=r,r=r.return;return e.tag===3?(r=e.stateNode,n&&t!==null&&(n=31-ft(l),e=r.hiddenUpdates,s=e[n],s===null?e[n]=[t]:s.push(t),t.lane=l|536870912),r):null}function vn(e){if(50<Os)throw Os=0,bo=null,Error(o(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Na={};function ah(e,t,l,s){this.tag=e,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ht(e,t,l,s){return new ah(e,t,l,s)}function oi(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Xt(e,t){var l=e.alternate;return l===null?(l=ht(e.tag,t,e.key,e.mode),l.elementType=e.elementType,l.type=e.type,l.stateNode=e.stateNode,l.alternate=e,e.alternate=l):(l.pendingProps=t,l.type=e.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=e.flags&65011712,l.childLanes=e.childLanes,l.lanes=e.lanes,l.child=e.child,l.memoizedProps=e.memoizedProps,l.memoizedState=e.memoizedState,l.updateQueue=e.updateQueue,t=e.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},l.sibling=e.sibling,l.index=e.index,l.ref=e.ref,l.refCleanup=e.refCleanup,l}function md(e,t){e.flags&=65011714;var l=e.alternate;return l===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=l.childLanes,e.lanes=l.lanes,e.child=l.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=l.memoizedProps,e.memoizedState=l.memoizedState,e.updateQueue=l.updateQueue,e.type=l.type,t=l.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function jn(e,t,l,s,n,r){var c=0;if(s=e,typeof e=="function")oi(e)&&(c=1);else if(typeof e=="string")c=og(e,l,ve.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case L:return e=ht(31,l,t,n),e.elementType=L,e.lanes=r,e;case z:return Jl(l.children,n,r,t);case C:c=8,n|=24;break;case E:return e=ht(12,l,t,n|2),e.elementType=E,e.lanes=r,e;case D:return e=ht(13,l,t,n),e.elementType=D,e.lanes=r,e;case _:return e=ht(19,l,t,n),e.elementType=_,e.lanes=r,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case w:c=10;break e;case U:c=9;break e;case N:c=11;break e;case K:c=14;break e;case X:c=16,s=null;break e}c=29,l=Error(o(130,e===null?"null":typeof e,"")),s=null}return t=ht(c,l,t,n),t.elementType=e,t.type=s,t.lanes=r,t}function Jl(e,t,l,s){return e=ht(7,e,s,t),e.lanes=l,e}function ci(e,t,l){return e=ht(6,e,null,t),e.lanes=l,e}function hd(e){var t=ht(18,null,null,0);return t.stateNode=e,t}function di(e,t,l){return t=ht(4,e.children!==null?e.children:[],e.key,t),t.lanes=l,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var gd=new WeakMap;function Nt(e,t){if(typeof e=="object"&&e!==null){var l=gd.get(e);return l!==void 0?l:(t={value:e,source:t,stack:hc(t)},gd.set(e,t),t)}return{value:e,source:t,stack:hc(t)}}var ka=[],Sa=0,wn=null,ms=0,kt=[],St=0,yl=null,_t=1,Bt="";function Zt(e,t){ka[Sa++]=ms,ka[Sa++]=wn,wn=e,ms=t}function xd(e,t,l){kt[St++]=_t,kt[St++]=Bt,kt[St++]=yl,yl=e;var s=_t;e=Bt;var n=32-ft(s)-1;s&=~(1<<n),l+=1;var r=32-ft(t)+n;if(30<r){var c=n-n%5;r=(s&(1<<c)-1).toString(32),s>>=c,n-=c,_t=1<<32-ft(t)+n|l<<n|s,Bt=r+e}else _t=1<<r|l<<n|s,Bt=e}function ui(e){e.return!==null&&(Zt(e,1),xd(e,1,0))}function fi(e){for(;e===wn;)wn=ka[--Sa],ka[Sa]=null,ms=ka[--Sa],ka[Sa]=null;for(;e===yl;)yl=kt[--St],kt[St]=null,Bt=kt[--St],kt[St]=null,_t=kt[--St],kt[St]=null}function bd(e,t){kt[St++]=_t,kt[St++]=Bt,kt[St++]=yl,_t=t.id,Bt=t.overflow,yl=e}var Je=null,Ue=null,be=!1,pl=null,Ct=!1,mi=Error(o(519));function vl(e){var t=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hs(Nt(t,e)),mi}function yd(e){var t=e.stateNode,l=e.type,s=e.memoizedProps;switch(t[Ze]=e,t[lt]=s,l){case"dialog":he("cancel",t),he("close",t);break;case"iframe":case"object":case"embed":he("load",t);break;case"video":case"audio":for(l=0;l<Rs.length;l++)he(Rs[l],t);break;case"source":he("error",t);break;case"img":case"image":case"link":he("error",t),he("load",t);break;case"details":he("toggle",t);break;case"input":he("invalid",t),Uc(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":he("invalid",t);break;case"textarea":he("invalid",t),Lc(t,s.value,s.defaultValue,s.children)}l=s.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||t.textContent===""+l||s.suppressHydrationWarning===!0||D0(t.textContent,l)?(s.popover!=null&&(he("beforetoggle",t),he("toggle",t)),s.onScroll!=null&&he("scroll",t),s.onScrollEnd!=null&&he("scrollend",t),s.onClick!=null&&(t.onclick=Gt),t=!0):t=!1,t||vl(e,!0)}function pd(e){for(Je=e.return;Je;)switch(Je.tag){case 5:case 31:case 13:Ct=!1;return;case 27:case 3:Ct=!0;return;default:Je=Je.return}}function Ca(e){if(e!==Je)return!1;if(!be)return pd(e),be=!0,!1;var t=e.tag,l;if((l=t!==3&&t!==27)&&((l=t===5)&&(l=e.type,l=!(l!=="form"&&l!=="button")||Mo(e.type,e.memoizedProps)),l=!l),l&&Ue&&vl(e),pd(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Ue=G0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Ue=G0(e)}else t===27?(t=Ue,Ol(e.type)?(e=_o,_o=null,Ue=e):Ue=t):Ue=Je?At(e.stateNode.nextSibling):null;return!0}function Kl(){Ue=Je=null,be=!1}function hi(){var e=pl;return e!==null&&(it===null?it=e:it.push.apply(it,e),pl=null),e}function hs(e){pl===null?pl=[e]:pl.push(e)}var gi=ne(null),$l=null,Jt=null;function jl(e,t,l){re(gi,t._currentValue),t._currentValue=l}function Kt(e){e._currentValue=gi.current,se(gi)}function xi(e,t,l){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===l)break;e=e.return}}function bi(e,t,l,s){var n=e.child;for(n!==null&&(n.return=e);n!==null;){var r=n.dependencies;if(r!==null){var c=n.child;r=r.firstContext;e:for(;r!==null;){var h=r;r=n;for(var A=0;A<t.length;A++)if(h.context===t[A]){r.lanes|=l,h=r.alternate,h!==null&&(h.lanes|=l),xi(r.return,l,e),s||(c=null);break e}r=h.next}}else if(n.tag===18){if(c=n.return,c===null)throw Error(o(341));c.lanes|=l,r=c.alternate,r!==null&&(r.lanes|=l),xi(c,l,e),c=null}else c=n.child;if(c!==null)c.return=n;else for(c=n;c!==null;){if(c===e){c=null;break}if(n=c.sibling,n!==null){n.return=c.return,c=n;break}c=c.return}n=c}}function Ea(e,t,l,s){e=null;for(var n=t,r=!1;n!==null;){if(!r){if((n.flags&524288)!==0)r=!0;else if((n.flags&262144)!==0)break}if(n.tag===10){var c=n.alternate;if(c===null)throw Error(o(387));if(c=c.memoizedProps,c!==null){var h=n.type;mt(n.pendingProps.value,c.value)||(e!==null?e.push(h):e=[h])}}else if(n===Pe.current){if(c=n.alternate,c===null)throw Error(o(387));c.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(e!==null?e.push(Vs):e=[Vs])}n=n.return}e!==null&&bi(t,e,l,s),t.flags|=262144}function Nn(e){for(e=e.firstContext;e!==null;){if(!mt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Wl(e){$l=e,Jt=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ke(e){return vd($l,e)}function kn(e,t){return $l===null&&Wl(e),vd(e,t)}function vd(e,t){var l=t._currentValue;if(t={context:t,memoizedValue:l,next:null},Jt===null){if(e===null)throw Error(o(308));Jt=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Jt=Jt.next=t;return l}var sh=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(l,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(l){return l()})}},nh=i.unstable_scheduleCallback,rh=i.unstable_NormalPriority,He={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yi(){return{controller:new sh,data:new Map,refCount:0}}function gs(e){e.refCount--,e.refCount===0&&nh(rh,function(){e.controller.abort()})}var xs=null,pi=0,Aa=0,Ta=null;function ih(e,t){if(xs===null){var l=xs=[];pi=0,Aa=No(),Ta={status:"pending",value:void 0,then:function(s){l.push(s)}}}return pi++,t.then(jd,jd),t}function jd(){if(--pi===0&&xs!==null){Ta!==null&&(Ta.status="fulfilled");var e=xs;xs=null,Aa=0,Ta=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function oh(e,t){var l=[],s={status:"pending",value:null,reason:null,then:function(n){l.push(n)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var n=0;n<l.length;n++)(0,l[n])(t)},function(n){for(s.status="rejected",s.reason=n,n=0;n<l.length;n++)(0,l[n])(void 0)}),s}var wd=O.S;O.S=function(e,t){n0=dt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&ih(e,t),wd!==null&&wd(e,t)};var Pl=ne(null);function vi(){var e=Pl.current;return e!==null?e:ze.pooledCache}function Sn(e,t){t===null?re(Pl,Pl.current):re(Pl,t.pool)}function Nd(){var e=vi();return e===null?null:{parent:He._currentValue,pool:e}}var za=Error(o(460)),ji=Error(o(474)),Cn=Error(o(542)),En={then:function(){}};function kd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Sd(e,t,l){switch(l=e[l],l===void 0?e.push(t):l!==t&&(t.then(Gt,Gt),t=l),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ed(e),e;default:if(typeof t.status=="string")t.then(Gt,Gt);else{if(e=ze,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var n=t;n.status="fulfilled",n.value=s}},function(s){if(t.status==="pending"){var n=t;n.status="rejected",n.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ed(e),e}throw ea=t,za}}function Il(e){try{var t=e._init;return t(e._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ea=l,za):l}}var ea=null;function Cd(){if(ea===null)throw Error(o(459));var e=ea;return ea=null,e}function Ed(e){if(e===za||e===Cn)throw Error(o(483))}var Ua=null,bs=0;function An(e){var t=bs;return bs+=1,Ua===null&&(Ua=[]),Sd(Ua,e,t)}function ys(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Tn(e,t){throw t.$$typeof===T?Error(o(525)):(e=Object.prototype.toString.call(t),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Ad(e){function t(H,R){if(e){var Q=H.deletions;Q===null?(H.deletions=[R],H.flags|=16):Q.push(R)}}function l(H,R){if(!e)return null;for(;R!==null;)t(H,R),R=R.sibling;return null}function s(H){for(var R=new Map;H!==null;)H.key!==null?R.set(H.key,H):R.set(H.index,H),H=H.sibling;return R}function n(H,R){return H=Xt(H,R),H.index=0,H.sibling=null,H}function r(H,R,Q){return H.index=Q,e?(Q=H.alternate,Q!==null?(Q=Q.index,Q<R?(H.flags|=67108866,R):Q):(H.flags|=67108866,R)):(H.flags|=1048576,R)}function c(H){return e&&H.alternate===null&&(H.flags|=67108866),H}function h(H,R,Q,W){return R===null||R.tag!==6?(R=ci(Q,H.mode,W),R.return=H,R):(R=n(R,Q),R.return=H,R)}function A(H,R,Q,W){var ce=Q.type;return ce===z?$(H,R,Q.props.children,W,Q.key):R!==null&&(R.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===X&&Il(ce)===R.type)?(R=n(R,Q.props),ys(R,Q),R.return=H,R):(R=jn(Q.type,Q.key,Q.props,null,H.mode,W),ys(R,Q),R.return=H,R)}function F(H,R,Q,W){return R===null||R.tag!==4||R.stateNode.containerInfo!==Q.containerInfo||R.stateNode.implementation!==Q.implementation?(R=di(Q,H.mode,W),R.return=H,R):(R=n(R,Q.children||[]),R.return=H,R)}function $(H,R,Q,W,ce){return R===null||R.tag!==7?(R=Jl(Q,H.mode,W,ce),R.return=H,R):(R=n(R,Q),R.return=H,R)}function P(H,R,Q){if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return R=ci(""+R,H.mode,Q),R.return=H,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case y:return Q=jn(R.type,R.key,R.props,null,H.mode,Q),ys(Q,R),Q.return=H,Q;case v:return R=di(R,H.mode,Q),R.return=H,R;case X:return R=Il(R),P(H,R,Q)}if(V(R)||I(R))return R=Jl(R,H.mode,Q,null),R.return=H,R;if(typeof R.then=="function")return P(H,An(R),Q);if(R.$$typeof===w)return P(H,kn(H,R),Q);Tn(H,R)}return null}function Y(H,R,Q,W){var ce=R!==null?R.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return ce!==null?null:h(H,R,""+Q,W);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:return Q.key===ce?A(H,R,Q,W):null;case v:return Q.key===ce?F(H,R,Q,W):null;case X:return Q=Il(Q),Y(H,R,Q,W)}if(V(Q)||I(Q))return ce!==null?null:$(H,R,Q,W,null);if(typeof Q.then=="function")return Y(H,R,An(Q),W);if(Q.$$typeof===w)return Y(H,R,kn(H,Q),W);Tn(H,Q)}return null}function Z(H,R,Q,W,ce){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return H=H.get(Q)||null,h(R,H,""+W,ce);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case y:return H=H.get(W.key===null?Q:W.key)||null,A(R,H,W,ce);case v:return H=H.get(W.key===null?Q:W.key)||null,F(R,H,W,ce);case X:return W=Il(W),Z(H,R,Q,W,ce)}if(V(W)||I(W))return H=H.get(Q)||null,$(R,H,W,ce,null);if(typeof W.then=="function")return Z(H,R,Q,An(W),ce);if(W.$$typeof===w)return Z(H,R,Q,kn(R,W),ce);Tn(R,W)}return null}function ie(H,R,Q,W){for(var ce=null,je=null,oe=R,fe=R=0,xe=null;oe!==null&&fe<Q.length;fe++){oe.index>fe?(xe=oe,oe=null):xe=oe.sibling;var we=Y(H,oe,Q[fe],W);if(we===null){oe===null&&(oe=xe);break}e&&oe&&we.alternate===null&&t(H,oe),R=r(we,R,fe),je===null?ce=we:je.sibling=we,je=we,oe=xe}if(fe===Q.length)return l(H,oe),be&&Zt(H,fe),ce;if(oe===null){for(;fe<Q.length;fe++)oe=P(H,Q[fe],W),oe!==null&&(R=r(oe,R,fe),je===null?ce=oe:je.sibling=oe,je=oe);return be&&Zt(H,fe),ce}for(oe=s(oe);fe<Q.length;fe++)xe=Z(oe,H,fe,Q[fe],W),xe!==null&&(e&&xe.alternate!==null&&oe.delete(xe.key===null?fe:xe.key),R=r(xe,R,fe),je===null?ce=xe:je.sibling=xe,je=xe);return e&&oe.forEach(function(Hl){return t(H,Hl)}),be&&Zt(H,fe),ce}function de(H,R,Q,W){if(Q==null)throw Error(o(151));for(var ce=null,je=null,oe=R,fe=R=0,xe=null,we=Q.next();oe!==null&&!we.done;fe++,we=Q.next()){oe.index>fe?(xe=oe,oe=null):xe=oe.sibling;var Hl=Y(H,oe,we.value,W);if(Hl===null){oe===null&&(oe=xe);break}e&&oe&&Hl.alternate===null&&t(H,oe),R=r(Hl,R,fe),je===null?ce=Hl:je.sibling=Hl,je=Hl,oe=xe}if(we.done)return l(H,oe),be&&Zt(H,fe),ce;if(oe===null){for(;!we.done;fe++,we=Q.next())we=P(H,we.value,W),we!==null&&(R=r(we,R,fe),je===null?ce=we:je.sibling=we,je=we);return be&&Zt(H,fe),ce}for(oe=s(oe);!we.done;fe++,we=Q.next())we=Z(oe,H,fe,we.value,W),we!==null&&(e&&we.alternate!==null&&oe.delete(we.key===null?fe:we.key),R=r(we,R,fe),je===null?ce=we:je.sibling=we,je=we);return e&&oe.forEach(function(pg){return t(H,pg)}),be&&Zt(H,fe),ce}function Te(H,R,Q,W){if(typeof Q=="object"&&Q!==null&&Q.type===z&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:e:{for(var ce=Q.key;R!==null;){if(R.key===ce){if(ce=Q.type,ce===z){if(R.tag===7){l(H,R.sibling),W=n(R,Q.props.children),W.return=H,H=W;break e}}else if(R.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===X&&Il(ce)===R.type){l(H,R.sibling),W=n(R,Q.props),ys(W,Q),W.return=H,H=W;break e}l(H,R);break}else t(H,R);R=R.sibling}Q.type===z?(W=Jl(Q.props.children,H.mode,W,Q.key),W.return=H,H=W):(W=jn(Q.type,Q.key,Q.props,null,H.mode,W),ys(W,Q),W.return=H,H=W)}return c(H);case v:e:{for(ce=Q.key;R!==null;){if(R.key===ce)if(R.tag===4&&R.stateNode.containerInfo===Q.containerInfo&&R.stateNode.implementation===Q.implementation){l(H,R.sibling),W=n(R,Q.children||[]),W.return=H,H=W;break e}else{l(H,R);break}else t(H,R);R=R.sibling}W=di(Q,H.mode,W),W.return=H,H=W}return c(H);case X:return Q=Il(Q),Te(H,R,Q,W)}if(V(Q))return ie(H,R,Q,W);if(I(Q)){if(ce=I(Q),typeof ce!="function")throw Error(o(150));return Q=ce.call(Q),de(H,R,Q,W)}if(typeof Q.then=="function")return Te(H,R,An(Q),W);if(Q.$$typeof===w)return Te(H,R,kn(H,Q),W);Tn(H,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,R!==null&&R.tag===6?(l(H,R.sibling),W=n(R,Q),W.return=H,H=W):(l(H,R),W=ci(Q,H.mode,W),W.return=H,H=W),c(H)):l(H,R)}return function(H,R,Q,W){try{bs=0;var ce=Te(H,R,Q,W);return Ua=null,ce}catch(oe){if(oe===za||oe===Cn)throw oe;var je=ht(29,oe,null,H.mode);return je.lanes=W,je.return=H,je}finally{}}}var ta=Ad(!0),Td=Ad(!1),wl=!1;function wi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ni(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Nl(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function kl(e,t,l){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(Ne&2)!==0){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,t=vn(e),fd(e,null,l),t}return pn(e,s,t,l),vn(e)}function ps(e,t,l){if(t=t.updateQueue,t!==null&&(t=t.shared,(l&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,l|=s,t.lanes=l,vc(e,l)}}function ki(e,t){var l=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,l===s)){var n=null,r=null;if(l=l.firstBaseUpdate,l!==null){do{var c={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};r===null?n=r=c:r=r.next=c,l=l.next}while(l!==null);r===null?n=r=t:r=r.next=t}else n=r=t;l={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:s.shared,callbacks:s.callbacks},e.updateQueue=l;return}e=l.lastBaseUpdate,e===null?l.firstBaseUpdate=t:e.next=t,l.lastBaseUpdate=t}var Si=!1;function vs(){if(Si){var e=Ta;if(e!==null)throw e}}function js(e,t,l,s){Si=!1;var n=e.updateQueue;wl=!1;var r=n.firstBaseUpdate,c=n.lastBaseUpdate,h=n.shared.pending;if(h!==null){n.shared.pending=null;var A=h,F=A.next;A.next=null,c===null?r=F:c.next=F,c=A;var $=e.alternate;$!==null&&($=$.updateQueue,h=$.lastBaseUpdate,h!==c&&(h===null?$.firstBaseUpdate=F:h.next=F,$.lastBaseUpdate=A))}if(r!==null){var P=n.baseState;c=0,$=F=A=null,h=r;do{var Y=h.lane&-536870913,Z=Y!==h.lane;if(Z?(ge&Y)===Y:(s&Y)===Y){Y!==0&&Y===Aa&&(Si=!0),$!==null&&($=$.next={lane:0,tag:h.tag,payload:h.payload,callback:null,next:null});e:{var ie=e,de=h;Y=t;var Te=l;switch(de.tag){case 1:if(ie=de.payload,typeof ie=="function"){P=ie.call(Te,P,Y);break e}P=ie;break e;case 3:ie.flags=ie.flags&-65537|128;case 0:if(ie=de.payload,Y=typeof ie=="function"?ie.call(Te,P,Y):ie,Y==null)break e;P=p({},P,Y);break e;case 2:wl=!0}}Y=h.callback,Y!==null&&(e.flags|=64,Z&&(e.flags|=8192),Z=n.callbacks,Z===null?n.callbacks=[Y]:Z.push(Y))}else Z={lane:Y,tag:h.tag,payload:h.payload,callback:h.callback,next:null},$===null?(F=$=Z,A=P):$=$.next=Z,c|=Y;if(h=h.next,h===null){if(h=n.shared.pending,h===null)break;Z=h,h=Z.next,Z.next=null,n.lastBaseUpdate=Z,n.shared.pending=null}}while(!0);$===null&&(A=P),n.baseState=A,n.firstBaseUpdate=F,n.lastBaseUpdate=$,r===null&&(n.shared.lanes=0),Tl|=c,e.lanes=c,e.memoizedState=P}}function zd(e,t){if(typeof e!="function")throw Error(o(191,e));e.call(t)}function Ud(e,t){var l=e.callbacks;if(l!==null)for(e.callbacks=null,e=0;e<l.length;e++)zd(l[e],t)}var Ma=ne(null),zn=ne(0);function Md(e,t){e=sl,re(zn,e),re(Ma,t),sl=e|t.baseLanes}function Ci(){re(zn,sl),re(Ma,Ma.current)}function Ei(){sl=zn.current,se(Ma),se(zn)}var gt=ne(null),Et=null;function Sl(e){var t=e.alternate;re(_e,_e.current&1),re(gt,e),Et===null&&(t===null||Ma.current!==null||t.memoizedState!==null)&&(Et=e)}function Ai(e){re(_e,_e.current),re(gt,e),Et===null&&(Et=e)}function Ld(e){e.tag===22?(re(_e,_e.current),re(gt,e),Et===null&&(Et=e)):Cl()}function Cl(){re(_e,_e.current),re(gt,gt.current)}function xt(e){se(gt),Et===e&&(Et=null),se(_e)}var _e=ne(0);function Un(e){for(var t=e;t!==null;){if(t.tag===13){var l=t.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Do(l)||Ro(l)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $t=0,ue=null,Ee=null,qe=null,Mn=!1,La=!1,la=!1,Ln=0,ws=0,Oa=null,ch=0;function De(){throw Error(o(321))}function Ti(e,t){if(t===null)return!1;for(var l=0;l<t.length&&l<e.length;l++)if(!mt(e[l],t[l]))return!1;return!0}function zi(e,t,l,s,n,r){return $t=r,ue=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=e===null||e.memoizedState===null?xu:Yi,la=!1,r=l(s,n),la=!1,La&&(r=Dd(t,l,s,n)),Od(e),r}function Od(e){O.H=Ss;var t=Ee!==null&&Ee.next!==null;if($t=0,qe=Ee=ue=null,Mn=!1,ws=0,Oa=null,t)throw Error(o(300));e===null||Ve||(e=e.dependencies,e!==null&&Nn(e)&&(Ve=!0))}function Dd(e,t,l,s){ue=e;var n=0;do{if(La&&(Oa=null),ws=0,La=!1,25<=n)throw Error(o(301));if(n+=1,qe=Ee=null,e.updateQueue!=null){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}O.H=bu,r=t(l,s)}while(La);return r}function dh(){var e=O.H,t=e.useState()[0];return t=typeof t.then=="function"?Ns(t):t,e=e.useState()[0],(Ee!==null?Ee.memoizedState:null)!==e&&(ue.flags|=1024),t}function Ui(){var e=Ln!==0;return Ln=0,e}function Mi(e,t,l){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l}function Li(e){if(Mn){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Mn=!1}$t=0,qe=Ee=ue=null,La=!1,ws=Ln=0,Oa=null}function Ie(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?ue.memoizedState=qe=e:qe=qe.next=e,qe}function Be(){if(Ee===null){var e=ue.alternate;e=e!==null?e.memoizedState:null}else e=Ee.next;var t=qe===null?ue.memoizedState:qe.next;if(t!==null)qe=t,Ee=e;else{if(e===null)throw ue.alternate===null?Error(o(467)):Error(o(310));Ee=e,e={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},qe===null?ue.memoizedState=qe=e:qe=qe.next=e}return qe}function On(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ns(e){var t=ws;return ws+=1,Oa===null&&(Oa=[]),e=Sd(Oa,e,t),t=ue,(qe===null?t.memoizedState:qe.next)===null&&(t=t.alternate,O.H=t===null||t.memoizedState===null?xu:Yi),e}function Dn(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ns(e);if(e.$$typeof===w)return Ke(e)}throw Error(o(438,String(e)))}function Oi(e){var t=null,l=ue.updateQueue;if(l!==null&&(t=l.memoCache),t==null){var s=ue.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(n){return n.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),l===null&&(l=On(),ue.updateQueue=l),l.memoCache=t,l=t.data[t.index],l===void 0)for(l=t.data[t.index]=Array(e),s=0;s<e;s++)l[s]=M;return t.index++,l}function Wt(e,t){return typeof t=="function"?t(e):t}function Rn(e){var t=Be();return Di(t,Ee,e)}function Di(e,t,l){var s=e.queue;if(s===null)throw Error(o(311));s.lastRenderedReducer=l;var n=e.baseQueue,r=s.pending;if(r!==null){if(n!==null){var c=n.next;n.next=r.next,r.next=c}t.baseQueue=n=r,s.pending=null}if(r=e.baseState,n===null)e.memoizedState=r;else{t=n.next;var h=c=null,A=null,F=t,$=!1;do{var P=F.lane&-536870913;if(P!==F.lane?(ge&P)===P:($t&P)===P){var Y=F.revertLane;if(Y===0)A!==null&&(A=A.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),P===Aa&&($=!0);else if(($t&Y)===Y){F=F.next,Y===Aa&&($=!0);continue}else P={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},A===null?(h=A=P,c=r):A=A.next=P,ue.lanes|=Y,Tl|=Y;P=F.action,la&&l(r,P),r=F.hasEagerState?F.eagerState:l(r,P)}else Y={lane:P,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},A===null?(h=A=Y,c=r):A=A.next=Y,ue.lanes|=P,Tl|=P;F=F.next}while(F!==null&&F!==t);if(A===null?c=r:A.next=h,!mt(r,e.memoizedState)&&(Ve=!0,$&&(l=Ta,l!==null)))throw l;e.memoizedState=r,e.baseState=c,e.baseQueue=A,s.lastRenderedState=r}return n===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Ri(e){var t=Be(),l=t.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=e;var s=l.dispatch,n=l.pending,r=t.memoizedState;if(n!==null){l.pending=null;var c=n=n.next;do r=e(r,c.action),c=c.next;while(c!==n);mt(r,t.memoizedState)||(Ve=!0),t.memoizedState=r,t.baseQueue===null&&(t.baseState=r),l.lastRenderedState=r}return[r,s]}function Rd(e,t,l){var s=ue,n=Be(),r=be;if(r){if(l===void 0)throw Error(o(407));l=l()}else l=t();var c=!mt((Ee||n).memoizedState,l);if(c&&(n.memoizedState=l,Ve=!0),n=n.queue,Hi(Hd.bind(null,s,n,e),[e]),n.getSnapshot!==t||c||qe!==null&&qe.memoizedState.tag&1){if(s.flags|=2048,Da(9,{destroy:void 0},Bd.bind(null,s,n,l,t),null),ze===null)throw Error(o(349));r||($t&127)!==0||_d(s,t,l)}return l}function _d(e,t,l){e.flags|=16384,e={getSnapshot:t,value:l},t=ue.updateQueue,t===null?(t=On(),ue.updateQueue=t,t.stores=[e]):(l=t.stores,l===null?t.stores=[e]:l.push(e))}function Bd(e,t,l,s){t.value=l,t.getSnapshot=s,qd(t)&&Vd(e)}function Hd(e,t,l){return l(function(){qd(t)&&Vd(e)})}function qd(e){var t=e.getSnapshot;e=e.value;try{var l=t();return!mt(e,l)}catch{return!0}}function Vd(e){var t=Zl(e,2);t!==null&&ot(t,e,2)}function _i(e){var t=Ie();if(typeof e=="function"){var l=e;if(e=l(),la){gl(!0);try{l()}finally{gl(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wt,lastRenderedState:e},t}function Qd(e,t,l,s){return e.baseState=l,Di(e,Ee,typeof s=="function"?s:Wt)}function uh(e,t,l,s,n){if(Hn(e))throw Error(o(485));if(e=t.action,e!==null){var r={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(c){r.listeners.push(c)}};O.T!==null?l(!0):r.isTransition=!1,s(r),l=t.pending,l===null?(r.next=t.pending=r,Fd(t,r)):(r.next=l.next,t.pending=l.next=r)}}function Fd(e,t){var l=t.action,s=t.payload,n=e.state;if(t.isTransition){var r=O.T,c={};O.T=c;try{var h=l(n,s),A=O.S;A!==null&&A(c,h),Gd(e,t,h)}catch(F){Bi(e,t,F)}finally{r!==null&&c.types!==null&&(r.types=c.types),O.T=r}}else try{r=l(n,s),Gd(e,t,r)}catch(F){Bi(e,t,F)}}function Gd(e,t,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(s){Yd(e,t,s)},function(s){return Bi(e,t,s)}):Yd(e,t,l)}function Yd(e,t,l){t.status="fulfilled",t.value=l,Xd(t),e.state=l,t=e.pending,t!==null&&(l=t.next,l===t?e.pending=null:(l=l.next,t.next=l,Fd(e,l)))}function Bi(e,t,l){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=l,Xd(t),t=t.next;while(t!==s)}e.action=null}function Xd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Zd(e,t){return t}function Jd(e,t){if(be){var l=ze.formState;if(l!==null){e:{var s=ue;if(be){if(Ue){t:{for(var n=Ue,r=Ct;n.nodeType!==8;){if(!r){n=null;break t}if(n=At(n.nextSibling),n===null){n=null;break t}}r=n.data,n=r==="F!"||r==="F"?n:null}if(n){Ue=At(n.nextSibling),s=n.data==="F!";break e}}vl(s)}s=!1}s&&(t=l[0])}}return l=Ie(),l.memoizedState=l.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zd,lastRenderedState:t},l.queue=s,l=mu.bind(null,ue,s),s.dispatch=l,s=_i(!1),r=Gi.bind(null,ue,!1,s.queue),s=Ie(),n={state:t,dispatch:null,action:e,pending:null},s.queue=n,l=uh.bind(null,ue,n,r,l),n.dispatch=l,s.memoizedState=e,[t,l,!1]}function Kd(e){var t=Be();return $d(t,Ee,e)}function $d(e,t,l){if(t=Di(e,t,Zd)[0],e=Rn(Wt)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=Ns(t)}catch(c){throw c===za?Cn:c}else s=t;t=Be();var n=t.queue,r=n.dispatch;return l!==t.memoizedState&&(ue.flags|=2048,Da(9,{destroy:void 0},fh.bind(null,n,l),null)),[s,r,e]}function fh(e,t){e.action=t}function Wd(e){var t=Be(),l=Ee;if(l!==null)return $d(t,l,e);Be(),t=t.memoizedState,l=Be();var s=l.queue.dispatch;return l.memoizedState=e,[t,s,!1]}function Da(e,t,l,s){return e={tag:e,create:l,deps:s,inst:t,next:null},t=ue.updateQueue,t===null&&(t=On(),ue.updateQueue=t),l=t.lastEffect,l===null?t.lastEffect=e.next=e:(s=l.next,l.next=e,e.next=s,t.lastEffect=e),e}function Pd(){return Be().memoizedState}function _n(e,t,l,s){var n=Ie();ue.flags|=e,n.memoizedState=Da(1|t,{destroy:void 0},l,s===void 0?null:s)}function Bn(e,t,l,s){var n=Be();s=s===void 0?null:s;var r=n.memoizedState.inst;Ee!==null&&s!==null&&Ti(s,Ee.memoizedState.deps)?n.memoizedState=Da(t,r,l,s):(ue.flags|=e,n.memoizedState=Da(1|t,r,l,s))}function Id(e,t){_n(8390656,8,e,t)}function Hi(e,t){Bn(2048,8,e,t)}function mh(e){ue.flags|=4;var t=ue.updateQueue;if(t===null)t=On(),ue.updateQueue=t,t.events=[e];else{var l=t.events;l===null?t.events=[e]:l.push(e)}}function eu(e){var t=Be().memoizedState;return mh({ref:t,nextImpl:e}),function(){if((Ne&2)!==0)throw Error(o(440));return t.impl.apply(void 0,arguments)}}function tu(e,t){return Bn(4,2,e,t)}function lu(e,t){return Bn(4,4,e,t)}function au(e,t){if(typeof t=="function"){e=e();var l=t(e);return function(){typeof l=="function"?l():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function su(e,t,l){l=l!=null?l.concat([e]):null,Bn(4,4,au.bind(null,t,e),l)}function qi(){}function nu(e,t){var l=Be();t=t===void 0?null:t;var s=l.memoizedState;return t!==null&&Ti(t,s[1])?s[0]:(l.memoizedState=[e,t],e)}function ru(e,t){var l=Be();t=t===void 0?null:t;var s=l.memoizedState;if(t!==null&&Ti(t,s[1]))return s[0];if(s=e(),la){gl(!0);try{e()}finally{gl(!1)}}return l.memoizedState=[s,t],s}function Vi(e,t,l){return l===void 0||($t&1073741824)!==0&&(ge&261930)===0?e.memoizedState=t:(e.memoizedState=l,e=i0(),ue.lanes|=e,Tl|=e,l)}function iu(e,t,l,s){return mt(l,t)?l:Ma.current!==null?(e=Vi(e,l,s),mt(e,t)||(Ve=!0),e):($t&42)===0||($t&1073741824)!==0&&(ge&261930)===0?(Ve=!0,e.memoizedState=l):(e=i0(),ue.lanes|=e,Tl|=e,t)}function ou(e,t,l,s,n){var r=q.p;q.p=r!==0&&8>r?r:8;var c=O.T,h={};O.T=h,Gi(e,!1,t,l);try{var A=n(),F=O.S;if(F!==null&&F(h,A),A!==null&&typeof A=="object"&&typeof A.then=="function"){var $=oh(A,s);ks(e,t,$,pt(e))}else ks(e,t,s,pt(e))}catch(P){ks(e,t,{then:function(){},status:"rejected",reason:P},pt())}finally{q.p=r,c!==null&&h.types!==null&&(c.types=h.types),O.T=c}}function hh(){}function Qi(e,t,l,s){if(e.tag!==5)throw Error(o(476));var n=cu(e).queue;ou(e,n,t,J,l===null?hh:function(){return du(e),l(s)})}function cu(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wt,lastRenderedState:J},next:null};var l={};return t.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wt,lastRenderedState:l},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function du(e){var t=cu(e);t.next===null&&(t=e.alternate.memoizedState),ks(e,t.next.queue,{},pt())}function Fi(){return Ke(Vs)}function uu(){return Be().memoizedState}function fu(){return Be().memoizedState}function gh(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var l=pt();e=Nl(l);var s=kl(t,e,l);s!==null&&(ot(s,t,l),ps(s,t,l)),t={cache:yi()},e.payload=t;return}t=t.return}}function xh(e,t,l){var s=pt();l={lane:s,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Hn(e)?hu(t,l):(l=ii(e,t,l,s),l!==null&&(ot(l,e,s),gu(l,t,s)))}function mu(e,t,l){var s=pt();ks(e,t,l,s)}function ks(e,t,l,s){var n={lane:s,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Hn(e))hu(t,n);else{var r=e.alternate;if(e.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var c=t.lastRenderedState,h=r(c,l);if(n.hasEagerState=!0,n.eagerState=h,mt(h,c))return pn(e,t,n,0),ze===null&&yn(),!1}catch{}finally{}if(l=ii(e,t,n,s),l!==null)return ot(l,e,s),gu(l,t,s),!0}return!1}function Gi(e,t,l,s){if(s={lane:2,revertLane:No(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Hn(e)){if(t)throw Error(o(479))}else t=ii(e,l,s,2),t!==null&&ot(t,e,2)}function Hn(e){var t=e.alternate;return e===ue||t!==null&&t===ue}function hu(e,t){La=Mn=!0;var l=e.pending;l===null?t.next=t:(t.next=l.next,l.next=t),e.pending=t}function gu(e,t,l){if((l&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,l|=s,t.lanes=l,vc(e,l)}}var Ss={readContext:Ke,use:Dn,useCallback:De,useContext:De,useEffect:De,useImperativeHandle:De,useLayoutEffect:De,useInsertionEffect:De,useMemo:De,useReducer:De,useRef:De,useState:De,useDebugValue:De,useDeferredValue:De,useTransition:De,useSyncExternalStore:De,useId:De,useHostTransitionStatus:De,useFormState:De,useActionState:De,useOptimistic:De,useMemoCache:De,useCacheRefresh:De};Ss.useEffectEvent=De;var xu={readContext:Ke,use:Dn,useCallback:function(e,t){return Ie().memoizedState=[e,t===void 0?null:t],e},useContext:Ke,useEffect:Id,useImperativeHandle:function(e,t,l){l=l!=null?l.concat([e]):null,_n(4194308,4,au.bind(null,t,e),l)},useLayoutEffect:function(e,t){return _n(4194308,4,e,t)},useInsertionEffect:function(e,t){_n(4,2,e,t)},useMemo:function(e,t){var l=Ie();t=t===void 0?null:t;var s=e();if(la){gl(!0);try{e()}finally{gl(!1)}}return l.memoizedState=[s,t],s},useReducer:function(e,t,l){var s=Ie();if(l!==void 0){var n=l(t);if(la){gl(!0);try{l(t)}finally{gl(!1)}}}else n=t;return s.memoizedState=s.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},s.queue=e,e=e.dispatch=xh.bind(null,ue,e),[s.memoizedState,e]},useRef:function(e){var t=Ie();return e={current:e},t.memoizedState=e},useState:function(e){e=_i(e);var t=e.queue,l=mu.bind(null,ue,t);return t.dispatch=l,[e.memoizedState,l]},useDebugValue:qi,useDeferredValue:function(e,t){var l=Ie();return Vi(l,e,t)},useTransition:function(){var e=_i(!1);return e=ou.bind(null,ue,e.queue,!0,!1),Ie().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,l){var s=ue,n=Ie();if(be){if(l===void 0)throw Error(o(407));l=l()}else{if(l=t(),ze===null)throw Error(o(349));(ge&127)!==0||_d(s,t,l)}n.memoizedState=l;var r={value:l,getSnapshot:t};return n.queue=r,Id(Hd.bind(null,s,r,e),[e]),s.flags|=2048,Da(9,{destroy:void 0},Bd.bind(null,s,r,l,t),null),l},useId:function(){var e=Ie(),t=ze.identifierPrefix;if(be){var l=Bt,s=_t;l=(s&~(1<<32-ft(s)-1)).toString(32)+l,t="_"+t+"R_"+l,l=Ln++,0<l&&(t+="H"+l.toString(32)),t+="_"}else l=ch++,t="_"+t+"r_"+l.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Fi,useFormState:Jd,useActionState:Jd,useOptimistic:function(e){var t=Ie();t.memoizedState=t.baseState=e;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=l,t=Gi.bind(null,ue,!0,l),l.dispatch=t,[e,t]},useMemoCache:Oi,useCacheRefresh:function(){return Ie().memoizedState=gh.bind(null,ue)},useEffectEvent:function(e){var t=Ie(),l={impl:e};return t.memoizedState=l,function(){if((Ne&2)!==0)throw Error(o(440));return l.impl.apply(void 0,arguments)}}},Yi={readContext:Ke,use:Dn,useCallback:nu,useContext:Ke,useEffect:Hi,useImperativeHandle:su,useInsertionEffect:tu,useLayoutEffect:lu,useMemo:ru,useReducer:Rn,useRef:Pd,useState:function(){return Rn(Wt)},useDebugValue:qi,useDeferredValue:function(e,t){var l=Be();return iu(l,Ee.memoizedState,e,t)},useTransition:function(){var e=Rn(Wt)[0],t=Be().memoizedState;return[typeof e=="boolean"?e:Ns(e),t]},useSyncExternalStore:Rd,useId:uu,useHostTransitionStatus:Fi,useFormState:Kd,useActionState:Kd,useOptimistic:function(e,t){var l=Be();return Qd(l,Ee,e,t)},useMemoCache:Oi,useCacheRefresh:fu};Yi.useEffectEvent=eu;var bu={readContext:Ke,use:Dn,useCallback:nu,useContext:Ke,useEffect:Hi,useImperativeHandle:su,useInsertionEffect:tu,useLayoutEffect:lu,useMemo:ru,useReducer:Ri,useRef:Pd,useState:function(){return Ri(Wt)},useDebugValue:qi,useDeferredValue:function(e,t){var l=Be();return Ee===null?Vi(l,e,t):iu(l,Ee.memoizedState,e,t)},useTransition:function(){var e=Ri(Wt)[0],t=Be().memoizedState;return[typeof e=="boolean"?e:Ns(e),t]},useSyncExternalStore:Rd,useId:uu,useHostTransitionStatus:Fi,useFormState:Wd,useActionState:Wd,useOptimistic:function(e,t){var l=Be();return Ee!==null?Qd(l,Ee,e,t):(l.baseState=e,[e,l.queue.dispatch])},useMemoCache:Oi,useCacheRefresh:fu};bu.useEffectEvent=eu;function Xi(e,t,l,s){t=e.memoizedState,l=l(s,t),l=l==null?t:p({},t,l),e.memoizedState=l,e.lanes===0&&(e.updateQueue.baseState=l)}var Zi={enqueueSetState:function(e,t,l){e=e._reactInternals;var s=pt(),n=Nl(s);n.payload=t,l!=null&&(n.callback=l),t=kl(e,n,s),t!==null&&(ot(t,e,s),ps(t,e,s))},enqueueReplaceState:function(e,t,l){e=e._reactInternals;var s=pt(),n=Nl(s);n.tag=1,n.payload=t,l!=null&&(n.callback=l),t=kl(e,n,s),t!==null&&(ot(t,e,s),ps(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var l=pt(),s=Nl(l);s.tag=2,t!=null&&(s.callback=t),t=kl(e,s,l),t!==null&&(ot(t,e,l),ps(t,e,l))}};function yu(e,t,l,s,n,r,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,r,c):t.prototype&&t.prototype.isPureReactComponent?!us(l,s)||!us(n,r):!0}function pu(e,t,l,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(l,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(l,s),t.state!==e&&Zi.enqueueReplaceState(t,t.state,null)}function aa(e,t){var l=t;if("ref"in t){l={};for(var s in t)s!=="ref"&&(l[s]=t[s])}if(e=e.defaultProps){l===t&&(l=p({},l));for(var n in e)l[n]===void 0&&(l[n]=e[n])}return l}function vu(e){bn(e)}function ju(e){console.error(e)}function wu(e){bn(e)}function qn(e,t){try{var l=e.onUncaughtError;l(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Nu(e,t,l){try{var s=e.onCaughtError;s(l.value,{componentStack:l.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function Ji(e,t,l){return l=Nl(l),l.tag=3,l.payload={element:null},l.callback=function(){qn(e,t)},l}function ku(e){return e=Nl(e),e.tag=3,e}function Su(e,t,l,s){var n=l.type.getDerivedStateFromError;if(typeof n=="function"){var r=s.value;e.payload=function(){return n(r)},e.callback=function(){Nu(t,l,s)}}var c=l.stateNode;c!==null&&typeof c.componentDidCatch=="function"&&(e.callback=function(){Nu(t,l,s),typeof n!="function"&&(zl===null?zl=new Set([this]):zl.add(this));var h=s.stack;this.componentDidCatch(s.value,{componentStack:h!==null?h:""})})}function bh(e,t,l,s,n){if(l.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=l.alternate,t!==null&&Ea(t,l,n,!0),l=gt.current,l!==null){switch(l.tag){case 31:case 13:return Et===null?Pn():l.alternate===null&&Re===0&&(Re=3),l.flags&=-257,l.flags|=65536,l.lanes=n,s===En?l.flags|=16384:(t=l.updateQueue,t===null?l.updateQueue=new Set([s]):t.add(s),vo(e,s,n)),!1;case 22:return l.flags|=65536,s===En?l.flags|=16384:(t=l.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},l.updateQueue=t):(l=t.retryQueue,l===null?t.retryQueue=new Set([s]):l.add(s)),vo(e,s,n)),!1}throw Error(o(435,l.tag))}return vo(e,s,n),Pn(),!1}if(be)return t=gt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=n,s!==mi&&(e=Error(o(422),{cause:s}),hs(Nt(e,l)))):(s!==mi&&(t=Error(o(423),{cause:s}),hs(Nt(t,l))),e=e.current.alternate,e.flags|=65536,n&=-n,e.lanes|=n,s=Nt(s,l),n=Ji(e.stateNode,s,n),ki(e,n),Re!==4&&(Re=2)),!1;var r=Error(o(520),{cause:s});if(r=Nt(r,l),Ls===null?Ls=[r]:Ls.push(r),Re!==4&&(Re=2),t===null)return!0;s=Nt(s,l),l=t;do{switch(l.tag){case 3:return l.flags|=65536,e=n&-n,l.lanes|=e,e=Ji(l.stateNode,s,e),ki(l,e),!1;case 1:if(t=l.type,r=l.stateNode,(l.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(zl===null||!zl.has(r))))return l.flags|=65536,n&=-n,l.lanes|=n,n=ku(n),Su(n,e,l,s),ki(l,n),!1}l=l.return}while(l!==null);return!1}var Ki=Error(o(461)),Ve=!1;function $e(e,t,l,s){t.child=e===null?Td(t,null,l,s):ta(t,e.child,l,s)}function Cu(e,t,l,s,n){l=l.render;var r=t.ref;if("ref"in s){var c={};for(var h in s)h!=="ref"&&(c[h]=s[h])}else c=s;return Wl(t),s=zi(e,t,l,c,r,n),h=Ui(),e!==null&&!Ve?(Mi(e,t,n),Pt(e,t,n)):(be&&h&&ui(t),t.flags|=1,$e(e,t,s,n),t.child)}function Eu(e,t,l,s,n){if(e===null){var r=l.type;return typeof r=="function"&&!oi(r)&&r.defaultProps===void 0&&l.compare===null?(t.tag=15,t.type=r,Au(e,t,r,s,n)):(e=jn(l.type,null,s,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(r=e.child,!ao(e,n)){var c=r.memoizedProps;if(l=l.compare,l=l!==null?l:us,l(c,s)&&e.ref===t.ref)return Pt(e,t,n)}return t.flags|=1,e=Xt(r,s),e.ref=t.ref,e.return=t,t.child=e}function Au(e,t,l,s,n){if(e!==null){var r=e.memoizedProps;if(us(r,s)&&e.ref===t.ref)if(Ve=!1,t.pendingProps=s=r,ao(e,n))(e.flags&131072)!==0&&(Ve=!0);else return t.lanes=e.lanes,Pt(e,t,n)}return $i(e,t,l,s,n)}function Tu(e,t,l,s){var n=s.children,r=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if((t.flags&128)!==0){if(r=r!==null?r.baseLanes|l:l,e!==null){for(s=t.child=e.child,n=0;s!==null;)n=n|s.lanes|s.childLanes,s=s.sibling;s=n&~r}else s=0,t.child=null;return zu(e,t,r,l,s)}if((l&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Sn(t,r!==null?r.cachePool:null),r!==null?Md(t,r):Ci(),Ld(t);else return s=t.lanes=536870912,zu(e,t,r!==null?r.baseLanes|l:l,l,s)}else r!==null?(Sn(t,r.cachePool),Md(t,r),Cl(),t.memoizedState=null):(e!==null&&Sn(t,null),Ci(),Cl());return $e(e,t,n,l),t.child}function Cs(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function zu(e,t,l,s,n){var r=vi();return r=r===null?null:{parent:He._currentValue,pool:r},t.memoizedState={baseLanes:l,cachePool:r},e!==null&&Sn(t,null),Ci(),Ld(t),e!==null&&Ea(e,t,s,!0),t.childLanes=n,null}function Vn(e,t){return t=Fn({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Uu(e,t,l){return ta(t,e.child,null,l),e=Vn(t,t.pendingProps),e.flags|=2,xt(t),t.memoizedState=null,e}function yh(e,t,l){var s=t.pendingProps,n=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(be){if(s.mode==="hidden")return e=Vn(t,s),t.lanes=536870912,Cs(null,e);if(Ai(t),(e=Ue)?(e=F0(e,Ct),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:yl!==null?{id:_t,overflow:Bt}:null,retryLane:536870912,hydrationErrors:null},l=hd(e),l.return=t,t.child=l,Je=t,Ue=null)):e=null,e===null)throw vl(t);return t.lanes=536870912,null}return Vn(t,s)}var r=e.memoizedState;if(r!==null){var c=r.dehydrated;if(Ai(t),n)if(t.flags&256)t.flags&=-257,t=Uu(e,t,l);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(o(558));else if(Ve||Ea(e,t,l,!1),n=(l&e.childLanes)!==0,Ve||n){if(s=ze,s!==null&&(c=jc(s,l),c!==0&&c!==r.retryLane))throw r.retryLane=c,Zl(e,c),ot(s,e,c),Ki;Pn(),t=Uu(e,t,l)}else e=r.treeContext,Ue=At(c.nextSibling),Je=t,be=!0,pl=null,Ct=!1,e!==null&&bd(t,e),t=Vn(t,s),t.flags|=4096;return t}return e=Xt(e.child,{mode:s.mode,children:s.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Qn(e,t){var l=t.ref;if(l===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(o(284));(e===null||e.ref!==l)&&(t.flags|=4194816)}}function $i(e,t,l,s,n){return Wl(t),l=zi(e,t,l,s,void 0,n),s=Ui(),e!==null&&!Ve?(Mi(e,t,n),Pt(e,t,n)):(be&&s&&ui(t),t.flags|=1,$e(e,t,l,n),t.child)}function Mu(e,t,l,s,n,r){return Wl(t),t.updateQueue=null,l=Dd(t,s,l,n),Od(e),s=Ui(),e!==null&&!Ve?(Mi(e,t,r),Pt(e,t,r)):(be&&s&&ui(t),t.flags|=1,$e(e,t,l,r),t.child)}function Lu(e,t,l,s,n){if(Wl(t),t.stateNode===null){var r=Na,c=l.contextType;typeof c=="object"&&c!==null&&(r=Ke(c)),r=new l(s,r),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Zi,t.stateNode=r,r._reactInternals=t,r=t.stateNode,r.props=s,r.state=t.memoizedState,r.refs={},wi(t),c=l.contextType,r.context=typeof c=="object"&&c!==null?Ke(c):Na,r.state=t.memoizedState,c=l.getDerivedStateFromProps,typeof c=="function"&&(Xi(t,l,c,s),r.state=t.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(c=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),c!==r.state&&Zi.enqueueReplaceState(r,r.state,null),js(t,s,r,n),vs(),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){r=t.stateNode;var h=t.memoizedProps,A=aa(l,h);r.props=A;var F=r.context,$=l.contextType;c=Na,typeof $=="object"&&$!==null&&(c=Ke($));var P=l.getDerivedStateFromProps;$=typeof P=="function"||typeof r.getSnapshotBeforeUpdate=="function",h=t.pendingProps!==h,$||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(h||F!==c)&&pu(t,r,s,c),wl=!1;var Y=t.memoizedState;r.state=Y,js(t,s,r,n),vs(),F=t.memoizedState,h||Y!==F||wl?(typeof P=="function"&&(Xi(t,l,P,s),F=t.memoizedState),(A=wl||yu(t,l,A,s,Y,F,c))?($||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4194308)):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=F),r.props=s,r.state=F,r.context=c,s=A):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{r=t.stateNode,Ni(e,t),c=t.memoizedProps,$=aa(l,c),r.props=$,P=t.pendingProps,Y=r.context,F=l.contextType,A=Na,typeof F=="object"&&F!==null&&(A=Ke(F)),h=l.getDerivedStateFromProps,(F=typeof h=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(c!==P||Y!==A)&&pu(t,r,s,A),wl=!1,Y=t.memoizedState,r.state=Y,js(t,s,r,n),vs();var Z=t.memoizedState;c!==P||Y!==Z||wl||e!==null&&e.dependencies!==null&&Nn(e.dependencies)?(typeof h=="function"&&(Xi(t,l,h,s),Z=t.memoizedState),($=wl||yu(t,l,$,s,Y,Z,A)||e!==null&&e.dependencies!==null&&Nn(e.dependencies))?(F||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,Z,A),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,Z,A)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof r.componentDidUpdate!="function"||c===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=Z),r.props=s,r.state=Z,r.context=A,s=$):(typeof r.componentDidUpdate!="function"||c===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),s=!1)}return r=s,Qn(e,t),s=(t.flags&128)!==0,r||s?(r=t.stateNode,l=s&&typeof l.getDerivedStateFromError!="function"?null:r.render(),t.flags|=1,e!==null&&s?(t.child=ta(t,e.child,null,n),t.child=ta(t,null,l,n)):$e(e,t,l,n),t.memoizedState=r.state,e=t.child):e=Pt(e,t,n),e}function Ou(e,t,l,s){return Kl(),t.flags|=256,$e(e,t,l,s),t.child}var Wi={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pi(e){return{baseLanes:e,cachePool:Nd()}}function Ii(e,t,l){return e=e!==null?e.childLanes&~l:0,t&&(e|=yt),e}function Du(e,t,l){var s=t.pendingProps,n=!1,r=(t.flags&128)!==0,c;if((c=r)||(c=e!==null&&e.memoizedState===null?!1:(_e.current&2)!==0),c&&(n=!0,t.flags&=-129),c=(t.flags&32)!==0,t.flags&=-33,e===null){if(be){if(n?Sl(t):Cl(),(e=Ue)?(e=F0(e,Ct),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:yl!==null?{id:_t,overflow:Bt}:null,retryLane:536870912,hydrationErrors:null},l=hd(e),l.return=t,t.child=l,Je=t,Ue=null)):e=null,e===null)throw vl(t);return Ro(e)?t.lanes=32:t.lanes=536870912,null}var h=s.children;return s=s.fallback,n?(Cl(),n=t.mode,h=Fn({mode:"hidden",children:h},n),s=Jl(s,n,l,null),h.return=t,s.return=t,h.sibling=s,t.child=h,s=t.child,s.memoizedState=Pi(l),s.childLanes=Ii(e,c,l),t.memoizedState=Wi,Cs(null,s)):(Sl(t),eo(t,h))}var A=e.memoizedState;if(A!==null&&(h=A.dehydrated,h!==null)){if(r)t.flags&256?(Sl(t),t.flags&=-257,t=to(e,t,l)):t.memoizedState!==null?(Cl(),t.child=e.child,t.flags|=128,t=null):(Cl(),h=s.fallback,n=t.mode,s=Fn({mode:"visible",children:s.children},n),h=Jl(h,n,l,null),h.flags|=2,s.return=t,h.return=t,s.sibling=h,t.child=s,ta(t,e.child,null,l),s=t.child,s.memoizedState=Pi(l),s.childLanes=Ii(e,c,l),t.memoizedState=Wi,t=Cs(null,s));else if(Sl(t),Ro(h)){if(c=h.nextSibling&&h.nextSibling.dataset,c)var F=c.dgst;c=F,s=Error(o(419)),s.stack="",s.digest=c,hs({value:s,source:null,stack:null}),t=to(e,t,l)}else if(Ve||Ea(e,t,l,!1),c=(l&e.childLanes)!==0,Ve||c){if(c=ze,c!==null&&(s=jc(c,l),s!==0&&s!==A.retryLane))throw A.retryLane=s,Zl(e,s),ot(c,e,s),Ki;Do(h)||Pn(),t=to(e,t,l)}else Do(h)?(t.flags|=192,t.child=e.child,t=null):(e=A.treeContext,Ue=At(h.nextSibling),Je=t,be=!0,pl=null,Ct=!1,e!==null&&bd(t,e),t=eo(t,s.children),t.flags|=4096);return t}return n?(Cl(),h=s.fallback,n=t.mode,A=e.child,F=A.sibling,s=Xt(A,{mode:"hidden",children:s.children}),s.subtreeFlags=A.subtreeFlags&65011712,F!==null?h=Xt(F,h):(h=Jl(h,n,l,null),h.flags|=2),h.return=t,s.return=t,s.sibling=h,t.child=s,Cs(null,s),s=t.child,h=e.child.memoizedState,h===null?h=Pi(l):(n=h.cachePool,n!==null?(A=He._currentValue,n=n.parent!==A?{parent:A,pool:A}:n):n=Nd(),h={baseLanes:h.baseLanes|l,cachePool:n}),s.memoizedState=h,s.childLanes=Ii(e,c,l),t.memoizedState=Wi,Cs(e.child,s)):(Sl(t),l=e.child,e=l.sibling,l=Xt(l,{mode:"visible",children:s.children}),l.return=t,l.sibling=null,e!==null&&(c=t.deletions,c===null?(t.deletions=[e],t.flags|=16):c.push(e)),t.child=l,t.memoizedState=null,l)}function eo(e,t){return t=Fn({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Fn(e,t){return e=ht(22,e,null,t),e.lanes=0,e}function to(e,t,l){return ta(t,e.child,null,l),e=eo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ru(e,t,l){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),xi(e.return,t,l)}function lo(e,t,l,s,n,r){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:l,tailMode:n,treeForkCount:r}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=l,c.tailMode=n,c.treeForkCount=r)}function _u(e,t,l){var s=t.pendingProps,n=s.revealOrder,r=s.tail;s=s.children;var c=_e.current,h=(c&2)!==0;if(h?(c=c&1|2,t.flags|=128):c&=1,re(_e,c),$e(e,t,s,l),s=be?ms:0,!h&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ru(e,l,t);else if(e.tag===19)Ru(e,l,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(n){case"forwards":for(l=t.child,n=null;l!==null;)e=l.alternate,e!==null&&Un(e)===null&&(n=l),l=l.sibling;l=n,l===null?(n=t.child,t.child=null):(n=l.sibling,l.sibling=null),lo(t,!1,n,l,r,s);break;case"backwards":case"unstable_legacy-backwards":for(l=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Un(e)===null){t.child=n;break}e=n.sibling,n.sibling=l,l=n,n=e}lo(t,!0,l,null,r,s);break;case"together":lo(t,!1,null,null,void 0,s);break;default:t.memoizedState=null}return t.child}function Pt(e,t,l){if(e!==null&&(t.dependencies=e.dependencies),Tl|=t.lanes,(l&t.childLanes)===0)if(e!==null){if(Ea(e,t,l,!1),(l&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(o(153));if(t.child!==null){for(e=t.child,l=Xt(e,e.pendingProps),t.child=l,l.return=t;e.sibling!==null;)e=e.sibling,l=l.sibling=Xt(e,e.pendingProps),l.return=t;l.sibling=null}return t.child}function ao(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Nn(e)))}function ph(e,t,l){switch(t.tag){case 3:Le(t,t.stateNode.containerInfo),jl(t,He,e.memoizedState.cache),Kl();break;case 27:case 5:Er(t);break;case 4:Le(t,t.stateNode.containerInfo);break;case 10:jl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Ai(t),null;break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(Sl(t),t.flags|=128,null):(l&t.child.childLanes)!==0?Du(e,t,l):(Sl(t),e=Pt(e,t,l),e!==null?e.sibling:null);Sl(t);break;case 19:var n=(e.flags&128)!==0;if(s=(l&t.childLanes)!==0,s||(Ea(e,t,l,!1),s=(l&t.childLanes)!==0),n){if(s)return _u(e,t,l);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),re(_e,_e.current),s)break;return null;case 22:return t.lanes=0,Tu(e,t,l,t.pendingProps);case 24:jl(t,He,e.memoizedState.cache)}return Pt(e,t,l)}function Bu(e,t,l){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ve=!0;else{if(!ao(e,l)&&(t.flags&128)===0)return Ve=!1,ph(e,t,l);Ve=(e.flags&131072)!==0}else Ve=!1,be&&(t.flags&1048576)!==0&&xd(t,ms,t.index);switch(t.lanes=0,t.tag){case 16:e:{var s=t.pendingProps;if(e=Il(t.elementType),t.type=e,typeof e=="function")oi(e)?(s=aa(e,s),t.tag=1,t=Lu(null,t,e,s,l)):(t.tag=0,t=$i(null,t,e,s,l));else{if(e!=null){var n=e.$$typeof;if(n===N){t.tag=11,t=Cu(null,t,e,s,l);break e}else if(n===K){t.tag=14,t=Eu(null,t,e,s,l);break e}}throw t=ee(e)||e,Error(o(306,t,""))}}return t;case 0:return $i(e,t,t.type,t.pendingProps,l);case 1:return s=t.type,n=aa(s,t.pendingProps),Lu(e,t,s,n,l);case 3:e:{if(Le(t,t.stateNode.containerInfo),e===null)throw Error(o(387));s=t.pendingProps;var r=t.memoizedState;n=r.element,Ni(e,t),js(t,s,null,l);var c=t.memoizedState;if(s=c.cache,jl(t,He,s),s!==r.cache&&bi(t,[He],l,!0),vs(),s=c.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:c.cache},t.updateQueue.baseState=r,t.memoizedState=r,t.flags&256){t=Ou(e,t,s,l);break e}else if(s!==n){n=Nt(Error(o(424)),t),hs(n),t=Ou(e,t,s,l);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ue=At(e.firstChild),Je=t,be=!0,pl=null,Ct=!0,l=Td(t,null,s,l),t.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Kl(),s===n){t=Pt(e,t,l);break e}$e(e,t,s,l)}t=t.child}return t;case 26:return Qn(e,t),e===null?(l=K0(t.type,null,t.pendingProps,null))?t.memoizedState=l:be||(l=t.type,e=t.pendingProps,s=nr(pe.current).createElement(l),s[Ze]=t,s[lt]=e,We(s,l,e),Ge(s),t.stateNode=s):t.memoizedState=K0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Er(t),e===null&&be&&(s=t.stateNode=X0(t.type,t.pendingProps,pe.current),Je=t,Ct=!0,n=Ue,Ol(t.type)?(_o=n,Ue=At(s.firstChild)):Ue=n),$e(e,t,t.pendingProps.children,l),Qn(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&be&&((n=s=Ue)&&(s=Kh(s,t.type,t.pendingProps,Ct),s!==null?(t.stateNode=s,Je=t,Ue=At(s.firstChild),Ct=!1,n=!0):n=!1),n||vl(t)),Er(t),n=t.type,r=t.pendingProps,c=e!==null?e.memoizedProps:null,s=r.children,Mo(n,r)?s=null:c!==null&&Mo(n,c)&&(t.flags|=32),t.memoizedState!==null&&(n=zi(e,t,dh,null,null,l),Vs._currentValue=n),Qn(e,t),$e(e,t,s,l),t.child;case 6:return e===null&&be&&((e=l=Ue)&&(l=$h(l,t.pendingProps,Ct),l!==null?(t.stateNode=l,Je=t,Ue=null,e=!0):e=!1),e||vl(t)),null;case 13:return Du(e,t,l);case 4:return Le(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=ta(t,null,s,l):$e(e,t,s,l),t.child;case 11:return Cu(e,t,t.type,t.pendingProps,l);case 7:return $e(e,t,t.pendingProps,l),t.child;case 8:return $e(e,t,t.pendingProps.children,l),t.child;case 12:return $e(e,t,t.pendingProps.children,l),t.child;case 10:return s=t.pendingProps,jl(t,t.type,s.value),$e(e,t,s.children,l),t.child;case 9:return n=t.type._context,s=t.pendingProps.children,Wl(t),n=Ke(n),s=s(n),t.flags|=1,$e(e,t,s,l),t.child;case 14:return Eu(e,t,t.type,t.pendingProps,l);case 15:return Au(e,t,t.type,t.pendingProps,l);case 19:return _u(e,t,l);case 31:return yh(e,t,l);case 22:return Tu(e,t,l,t.pendingProps);case 24:return Wl(t),s=Ke(He),e===null?(n=vi(),n===null&&(n=ze,r=yi(),n.pooledCache=r,r.refCount++,r!==null&&(n.pooledCacheLanes|=l),n=r),t.memoizedState={parent:s,cache:n},wi(t),jl(t,He,n)):((e.lanes&l)!==0&&(Ni(e,t),js(t,null,null,l),vs()),n=e.memoizedState,r=t.memoizedState,n.parent!==s?(n={parent:s,cache:s},t.memoizedState=n,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=n),jl(t,He,s)):(s=r.cache,jl(t,He,s),s!==n.cache&&bi(t,[He],l,!0))),$e(e,t,t.pendingProps.children,l),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function It(e){e.flags|=4}function so(e,t,l,s,n){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(n&335544128)===n)if(e.stateNode.complete)e.flags|=8192;else if(u0())e.flags|=8192;else throw ea=En,ji}else e.flags&=-16777217}function Hu(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!ef(t))if(u0())e.flags|=8192;else throw ea=En,ji}function Gn(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?yc():536870912,e.lanes|=t,Ha|=t)}function Es(e,t){if(!be)switch(e.tailMode){case"hidden":t=e.tail;for(var l=null;t!==null;)t.alternate!==null&&(l=t),t=t.sibling;l===null?e.tail=null:l.sibling=null;break;case"collapsed":l=e.tail;for(var s=null;l!==null;)l.alternate!==null&&(s=l),l=l.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Me(e){var t=e.alternate!==null&&e.alternate.child===e.child,l=0,s=0;if(t)for(var n=e.child;n!==null;)l|=n.lanes|n.childLanes,s|=n.subtreeFlags&65011712,s|=n.flags&65011712,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)l|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=l,t}function vh(e,t,l){var s=t.pendingProps;switch(fi(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Me(t),null;case 1:return Me(t),null;case 3:return l=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),Kt(He),ca(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(Ca(t)?It(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,hi())),Me(t),null;case 26:var n=t.type,r=t.memoizedState;return e===null?(It(t),r!==null?(Me(t),Hu(t,r)):(Me(t),so(t,n,null,s,l))):r?r!==e.memoizedState?(It(t),Me(t),Hu(t,r)):(Me(t),t.flags&=-16777217):(e=e.memoizedProps,e!==s&&It(t),Me(t),so(t,n,e,s,l)),null;case 27:if(en(t),l=pe.current,n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&It(t);else{if(!s){if(t.stateNode===null)throw Error(o(166));return Me(t),null}e=ve.current,Ca(t)?yd(t):(e=X0(n,s,l),t.stateNode=e,It(t))}return Me(t),null;case 5:if(en(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&It(t);else{if(!s){if(t.stateNode===null)throw Error(o(166));return Me(t),null}if(r=ve.current,Ca(t))yd(t);else{var c=nr(pe.current);switch(r){case 1:r=c.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:r=c.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":r=c.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":r=c.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":r=c.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof s.is=="string"?c.createElement("select",{is:s.is}):c.createElement("select"),s.multiple?r.multiple=!0:s.size&&(r.size=s.size);break;default:r=typeof s.is=="string"?c.createElement(n,{is:s.is}):c.createElement(n)}}r[Ze]=t,r[lt]=s;e:for(c=t.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.tag!==27&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}t.stateNode=r;e:switch(We(r,n,s),n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&It(t)}}return Me(t),so(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,l),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&It(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(o(166));if(e=pe.current,Ca(t)){if(e=t.stateNode,l=t.memoizedProps,s=null,n=Je,n!==null)switch(n.tag){case 27:case 5:s=n.memoizedProps}e[Ze]=t,e=!!(e.nodeValue===l||s!==null&&s.suppressHydrationWarning===!0||D0(e.nodeValue,l)),e||vl(t,!0)}else e=nr(e).createTextNode(s),e[Ze]=t,t.stateNode=e}return Me(t),null;case 31:if(l=t.memoizedState,e===null||e.memoizedState!==null){if(s=Ca(t),l!==null){if(e===null){if(!s)throw Error(o(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[Ze]=t}else Kl(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Me(t),e=!1}else l=hi(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=l),e=!0;if(!e)return t.flags&256?(xt(t),t):(xt(t),null);if((t.flags&128)!==0)throw Error(o(558))}return Me(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(n=Ca(t),s!==null&&s.dehydrated!==null){if(e===null){if(!n)throw Error(o(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(o(317));n[Ze]=t}else Kl(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Me(t),n=!1}else n=hi(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),n=!0;if(!n)return t.flags&256?(xt(t),t):(xt(t),null)}return xt(t),(t.flags&128)!==0?(t.lanes=l,t):(l=s!==null,e=e!==null&&e.memoizedState!==null,l&&(s=t.child,n=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(n=s.alternate.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==n&&(s.flags|=2048)),l!==e&&l&&(t.child.flags|=8192),Gn(t,t.updateQueue),Me(t),null);case 4:return ca(),e===null&&Eo(t.stateNode.containerInfo),Me(t),null;case 10:return Kt(t.type),Me(t),null;case 19:if(se(_e),s=t.memoizedState,s===null)return Me(t),null;if(n=(t.flags&128)!==0,r=s.rendering,r===null)if(n)Es(s,!1);else{if(Re!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(r=Un(e),r!==null){for(t.flags|=128,Es(s,!1),e=r.updateQueue,t.updateQueue=e,Gn(t,e),t.subtreeFlags=0,e=l,l=t.child;l!==null;)md(l,e),l=l.sibling;return re(_e,_e.current&1|2),be&&Zt(t,s.treeForkCount),t.child}e=e.sibling}s.tail!==null&&dt()>Kn&&(t.flags|=128,n=!0,Es(s,!1),t.lanes=4194304)}else{if(!n)if(e=Un(r),e!==null){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,Gn(t,e),Es(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!be)return Me(t),null}else 2*dt()-s.renderingStartTime>Kn&&l!==536870912&&(t.flags|=128,n=!0,Es(s,!1),t.lanes=4194304);s.isBackwards?(r.sibling=t.child,t.child=r):(e=s.last,e!==null?e.sibling=r:t.child=r,s.last=r)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=dt(),e.sibling=null,l=_e.current,re(_e,n?l&1|2:l&1),be&&Zt(t,s.treeForkCount),e):(Me(t),null);case 22:case 23:return xt(t),Ei(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(l&536870912)!==0&&(t.flags&128)===0&&(Me(t),t.subtreeFlags&6&&(t.flags|=8192)):Me(t),l=t.updateQueue,l!==null&&Gn(t,l.retryQueue),l=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==l&&(t.flags|=2048),e!==null&&se(Pl),null;case 24:return l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),Kt(He),Me(t),null;case 25:return null;case 30:return null}throw Error(o(156,t.tag))}function jh(e,t){switch(fi(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Kt(He),ca(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return en(t),null;case 31:if(t.memoizedState!==null){if(xt(t),t.alternate===null)throw Error(o(340));Kl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(xt(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(o(340));Kl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return se(_e),null;case 4:return ca(),null;case 10:return Kt(t.type),null;case 22:case 23:return xt(t),Ei(),e!==null&&se(Pl),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Kt(He),null;case 25:return null;default:return null}}function qu(e,t){switch(fi(t),t.tag){case 3:Kt(He),ca();break;case 26:case 27:case 5:en(t);break;case 4:ca();break;case 31:t.memoizedState!==null&&xt(t);break;case 13:xt(t);break;case 19:se(_e);break;case 10:Kt(t.type);break;case 22:case 23:xt(t),Ei(),e!==null&&se(Pl);break;case 24:Kt(He)}}function As(e,t){try{var l=t.updateQueue,s=l!==null?l.lastEffect:null;if(s!==null){var n=s.next;l=n;do{if((l.tag&e)===e){s=void 0;var r=l.create,c=l.inst;s=r(),c.destroy=s}l=l.next}while(l!==n)}}catch(h){Se(t,t.return,h)}}function El(e,t,l){try{var s=t.updateQueue,n=s!==null?s.lastEffect:null;if(n!==null){var r=n.next;s=r;do{if((s.tag&e)===e){var c=s.inst,h=c.destroy;if(h!==void 0){c.destroy=void 0,n=t;var A=l,F=h;try{F()}catch($){Se(n,A,$)}}}s=s.next}while(s!==r)}}catch($){Se(t,t.return,$)}}function Vu(e){var t=e.updateQueue;if(t!==null){var l=e.stateNode;try{Ud(t,l)}catch(s){Se(e,e.return,s)}}}function Qu(e,t,l){l.props=aa(e.type,e.memoizedProps),l.state=e.memoizedState;try{l.componentWillUnmount()}catch(s){Se(e,t,s)}}function Ts(e,t){try{var l=e.ref;if(l!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof l=="function"?e.refCleanup=l(s):l.current=s}}catch(n){Se(e,t,n)}}function Ht(e,t){var l=e.ref,s=e.refCleanup;if(l!==null)if(typeof s=="function")try{s()}catch(n){Se(e,t,n)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(n){Se(e,t,n)}else l.current=null}function Fu(e){var t=e.type,l=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":l.autoFocus&&s.focus();break e;case"img":l.src?s.src=l.src:l.srcSet&&(s.srcset=l.srcSet)}}catch(n){Se(e,e.return,n)}}function no(e,t,l){try{var s=e.stateNode;Fh(s,e.type,l,t),s[lt]=t}catch(n){Se(e,e.return,n)}}function Gu(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ol(e.type)||e.tag===4}function ro(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Gu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ol(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function io(e,t,l){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(e,t):(t=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,t.appendChild(e),l=l._reactRootContainer,l!=null||t.onclick!==null||(t.onclick=Gt));else if(s!==4&&(s===27&&Ol(e.type)&&(l=e.stateNode,t=null),e=e.child,e!==null))for(io(e,t,l),e=e.sibling;e!==null;)io(e,t,l),e=e.sibling}function Yn(e,t,l){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?l.insertBefore(e,t):l.appendChild(e);else if(s!==4&&(s===27&&Ol(e.type)&&(l=e.stateNode),e=e.child,e!==null))for(Yn(e,t,l),e=e.sibling;e!==null;)Yn(e,t,l),e=e.sibling}function Yu(e){var t=e.stateNode,l=e.memoizedProps;try{for(var s=e.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);We(t,s,l),t[Ze]=e,t[lt]=l}catch(r){Se(e,e.return,r)}}var el=!1,Qe=!1,oo=!1,Xu=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function wh(e,t){if(e=e.containerInfo,zo=fr,e=sd(e),ti(e)){if("selectionStart"in e)var l={start:e.selectionStart,end:e.selectionEnd};else e:{l=(l=e.ownerDocument)&&l.defaultView||window;var s=l.getSelection&&l.getSelection();if(s&&s.rangeCount!==0){l=s.anchorNode;var n=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{l.nodeType,r.nodeType}catch{l=null;break e}var c=0,h=-1,A=-1,F=0,$=0,P=e,Y=null;t:for(;;){for(var Z;P!==l||n!==0&&P.nodeType!==3||(h=c+n),P!==r||s!==0&&P.nodeType!==3||(A=c+s),P.nodeType===3&&(c+=P.nodeValue.length),(Z=P.firstChild)!==null;)Y=P,P=Z;for(;;){if(P===e)break t;if(Y===l&&++F===n&&(h=c),Y===r&&++$===s&&(A=c),(Z=P.nextSibling)!==null)break;P=Y,Y=P.parentNode}P=Z}l=h===-1||A===-1?null:{start:h,end:A}}else l=null}l=l||{start:0,end:0}}else l=null;for(Uo={focusedElem:e,selectionRange:l},fr=!1,Ye=t;Ye!==null;)if(t=Ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ye=e;else for(;Ye!==null;){switch(t=Ye,r=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(l=0;l<e.length;l++)n=e[l],n.ref.impl=n.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&r!==null){e=void 0,l=t,n=r.memoizedProps,r=r.memoizedState,s=l.stateNode;try{var ie=aa(l.type,n);e=s.getSnapshotBeforeUpdate(ie,r),s.__reactInternalSnapshotBeforeUpdate=e}catch(de){Se(l,l.return,de)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,l=e.nodeType,l===9)Oo(e);else if(l===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Oo(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=t.sibling,e!==null){e.return=t.return,Ye=e;break}Ye=t.return}}function Zu(e,t,l){var s=l.flags;switch(l.tag){case 0:case 11:case 15:ll(e,l),s&4&&As(5,l);break;case 1:if(ll(e,l),s&4)if(e=l.stateNode,t===null)try{e.componentDidMount()}catch(c){Se(l,l.return,c)}else{var n=aa(l.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(c){Se(l,l.return,c)}}s&64&&Vu(l),s&512&&Ts(l,l.return);break;case 3:if(ll(e,l),s&64&&(e=l.updateQueue,e!==null)){if(t=null,l.child!==null)switch(l.child.tag){case 27:case 5:t=l.child.stateNode;break;case 1:t=l.child.stateNode}try{Ud(e,t)}catch(c){Se(l,l.return,c)}}break;case 27:t===null&&s&4&&Yu(l);case 26:case 5:ll(e,l),t===null&&s&4&&Fu(l),s&512&&Ts(l,l.return);break;case 12:ll(e,l);break;case 31:ll(e,l),s&4&&$u(e,l);break;case 13:ll(e,l),s&4&&Wu(e,l),s&64&&(e=l.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(l=Uh.bind(null,l),Wh(e,l))));break;case 22:if(s=l.memoizedState!==null||el,!s){t=t!==null&&t.memoizedState!==null||Qe,n=el;var r=Qe;el=s,(Qe=t)&&!r?al(e,l,(l.subtreeFlags&8772)!==0):ll(e,l),el=n,Qe=r}break;case 30:break;default:ll(e,l)}}function Ju(e){var t=e.alternate;t!==null&&(e.alternate=null,Ju(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Br(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Oe=null,st=!1;function tl(e,t,l){for(l=l.child;l!==null;)Ku(e,t,l),l=l.sibling}function Ku(e,t,l){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(Ia,l)}catch{}switch(l.tag){case 26:Qe||Ht(l,t),tl(e,t,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Qe||Ht(l,t);var s=Oe,n=st;Ol(l.type)&&(Oe=l.stateNode,st=!1),tl(e,t,l),Bs(l.stateNode),Oe=s,st=n;break;case 5:Qe||Ht(l,t);case 6:if(s=Oe,n=st,Oe=null,tl(e,t,l),Oe=s,st=n,Oe!==null)if(st)try{(Oe.nodeType===9?Oe.body:Oe.nodeName==="HTML"?Oe.ownerDocument.body:Oe).removeChild(l.stateNode)}catch(r){Se(l,t,r)}else try{Oe.removeChild(l.stateNode)}catch(r){Se(l,t,r)}break;case 18:Oe!==null&&(st?(e=Oe,V0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,l.stateNode),Za(e)):V0(Oe,l.stateNode));break;case 4:s=Oe,n=st,Oe=l.stateNode.containerInfo,st=!0,tl(e,t,l),Oe=s,st=n;break;case 0:case 11:case 14:case 15:El(2,l,t),Qe||El(4,l,t),tl(e,t,l);break;case 1:Qe||(Ht(l,t),s=l.stateNode,typeof s.componentWillUnmount=="function"&&Qu(l,t,s)),tl(e,t,l);break;case 21:tl(e,t,l);break;case 22:Qe=(s=Qe)||l.memoizedState!==null,tl(e,t,l),Qe=s;break;default:tl(e,t,l)}}function $u(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Za(e)}catch(l){Se(t,t.return,l)}}}function Wu(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Za(e)}catch(l){Se(t,t.return,l)}}function Nh(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Xu),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Xu),t;default:throw Error(o(435,e.tag))}}function Xn(e,t){var l=Nh(e);t.forEach(function(s){if(!l.has(s)){l.add(s);var n=Mh.bind(null,e,s);s.then(n,n)}})}function nt(e,t){var l=t.deletions;if(l!==null)for(var s=0;s<l.length;s++){var n=l[s],r=e,c=t,h=c;e:for(;h!==null;){switch(h.tag){case 27:if(Ol(h.type)){Oe=h.stateNode,st=!1;break e}break;case 5:Oe=h.stateNode,st=!1;break e;case 3:case 4:Oe=h.stateNode.containerInfo,st=!0;break e}h=h.return}if(Oe===null)throw Error(o(160));Ku(r,c,n),Oe=null,st=!1,r=n.alternate,r!==null&&(r.return=null),n.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Pu(t,e),t=t.sibling}var Ot=null;function Pu(e,t){var l=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:nt(t,e),rt(e),s&4&&(El(3,e,e.return),As(3,e),El(5,e,e.return));break;case 1:nt(t,e),rt(e),s&512&&(Qe||l===null||Ht(l,l.return)),s&64&&el&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(l=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=l===null?s:l.concat(s))));break;case 26:var n=Ot;if(nt(t,e),rt(e),s&512&&(Qe||l===null||Ht(l,l.return)),s&4){var r=l!==null?l.memoizedState:null;if(s=e.memoizedState,l===null)if(s===null)if(e.stateNode===null){e:{s=e.type,l=e.memoizedProps,n=n.ownerDocument||n;t:switch(s){case"title":r=n.getElementsByTagName("title")[0],(!r||r[ls]||r[Ze]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=n.createElement(s),n.head.insertBefore(r,n.querySelector("head > title"))),We(r,s,l),r[Ze]=e,Ge(r),s=r;break e;case"link":var c=P0("link","href",n).get(s+(l.href||""));if(c){for(var h=0;h<c.length;h++)if(r=c[h],r.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&r.getAttribute("rel")===(l.rel==null?null:l.rel)&&r.getAttribute("title")===(l.title==null?null:l.title)&&r.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){c.splice(h,1);break t}}r=n.createElement(s),We(r,s,l),n.head.appendChild(r);break;case"meta":if(c=P0("meta","content",n).get(s+(l.content||""))){for(h=0;h<c.length;h++)if(r=c[h],r.getAttribute("content")===(l.content==null?null:""+l.content)&&r.getAttribute("name")===(l.name==null?null:l.name)&&r.getAttribute("property")===(l.property==null?null:l.property)&&r.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&r.getAttribute("charset")===(l.charSet==null?null:l.charSet)){c.splice(h,1);break t}}r=n.createElement(s),We(r,s,l),n.head.appendChild(r);break;default:throw Error(o(468,s))}r[Ze]=e,Ge(r),s=r}e.stateNode=s}else I0(n,e.type,e.stateNode);else e.stateNode=W0(n,s,e.memoizedProps);else r!==s?(r===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):r.count--,s===null?I0(n,e.type,e.stateNode):W0(n,s,e.memoizedProps)):s===null&&e.stateNode!==null&&no(e,e.memoizedProps,l.memoizedProps)}break;case 27:nt(t,e),rt(e),s&512&&(Qe||l===null||Ht(l,l.return)),l!==null&&s&4&&no(e,e.memoizedProps,l.memoizedProps);break;case 5:if(nt(t,e),rt(e),s&512&&(Qe||l===null||Ht(l,l.return)),e.flags&32){n=e.stateNode;try{xa(n,"")}catch(ie){Se(e,e.return,ie)}}s&4&&e.stateNode!=null&&(n=e.memoizedProps,no(e,n,l!==null?l.memoizedProps:n)),s&1024&&(oo=!0);break;case 6:if(nt(t,e),rt(e),s&4){if(e.stateNode===null)throw Error(o(162));s=e.memoizedProps,l=e.stateNode;try{l.nodeValue=s}catch(ie){Se(e,e.return,ie)}}break;case 3:if(or=null,n=Ot,Ot=rr(t.containerInfo),nt(t,e),Ot=n,rt(e),s&4&&l!==null&&l.memoizedState.isDehydrated)try{Za(t.containerInfo)}catch(ie){Se(e,e.return,ie)}oo&&(oo=!1,Iu(e));break;case 4:s=Ot,Ot=rr(e.stateNode.containerInfo),nt(t,e),rt(e),Ot=s;break;case 12:nt(t,e),rt(e);break;case 31:nt(t,e),rt(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,Xn(e,s)));break;case 13:nt(t,e),rt(e),e.child.flags&8192&&e.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Jn=dt()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,Xn(e,s)));break;case 22:n=e.memoizedState!==null;var A=l!==null&&l.memoizedState!==null,F=el,$=Qe;if(el=F||n,Qe=$||A,nt(t,e),Qe=$,el=F,rt(e),s&8192)e:for(t=e.stateNode,t._visibility=n?t._visibility&-2:t._visibility|1,n&&(l===null||A||el||Qe||sa(e)),l=null,t=e;;){if(t.tag===5||t.tag===26){if(l===null){A=l=t;try{if(r=A.stateNode,n)c=r.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none";else{h=A.stateNode;var P=A.memoizedProps.style,Y=P!=null&&P.hasOwnProperty("display")?P.display:null;h.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(ie){Se(A,A.return,ie)}}}else if(t.tag===6){if(l===null){A=t;try{A.stateNode.nodeValue=n?"":A.memoizedProps}catch(ie){Se(A,A.return,ie)}}}else if(t.tag===18){if(l===null){A=t;try{var Z=A.stateNode;n?Q0(Z,!0):Q0(A.stateNode,!1)}catch(ie){Se(A,A.return,ie)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;l===t&&(l=null),t=t.return}l===t&&(l=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(l=s.retryQueue,l!==null&&(s.retryQueue=null,Xn(e,l))));break;case 19:nt(t,e),rt(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,Xn(e,s)));break;case 30:break;case 21:break;default:nt(t,e),rt(e)}}function rt(e){var t=e.flags;if(t&2){try{for(var l,s=e.return;s!==null;){if(Gu(s)){l=s;break}s=s.return}if(l==null)throw Error(o(160));switch(l.tag){case 27:var n=l.stateNode,r=ro(e);Yn(e,r,n);break;case 5:var c=l.stateNode;l.flags&32&&(xa(c,""),l.flags&=-33);var h=ro(e);Yn(e,h,c);break;case 3:case 4:var A=l.stateNode.containerInfo,F=ro(e);io(e,F,A);break;default:throw Error(o(161))}}catch($){Se(e,e.return,$)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Iu(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Iu(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ll(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Zu(e,t.alternate,t),t=t.sibling}function sa(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:El(4,t,t.return),sa(t);break;case 1:Ht(t,t.return);var l=t.stateNode;typeof l.componentWillUnmount=="function"&&Qu(t,t.return,l),sa(t);break;case 27:Bs(t.stateNode);case 26:case 5:Ht(t,t.return),sa(t);break;case 22:t.memoizedState===null&&sa(t);break;case 30:sa(t);break;default:sa(t)}e=e.sibling}}function al(e,t,l){for(l=l&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,n=e,r=t,c=r.flags;switch(r.tag){case 0:case 11:case 15:al(n,r,l),As(4,r);break;case 1:if(al(n,r,l),s=r,n=s.stateNode,typeof n.componentDidMount=="function")try{n.componentDidMount()}catch(F){Se(s,s.return,F)}if(s=r,n=s.updateQueue,n!==null){var h=s.stateNode;try{var A=n.shared.hiddenCallbacks;if(A!==null)for(n.shared.hiddenCallbacks=null,n=0;n<A.length;n++)zd(A[n],h)}catch(F){Se(s,s.return,F)}}l&&c&64&&Vu(r),Ts(r,r.return);break;case 27:Yu(r);case 26:case 5:al(n,r,l),l&&s===null&&c&4&&Fu(r),Ts(r,r.return);break;case 12:al(n,r,l);break;case 31:al(n,r,l),l&&c&4&&$u(n,r);break;case 13:al(n,r,l),l&&c&4&&Wu(n,r);break;case 22:r.memoizedState===null&&al(n,r,l),Ts(r,r.return);break;case 30:break;default:al(n,r,l)}t=t.sibling}}function co(e,t){var l=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==l&&(e!=null&&e.refCount++,l!=null&&gs(l))}function uo(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&gs(e))}function Dt(e,t,l,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)e0(e,t,l,s),t=t.sibling}function e0(e,t,l,s){var n=t.flags;switch(t.tag){case 0:case 11:case 15:Dt(e,t,l,s),n&2048&&As(9,t);break;case 1:Dt(e,t,l,s);break;case 3:Dt(e,t,l,s),n&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&gs(e)));break;case 12:if(n&2048){Dt(e,t,l,s),e=t.stateNode;try{var r=t.memoizedProps,c=r.id,h=r.onPostCommit;typeof h=="function"&&h(c,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(A){Se(t,t.return,A)}}else Dt(e,t,l,s);break;case 31:Dt(e,t,l,s);break;case 13:Dt(e,t,l,s);break;case 23:break;case 22:r=t.stateNode,c=t.alternate,t.memoizedState!==null?r._visibility&2?Dt(e,t,l,s):zs(e,t):r._visibility&2?Dt(e,t,l,s):(r._visibility|=2,Ra(e,t,l,s,(t.subtreeFlags&10256)!==0||!1)),n&2048&&co(c,t);break;case 24:Dt(e,t,l,s),n&2048&&uo(t.alternate,t);break;default:Dt(e,t,l,s)}}function Ra(e,t,l,s,n){for(n=n&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var r=e,c=t,h=l,A=s,F=c.flags;switch(c.tag){case 0:case 11:case 15:Ra(r,c,h,A,n),As(8,c);break;case 23:break;case 22:var $=c.stateNode;c.memoizedState!==null?$._visibility&2?Ra(r,c,h,A,n):zs(r,c):($._visibility|=2,Ra(r,c,h,A,n)),n&&F&2048&&co(c.alternate,c);break;case 24:Ra(r,c,h,A,n),n&&F&2048&&uo(c.alternate,c);break;default:Ra(r,c,h,A,n)}t=t.sibling}}function zs(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var l=e,s=t,n=s.flags;switch(s.tag){case 22:zs(l,s),n&2048&&co(s.alternate,s);break;case 24:zs(l,s),n&2048&&uo(s.alternate,s);break;default:zs(l,s)}t=t.sibling}}var Us=8192;function _a(e,t,l){if(e.subtreeFlags&Us)for(e=e.child;e!==null;)t0(e,t,l),e=e.sibling}function t0(e,t,l){switch(e.tag){case 26:_a(e,t,l),e.flags&Us&&e.memoizedState!==null&&cg(l,Ot,e.memoizedState,e.memoizedProps);break;case 5:_a(e,t,l);break;case 3:case 4:var s=Ot;Ot=rr(e.stateNode.containerInfo),_a(e,t,l),Ot=s;break;case 22:e.memoizedState===null&&(s=e.alternate,s!==null&&s.memoizedState!==null?(s=Us,Us=16777216,_a(e,t,l),Us=s):_a(e,t,l));break;default:_a(e,t,l)}}function l0(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ms(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var l=0;l<t.length;l++){var s=t[l];Ye=s,s0(s,e)}l0(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)a0(e),e=e.sibling}function a0(e){switch(e.tag){case 0:case 11:case 15:Ms(e),e.flags&2048&&El(9,e,e.return);break;case 3:Ms(e);break;case 12:Ms(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Zn(e)):Ms(e);break;default:Ms(e)}}function Zn(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var l=0;l<t.length;l++){var s=t[l];Ye=s,s0(s,e)}l0(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:El(8,t,t.return),Zn(t);break;case 22:l=t.stateNode,l._visibility&2&&(l._visibility&=-3,Zn(t));break;default:Zn(t)}e=e.sibling}}function s0(e,t){for(;Ye!==null;){var l=Ye;switch(l.tag){case 0:case 11:case 15:El(8,l,t);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var s=l.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:gs(l.memoizedState.cache)}if(s=l.child,s!==null)s.return=l,Ye=s;else e:for(l=e;Ye!==null;){s=Ye;var n=s.sibling,r=s.return;if(Ju(s),s===l){Ye=null;break e}if(n!==null){n.return=r,Ye=n;break e}Ye=r}}}var kh={getCacheForType:function(e){var t=Ke(He),l=t.data.get(e);return l===void 0&&(l=e(),t.data.set(e,l)),l},cacheSignal:function(){return Ke(He).controller.signal}},Sh=typeof WeakMap=="function"?WeakMap:Map,Ne=0,ze=null,me=null,ge=0,ke=0,bt=null,Al=!1,Ba=!1,fo=!1,sl=0,Re=0,Tl=0,na=0,mo=0,yt=0,Ha=0,Ls=null,it=null,ho=!1,Jn=0,n0=0,Kn=1/0,$n=null,zl=null,Fe=0,Ul=null,qa=null,nl=0,go=0,xo=null,r0=null,Os=0,bo=null;function pt(){return(Ne&2)!==0&&ge!==0?ge&-ge:O.T!==null?No():wc()}function i0(){if(yt===0)if((ge&536870912)===0||be){var e=an;an<<=1,(an&3932160)===0&&(an=262144),yt=e}else yt=536870912;return e=gt.current,e!==null&&(e.flags|=32),yt}function ot(e,t,l){(e===ze&&(ke===2||ke===9)||e.cancelPendingCommit!==null)&&(Va(e,0),Ml(e,ge,yt,!1)),ts(e,l),((Ne&2)===0||e!==ze)&&(e===ze&&((Ne&2)===0&&(na|=l),Re===4&&Ml(e,ge,yt,!1)),qt(e))}function o0(e,t,l){if((Ne&6)!==0)throw Error(o(327));var s=!l&&(t&127)===0&&(t&e.expiredLanes)===0||es(e,t),n=s?Ah(e,t):po(e,t,!0),r=s;do{if(n===0){Ba&&!s&&Ml(e,t,0,!1);break}else{if(l=e.current.alternate,r&&!Ch(l)){n=po(e,t,!1),r=!1;continue}if(n===2){if(r=t,e.errorRecoveryDisabledLanes&r)var c=0;else c=e.pendingLanes&-536870913,c=c!==0?c:c&536870912?536870912:0;if(c!==0){t=c;e:{var h=e;n=Ls;var A=h.current.memoizedState.isDehydrated;if(A&&(Va(h,c).flags|=256),c=po(h,c,!1),c!==2){if(fo&&!A){h.errorRecoveryDisabledLanes|=r,na|=r,n=4;break e}r=it,it=n,r!==null&&(it===null?it=r:it.push.apply(it,r))}n=c}if(r=!1,n!==2)continue}}if(n===1){Va(e,0),Ml(e,t,0,!0);break}e:{switch(s=e,r=n,r){case 0:case 1:throw Error(o(345));case 4:if((t&4194048)!==t)break;case 6:Ml(s,t,yt,!Al);break e;case 2:it=null;break;case 3:case 5:break;default:throw Error(o(329))}if((t&62914560)===t&&(n=Jn+300-dt(),10<n)){if(Ml(s,t,yt,!Al),nn(s,0,!0)!==0)break e;nl=t,s.timeoutHandle=H0(c0.bind(null,s,l,it,$n,ho,t,yt,na,Ha,Al,r,"Throttled",-0,0),n);break e}c0(s,l,it,$n,ho,t,yt,na,Ha,Al,r,null,-0,0)}}break}while(!0);qt(e)}function c0(e,t,l,s,n,r,c,h,A,F,$,P,Y,Z){if(e.timeoutHandle=-1,P=t.subtreeFlags,P&8192||(P&16785408)===16785408){P={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gt},t0(t,r,P);var ie=(r&62914560)===r?Jn-dt():(r&4194048)===r?n0-dt():0;if(ie=dg(P,ie),ie!==null){nl=r,e.cancelPendingCommit=ie(b0.bind(null,e,t,r,l,s,n,c,h,A,$,P,null,Y,Z)),Ml(e,r,c,!F);return}}b0(e,t,r,l,s,n,c,h,A)}function Ch(e){for(var t=e;;){var l=t.tag;if((l===0||l===11||l===15)&&t.flags&16384&&(l=t.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var s=0;s<l.length;s++){var n=l[s],r=n.getSnapshot;n=n.value;try{if(!mt(r(),n))return!1}catch{return!1}}if(l=t.child,t.subtreeFlags&16384&&l!==null)l.return=t,t=l;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ml(e,t,l,s){t&=~mo,t&=~na,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var n=t;0<n;){var r=31-ft(n),c=1<<r;s[r]=-1,n&=~c}l!==0&&pc(e,l,t)}function Wn(){return(Ne&6)===0?(Ds(0),!1):!0}function yo(){if(me!==null){if(ke===0)var e=me.return;else e=me,Jt=$l=null,Li(e),Ua=null,bs=0,e=me;for(;e!==null;)qu(e.alternate,e),e=e.return;me=null}}function Va(e,t){var l=e.timeoutHandle;l!==-1&&(e.timeoutHandle=-1,Xh(l)),l=e.cancelPendingCommit,l!==null&&(e.cancelPendingCommit=null,l()),nl=0,yo(),ze=e,me=l=Xt(e.current,null),ge=t,ke=0,bt=null,Al=!1,Ba=es(e,t),fo=!1,Ha=yt=mo=na=Tl=Re=0,it=Ls=null,ho=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var n=31-ft(s),r=1<<n;t|=e[n],s&=~r}return sl=t,yn(),l}function d0(e,t){ue=null,O.H=Ss,t===za||t===Cn?(t=Cd(),ke=3):t===ji?(t=Cd(),ke=4):ke=t===Ki?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,bt=t,me===null&&(Re=1,qn(e,Nt(t,e.current)))}function u0(){var e=gt.current;return e===null?!0:(ge&4194048)===ge?Et===null:(ge&62914560)===ge||(ge&536870912)!==0?e===Et:!1}function f0(){var e=O.H;return O.H=Ss,e===null?Ss:e}function m0(){var e=O.A;return O.A=kh,e}function Pn(){Re=4,Al||(ge&4194048)!==ge&&gt.current!==null||(Ba=!0),(Tl&134217727)===0&&(na&134217727)===0||ze===null||Ml(ze,ge,yt,!1)}function po(e,t,l){var s=Ne;Ne|=2;var n=f0(),r=m0();(ze!==e||ge!==t)&&($n=null,Va(e,t)),t=!1;var c=Re;e:do try{if(ke!==0&&me!==null){var h=me,A=bt;switch(ke){case 8:yo(),c=6;break e;case 3:case 2:case 9:case 6:gt.current===null&&(t=!0);var F=ke;if(ke=0,bt=null,Qa(e,h,A,F),l&&Ba){c=0;break e}break;default:F=ke,ke=0,bt=null,Qa(e,h,A,F)}}Eh(),c=Re;break}catch($){d0(e,$)}while(!0);return t&&e.shellSuspendCounter++,Jt=$l=null,Ne=s,O.H=n,O.A=r,me===null&&(ze=null,ge=0,yn()),c}function Eh(){for(;me!==null;)h0(me)}function Ah(e,t){var l=Ne;Ne|=2;var s=f0(),n=m0();ze!==e||ge!==t?($n=null,Kn=dt()+500,Va(e,t)):Ba=es(e,t);e:do try{if(ke!==0&&me!==null){t=me;var r=bt;t:switch(ke){case 1:ke=0,bt=null,Qa(e,t,r,1);break;case 2:case 9:if(kd(r)){ke=0,bt=null,g0(t);break}t=function(){ke!==2&&ke!==9||ze!==e||(ke=7),qt(e)},r.then(t,t);break e;case 3:ke=7;break e;case 4:ke=5;break e;case 7:kd(r)?(ke=0,bt=null,g0(t)):(ke=0,bt=null,Qa(e,t,r,7));break;case 5:var c=null;switch(me.tag){case 26:c=me.memoizedState;case 5:case 27:var h=me;if(c?ef(c):h.stateNode.complete){ke=0,bt=null;var A=h.sibling;if(A!==null)me=A;else{var F=h.return;F!==null?(me=F,In(F)):me=null}break t}}ke=0,bt=null,Qa(e,t,r,5);break;case 6:ke=0,bt=null,Qa(e,t,r,6);break;case 8:yo(),Re=6;break e;default:throw Error(o(462))}}Th();break}catch($){d0(e,$)}while(!0);return Jt=$l=null,O.H=s,O.A=n,Ne=l,me!==null?0:(ze=null,ge=0,yn(),Re)}function Th(){for(;me!==null&&!Pf();)h0(me)}function h0(e){var t=Bu(e.alternate,e,sl);e.memoizedProps=e.pendingProps,t===null?In(e):me=t}function g0(e){var t=e,l=t.alternate;switch(t.tag){case 15:case 0:t=Mu(l,t,t.pendingProps,t.type,void 0,ge);break;case 11:t=Mu(l,t,t.pendingProps,t.type.render,t.ref,ge);break;case 5:Li(t);default:qu(l,t),t=me=md(t,sl),t=Bu(l,t,sl)}e.memoizedProps=e.pendingProps,t===null?In(e):me=t}function Qa(e,t,l,s){Jt=$l=null,Li(t),Ua=null,bs=0;var n=t.return;try{if(bh(e,n,t,l,ge)){Re=1,qn(e,Nt(l,e.current)),me=null;return}}catch(r){if(n!==null)throw me=n,r;Re=1,qn(e,Nt(l,e.current)),me=null;return}t.flags&32768?(be||s===1?e=!0:Ba||(ge&536870912)!==0?e=!1:(Al=e=!0,(s===2||s===9||s===3||s===6)&&(s=gt.current,s!==null&&s.tag===13&&(s.flags|=16384))),x0(t,e)):In(t)}function In(e){var t=e;do{if((t.flags&32768)!==0){x0(t,Al);return}e=t.return;var l=vh(t.alternate,t,sl);if(l!==null){me=l;return}if(t=t.sibling,t!==null){me=t;return}me=t=e}while(t!==null);Re===0&&(Re=5)}function x0(e,t){do{var l=jh(e.alternate,e);if(l!==null){l.flags&=32767,me=l;return}if(l=e.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!t&&(e=e.sibling,e!==null)){me=e;return}me=e=l}while(e!==null);Re=6,me=null}function b0(e,t,l,s,n,r,c,h,A){e.cancelPendingCommit=null;do er();while(Fe!==0);if((Ne&6)!==0)throw Error(o(327));if(t!==null){if(t===e.current)throw Error(o(177));if(r=t.lanes|t.childLanes,r|=ri,om(e,l,r,c,h,A),e===ze&&(me=ze=null,ge=0),qa=t,Ul=e,nl=l,go=r,xo=n,r0=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Lh(tn,function(){return w0(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=O.T,O.T=null,n=q.p,q.p=2,c=Ne,Ne|=4;try{wh(e,t,l)}finally{Ne=c,q.p=n,O.T=s}}Fe=1,y0(),p0(),v0()}}function y0(){if(Fe===1){Fe=0;var e=Ul,t=qa,l=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||l){l=O.T,O.T=null;var s=q.p;q.p=2;var n=Ne;Ne|=4;try{Pu(t,e);var r=Uo,c=sd(e.containerInfo),h=r.focusedElem,A=r.selectionRange;if(c!==h&&h&&h.ownerDocument&&ad(h.ownerDocument.documentElement,h)){if(A!==null&&ti(h)){var F=A.start,$=A.end;if($===void 0&&($=F),"selectionStart"in h)h.selectionStart=F,h.selectionEnd=Math.min($,h.value.length);else{var P=h.ownerDocument||document,Y=P&&P.defaultView||window;if(Y.getSelection){var Z=Y.getSelection(),ie=h.textContent.length,de=Math.min(A.start,ie),Te=A.end===void 0?de:Math.min(A.end,ie);!Z.extend&&de>Te&&(c=Te,Te=de,de=c);var H=ld(h,de),R=ld(h,Te);if(H&&R&&(Z.rangeCount!==1||Z.anchorNode!==H.node||Z.anchorOffset!==H.offset||Z.focusNode!==R.node||Z.focusOffset!==R.offset)){var Q=P.createRange();Q.setStart(H.node,H.offset),Z.removeAllRanges(),de>Te?(Z.addRange(Q),Z.extend(R.node,R.offset)):(Q.setEnd(R.node,R.offset),Z.addRange(Q))}}}}for(P=[],Z=h;Z=Z.parentNode;)Z.nodeType===1&&P.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<P.length;h++){var W=P[h];W.element.scrollLeft=W.left,W.element.scrollTop=W.top}}fr=!!zo,Uo=zo=null}finally{Ne=n,q.p=s,O.T=l}}e.current=t,Fe=2}}function p0(){if(Fe===2){Fe=0;var e=Ul,t=qa,l=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||l){l=O.T,O.T=null;var s=q.p;q.p=2;var n=Ne;Ne|=4;try{Zu(e,t.alternate,t)}finally{Ne=n,q.p=s,O.T=l}}Fe=3}}function v0(){if(Fe===4||Fe===3){Fe=0,If();var e=Ul,t=qa,l=nl,s=r0;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Fe=5:(Fe=0,qa=Ul=null,j0(e,e.pendingLanes));var n=e.pendingLanes;if(n===0&&(zl=null),Rr(l),t=t.stateNode,ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(Ia,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=O.T,n=q.p,q.p=2,O.T=null;try{for(var r=e.onRecoverableError,c=0;c<s.length;c++){var h=s[c];r(h.value,{componentStack:h.stack})}}finally{O.T=t,q.p=n}}(nl&3)!==0&&er(),qt(e),n=e.pendingLanes,(l&261930)!==0&&(n&42)!==0?e===bo?Os++:(Os=0,bo=e):Os=0,Ds(0)}}function j0(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,gs(t)))}function er(){return y0(),p0(),v0(),w0()}function w0(){if(Fe!==5)return!1;var e=Ul,t=go;go=0;var l=Rr(nl),s=O.T,n=q.p;try{q.p=32>l?32:l,O.T=null,l=xo,xo=null;var r=Ul,c=nl;if(Fe=0,qa=Ul=null,nl=0,(Ne&6)!==0)throw Error(o(331));var h=Ne;if(Ne|=4,a0(r.current),e0(r,r.current,c,l),Ne=h,Ds(0,!1),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(Ia,r)}catch{}return!0}finally{q.p=n,O.T=s,j0(e,t)}}function N0(e,t,l){t=Nt(l,t),t=Ji(e.stateNode,t,2),e=kl(e,t,2),e!==null&&(ts(e,2),qt(e))}function Se(e,t,l){if(e.tag===3)N0(e,e,l);else for(;t!==null;){if(t.tag===3){N0(t,e,l);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(zl===null||!zl.has(s))){e=Nt(l,e),l=ku(2),s=kl(t,l,2),s!==null&&(Su(l,s,t,e),ts(s,2),qt(s));break}}t=t.return}}function vo(e,t,l){var s=e.pingCache;if(s===null){s=e.pingCache=new Sh;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(l)||(fo=!0,n.add(l),e=zh.bind(null,e,t,l),t.then(e,e))}function zh(e,t,l){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&l,e.warmLanes&=~l,ze===e&&(ge&l)===l&&(Re===4||Re===3&&(ge&62914560)===ge&&300>dt()-Jn?(Ne&2)===0&&Va(e,0):mo|=l,Ha===ge&&(Ha=0)),qt(e)}function k0(e,t){t===0&&(t=yc()),e=Zl(e,t),e!==null&&(ts(e,t),qt(e))}function Uh(e){var t=e.memoizedState,l=0;t!==null&&(l=t.retryLane),k0(e,l)}function Mh(e,t){var l=0;switch(e.tag){case 31:case 13:var s=e.stateNode,n=e.memoizedState;n!==null&&(l=n.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(o(314))}s!==null&&s.delete(t),k0(e,l)}function Lh(e,t){return Mr(e,t)}var tr=null,Fa=null,jo=!1,lr=!1,wo=!1,Ll=0;function qt(e){e!==Fa&&e.next===null&&(Fa===null?tr=Fa=e:Fa=Fa.next=e),lr=!0,jo||(jo=!0,Dh())}function Ds(e,t){if(!wo&&lr){wo=!0;do for(var l=!1,s=tr;s!==null;){if(e!==0){var n=s.pendingLanes;if(n===0)var r=0;else{var c=s.suspendedLanes,h=s.pingedLanes;r=(1<<31-ft(42|e)+1)-1,r&=n&~(c&~h),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(l=!0,A0(s,r))}else r=ge,r=nn(s,s===ze?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(r&3)===0||es(s,r)||(l=!0,A0(s,r));s=s.next}while(l);wo=!1}}function Oh(){S0()}function S0(){lr=jo=!1;var e=0;Ll!==0&&Yh()&&(e=Ll);for(var t=dt(),l=null,s=tr;s!==null;){var n=s.next,r=C0(s,t);r===0?(s.next=null,l===null?tr=n:l.next=n,n===null&&(Fa=l)):(l=s,(e!==0||(r&3)!==0)&&(lr=!0)),s=n}Fe!==0&&Fe!==5||Ds(e),Ll!==0&&(Ll=0)}function C0(e,t){for(var l=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,r=e.pendingLanes&-62914561;0<r;){var c=31-ft(r),h=1<<c,A=n[c];A===-1?((h&l)===0||(h&s)!==0)&&(n[c]=im(h,t)):A<=t&&(e.expiredLanes|=h),r&=~h}if(t=ze,l=ge,l=nn(e,e===t?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,l===0||e===t&&(ke===2||ke===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&Lr(s),e.callbackNode=null,e.callbackPriority=0;if((l&3)===0||es(e,l)){if(t=l&-l,t===e.callbackPriority)return t;switch(s!==null&&Lr(s),Rr(l)){case 2:case 8:l=xc;break;case 32:l=tn;break;case 268435456:l=bc;break;default:l=tn}return s=E0.bind(null,e),l=Mr(l,s),e.callbackPriority=t,e.callbackNode=l,t}return s!==null&&s!==null&&Lr(s),e.callbackPriority=2,e.callbackNode=null,2}function E0(e,t){if(Fe!==0&&Fe!==5)return e.callbackNode=null,e.callbackPriority=0,null;var l=e.callbackNode;if(er()&&e.callbackNode!==l)return null;var s=ge;return s=nn(e,e===ze?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(o0(e,s,t),C0(e,dt()),e.callbackNode!=null&&e.callbackNode===l?E0.bind(null,e):null)}function A0(e,t){if(er())return null;o0(e,t,!0)}function Dh(){Zh(function(){(Ne&6)!==0?Mr(gc,Oh):S0()})}function No(){if(Ll===0){var e=Aa;e===0&&(e=ln,ln<<=1,(ln&261888)===0&&(ln=256)),Ll=e}return Ll}function T0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:dn(""+e)}function z0(e,t){var l=t.ownerDocument.createElement("input");return l.name=t.name,l.value=t.value,e.id&&l.setAttribute("form",e.id),t.parentNode.insertBefore(l,t),e=new FormData(e),l.parentNode.removeChild(l),e}function Rh(e,t,l,s,n){if(t==="submit"&&l&&l.stateNode===n){var r=T0((n[lt]||null).action),c=s.submitter;c&&(t=(t=c[lt]||null)?T0(t.formAction):c.getAttribute("formAction"),t!==null&&(r=t,c=null));var h=new hn("action","action",null,s,n);e.push({event:h,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(Ll!==0){var A=c?z0(n,c):new FormData(n);Qi(l,{pending:!0,data:A,method:n.method,action:r},null,A)}}else typeof r=="function"&&(h.preventDefault(),A=c?z0(n,c):new FormData(n),Qi(l,{pending:!0,data:A,method:n.method,action:r},r,A))},currentTarget:n}]})}}for(var ko=0;ko<ni.length;ko++){var So=ni[ko],_h=So.toLowerCase(),Bh=So[0].toUpperCase()+So.slice(1);Lt(_h,"on"+Bh)}Lt(id,"onAnimationEnd"),Lt(od,"onAnimationIteration"),Lt(cd,"onAnimationStart"),Lt("dblclick","onDoubleClick"),Lt("focusin","onFocus"),Lt("focusout","onBlur"),Lt(eh,"onTransitionRun"),Lt(th,"onTransitionStart"),Lt(lh,"onTransitionCancel"),Lt(dd,"onTransitionEnd"),ha("onMouseEnter",["mouseout","mouseover"]),ha("onMouseLeave",["mouseout","mouseover"]),ha("onPointerEnter",["pointerout","pointerover"]),ha("onPointerLeave",["pointerout","pointerover"]),Fl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fl("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hh=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rs));function U0(e,t){t=(t&4)!==0;for(var l=0;l<e.length;l++){var s=e[l],n=s.event;s=s.listeners;e:{var r=void 0;if(t)for(var c=s.length-1;0<=c;c--){var h=s[c],A=h.instance,F=h.currentTarget;if(h=h.listener,A!==r&&n.isPropagationStopped())break e;r=h,n.currentTarget=F;try{r(n)}catch($){bn($)}n.currentTarget=null,r=A}else for(c=0;c<s.length;c++){if(h=s[c],A=h.instance,F=h.currentTarget,h=h.listener,A!==r&&n.isPropagationStopped())break e;r=h,n.currentTarget=F;try{r(n)}catch($){bn($)}n.currentTarget=null,r=A}}}}function he(e,t){var l=t[_r];l===void 0&&(l=t[_r]=new Set);var s=e+"__bubble";l.has(s)||(M0(t,e,2,!1),l.add(s))}function Co(e,t,l){var s=0;t&&(s|=4),M0(l,e,s,t)}var ar="_reactListening"+Math.random().toString(36).slice(2);function Eo(e){if(!e[ar]){e[ar]=!0,Sc.forEach(function(l){l!=="selectionchange"&&(Hh.has(l)||Co(l,!1,e),Co(l,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ar]||(t[ar]=!0,Co("selectionchange",!1,t))}}function M0(e,t,l,s){switch(of(t)){case 2:var n=mg;break;case 8:n=hg;break;default:n=Qo}l=n.bind(null,t,l,e),n=void 0,!Xr||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?e.addEventListener(t,l,{capture:!0,passive:n}):e.addEventListener(t,l,!0):n!==void 0?e.addEventListener(t,l,{passive:n}):e.addEventListener(t,l,!1)}function Ao(e,t,l,s,n){var r=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var c=s.tag;if(c===3||c===4){var h=s.stateNode.containerInfo;if(h===n)break;if(c===4)for(c=s.return;c!==null;){var A=c.tag;if((A===3||A===4)&&c.stateNode.containerInfo===n)return;c=c.return}for(;h!==null;){if(c=ua(h),c===null)return;if(A=c.tag,A===5||A===6||A===26||A===27){s=r=c;continue e}h=h.parentNode}}s=s.return}_c(function(){var F=r,$=Gr(l),P=[];e:{var Y=ud.get(e);if(Y!==void 0){var Z=hn,ie=e;switch(e){case"keypress":if(fn(l)===0)break e;case"keydown":case"keyup":Z=Mm;break;case"focusin":ie="focus",Z=$r;break;case"focusout":ie="blur",Z=$r;break;case"beforeblur":case"afterblur":Z=$r;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=qc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=vm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=Dm;break;case id:case od:case cd:Z=Nm;break;case dd:Z=_m;break;case"scroll":case"scrollend":Z=ym;break;case"wheel":Z=Hm;break;case"copy":case"cut":case"paste":Z=Sm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=Qc;break;case"toggle":case"beforetoggle":Z=Vm}var de=(t&4)!==0,Te=!de&&(e==="scroll"||e==="scrollend"),H=de?Y!==null?Y+"Capture":null:Y;de=[];for(var R=F,Q;R!==null;){var W=R;if(Q=W.stateNode,W=W.tag,W!==5&&W!==26&&W!==27||Q===null||H===null||(W=ss(R,H),W!=null&&de.push(_s(R,W,Q))),Te)break;R=R.return}0<de.length&&(Y=new Z(Y,ie,null,l,$),P.push({event:Y,listeners:de}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",Z=e==="mouseout"||e==="pointerout",Y&&l!==Fr&&(ie=l.relatedTarget||l.fromElement)&&(ua(ie)||ie[da]))break e;if((Z||Y)&&(Y=$.window===$?$:(Y=$.ownerDocument)?Y.defaultView||Y.parentWindow:window,Z?(ie=l.relatedTarget||l.toElement,Z=F,ie=ie?ua(ie):null,ie!==null&&(Te=m(ie),de=ie.tag,ie!==Te||de!==5&&de!==27&&de!==6)&&(ie=null)):(Z=null,ie=F),Z!==ie)){if(de=qc,W="onMouseLeave",H="onMouseEnter",R="mouse",(e==="pointerout"||e==="pointerover")&&(de=Qc,W="onPointerLeave",H="onPointerEnter",R="pointer"),Te=Z==null?Y:as(Z),Q=ie==null?Y:as(ie),Y=new de(W,R+"leave",Z,l,$),Y.target=Te,Y.relatedTarget=Q,W=null,ua($)===F&&(de=new de(H,R+"enter",ie,l,$),de.target=Q,de.relatedTarget=Te,W=de),Te=W,Z&&ie)t:{for(de=qh,H=Z,R=ie,Q=0,W=H;W;W=de(W))Q++;W=0;for(var ce=R;ce;ce=de(ce))W++;for(;0<Q-W;)H=de(H),Q--;for(;0<W-Q;)R=de(R),W--;for(;Q--;){if(H===R||R!==null&&H===R.alternate){de=H;break t}H=de(H),R=de(R)}de=null}else de=null;Z!==null&&L0(P,Y,Z,de,!1),ie!==null&&Te!==null&&L0(P,Te,ie,de,!0)}}e:{if(Y=F?as(F):window,Z=Y.nodeName&&Y.nodeName.toLowerCase(),Z==="select"||Z==="input"&&Y.type==="file")var je=$c;else if(Jc(Y))if(Wc)je=Wm;else{je=Km;var oe=Jm}else Z=Y.nodeName,!Z||Z.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?F&&Qr(F.elementType)&&(je=$c):je=$m;if(je&&(je=je(e,F))){Kc(P,je,l,$);break e}oe&&oe(e,Y,F),e==="focusout"&&F&&Y.type==="number"&&F.memoizedProps.value!=null&&Vr(Y,"number",Y.value)}switch(oe=F?as(F):window,e){case"focusin":(Jc(oe)||oe.contentEditable==="true")&&(va=oe,li=F,fs=null);break;case"focusout":fs=li=va=null;break;case"mousedown":ai=!0;break;case"contextmenu":case"mouseup":case"dragend":ai=!1,nd(P,l,$);break;case"selectionchange":if(Im)break;case"keydown":case"keyup":nd(P,l,$)}var fe;if(Pr)e:{switch(e){case"compositionstart":var xe="onCompositionStart";break e;case"compositionend":xe="onCompositionEnd";break e;case"compositionupdate":xe="onCompositionUpdate";break e}xe=void 0}else pa?Xc(e,l)&&(xe="onCompositionEnd"):e==="keydown"&&l.keyCode===229&&(xe="onCompositionStart");xe&&(Fc&&l.locale!=="ko"&&(pa||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&pa&&(fe=Bc()):(bl=$,Zr="value"in bl?bl.value:bl.textContent,pa=!0)),oe=sr(F,xe),0<oe.length&&(xe=new Vc(xe,e,null,l,$),P.push({event:xe,listeners:oe}),fe?xe.data=fe:(fe=Zc(l),fe!==null&&(xe.data=fe)))),(fe=Fm?Gm(e,l):Ym(e,l))&&(xe=sr(F,"onBeforeInput"),0<xe.length&&(oe=new Vc("onBeforeInput","beforeinput",null,l,$),P.push({event:oe,listeners:xe}),oe.data=fe)),Rh(P,e,F,l,$)}U0(P,t)})}function _s(e,t,l){return{instance:e,listener:t,currentTarget:l}}function sr(e,t){for(var l=t+"Capture",s=[];e!==null;){var n=e,r=n.stateNode;if(n=n.tag,n!==5&&n!==26&&n!==27||r===null||(n=ss(e,l),n!=null&&s.unshift(_s(e,n,r)),n=ss(e,t),n!=null&&s.push(_s(e,n,r))),e.tag===3)return s;e=e.return}return[]}function qh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function L0(e,t,l,s,n){for(var r=t._reactName,c=[];l!==null&&l!==s;){var h=l,A=h.alternate,F=h.stateNode;if(h=h.tag,A!==null&&A===s)break;h!==5&&h!==26&&h!==27||F===null||(A=F,n?(F=ss(l,r),F!=null&&c.unshift(_s(l,F,A))):n||(F=ss(l,r),F!=null&&c.push(_s(l,F,A)))),l=l.return}c.length!==0&&e.push({event:t,listeners:c})}var Vh=/\r\n?/g,Qh=/\u0000|\uFFFD/g;function O0(e){return(typeof e=="string"?e:""+e).replace(Vh,`
`).replace(Qh,"")}function D0(e,t){return t=O0(t),O0(e)===t}function Ae(e,t,l,s,n,r){switch(l){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||xa(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&xa(e,""+s);break;case"className":on(e,"class",s);break;case"tabIndex":on(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":on(e,l,s);break;case"style":Dc(e,s,r);break;case"data":if(t!=="object"){on(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||l!=="href")){e.removeAttribute(l);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(l);break}s=dn(""+s),e.setAttribute(l,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(l==="formAction"?(t!=="input"&&Ae(e,t,"name",n.name,n,null),Ae(e,t,"formEncType",n.formEncType,n,null),Ae(e,t,"formMethod",n.formMethod,n,null),Ae(e,t,"formTarget",n.formTarget,n,null)):(Ae(e,t,"encType",n.encType,n,null),Ae(e,t,"method",n.method,n,null),Ae(e,t,"target",n.target,n,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(l);break}s=dn(""+s),e.setAttribute(l,s);break;case"onClick":s!=null&&(e.onclick=Gt);break;case"onScroll":s!=null&&he("scroll",e);break;case"onScrollEnd":s!=null&&he("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(o(61));if(l=s.__html,l!=null){if(n.children!=null)throw Error(o(60));e.innerHTML=l}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}l=dn(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(l,""+s):e.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(l,""):e.removeAttribute(l);break;case"capture":case"download":s===!0?e.setAttribute(l,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(l,s):e.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(l,s):e.removeAttribute(l);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(l):e.setAttribute(l,s);break;case"popover":he("beforetoggle",e),he("toggle",e),rn(e,"popover",s);break;case"xlinkActuate":Ft(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":Ft(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":Ft(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":Ft(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":Ft(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":Ft(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":Ft(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":Ft(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":Ft(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":rn(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=xm.get(l)||l,rn(e,l,s))}}function To(e,t,l,s,n,r){switch(l){case"style":Dc(e,s,r);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(o(61));if(l=s.__html,l!=null){if(n.children!=null)throw Error(o(60));e.innerHTML=l}}break;case"children":typeof s=="string"?xa(e,s):(typeof s=="number"||typeof s=="bigint")&&xa(e,""+s);break;case"onScroll":s!=null&&he("scroll",e);break;case"onScrollEnd":s!=null&&he("scrollend",e);break;case"onClick":s!=null&&(e.onclick=Gt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Cc.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(n=l.endsWith("Capture"),t=l.slice(2,n?l.length-7:void 0),r=e[lt]||null,r=r!=null?r[l]:null,typeof r=="function"&&e.removeEventListener(t,r,n),typeof s=="function")){typeof r!="function"&&r!==null&&(l in e?e[l]=null:e.hasAttribute(l)&&e.removeAttribute(l)),e.addEventListener(t,s,n);break e}l in e?e[l]=s:s===!0?e.setAttribute(l,""):rn(e,l,s)}}}function We(e,t,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":he("error",e),he("load",e);var s=!1,n=!1,r;for(r in l)if(l.hasOwnProperty(r)){var c=l[r];if(c!=null)switch(r){case"src":s=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Ae(e,t,r,c,l,null)}}n&&Ae(e,t,"srcSet",l.srcSet,l,null),s&&Ae(e,t,"src",l.src,l,null);return;case"input":he("invalid",e);var h=r=c=n=null,A=null,F=null;for(s in l)if(l.hasOwnProperty(s)){var $=l[s];if($!=null)switch(s){case"name":n=$;break;case"type":c=$;break;case"checked":A=$;break;case"defaultChecked":F=$;break;case"value":r=$;break;case"defaultValue":h=$;break;case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(o(137,t));break;default:Ae(e,t,s,$,l,null)}}Uc(e,r,h,A,F,c,n,!1);return;case"select":he("invalid",e),s=c=r=null;for(n in l)if(l.hasOwnProperty(n)&&(h=l[n],h!=null))switch(n){case"value":r=h;break;case"defaultValue":c=h;break;case"multiple":s=h;default:Ae(e,t,n,h,l,null)}t=r,l=c,e.multiple=!!s,t!=null?ga(e,!!s,t,!1):l!=null&&ga(e,!!s,l,!0);return;case"textarea":he("invalid",e),r=n=s=null;for(c in l)if(l.hasOwnProperty(c)&&(h=l[c],h!=null))switch(c){case"value":s=h;break;case"defaultValue":n=h;break;case"children":r=h;break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(o(91));break;default:Ae(e,t,c,h,l,null)}Lc(e,s,n,r);return;case"option":for(A in l)if(l.hasOwnProperty(A)&&(s=l[A],s!=null))switch(A){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Ae(e,t,A,s,l,null)}return;case"dialog":he("beforetoggle",e),he("toggle",e),he("cancel",e),he("close",e);break;case"iframe":case"object":he("load",e);break;case"video":case"audio":for(s=0;s<Rs.length;s++)he(Rs[s],e);break;case"image":he("error",e),he("load",e);break;case"details":he("toggle",e);break;case"embed":case"source":case"link":he("error",e),he("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in l)if(l.hasOwnProperty(F)&&(s=l[F],s!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Ae(e,t,F,s,l,null)}return;default:if(Qr(t)){for($ in l)l.hasOwnProperty($)&&(s=l[$],s!==void 0&&To(e,t,$,s,l,void 0));return}}for(h in l)l.hasOwnProperty(h)&&(s=l[h],s!=null&&Ae(e,t,h,s,l,null))}function Fh(e,t,l,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,r=null,c=null,h=null,A=null,F=null,$=null;for(Z in l){var P=l[Z];if(l.hasOwnProperty(Z)&&P!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":A=P;default:s.hasOwnProperty(Z)||Ae(e,t,Z,null,s,P)}}for(var Y in s){var Z=s[Y];if(P=l[Y],s.hasOwnProperty(Y)&&(Z!=null||P!=null))switch(Y){case"type":r=Z;break;case"name":n=Z;break;case"checked":F=Z;break;case"defaultChecked":$=Z;break;case"value":c=Z;break;case"defaultValue":h=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(o(137,t));break;default:Z!==P&&Ae(e,t,Y,Z,s,P)}}qr(e,c,h,A,F,$,r,n);return;case"select":Z=c=h=Y=null;for(r in l)if(A=l[r],l.hasOwnProperty(r)&&A!=null)switch(r){case"value":break;case"multiple":Z=A;default:s.hasOwnProperty(r)||Ae(e,t,r,null,s,A)}for(n in s)if(r=s[n],A=l[n],s.hasOwnProperty(n)&&(r!=null||A!=null))switch(n){case"value":Y=r;break;case"defaultValue":h=r;break;case"multiple":c=r;default:r!==A&&Ae(e,t,n,r,s,A)}t=h,l=c,s=Z,Y!=null?ga(e,!!l,Y,!1):!!s!=!!l&&(t!=null?ga(e,!!l,t,!0):ga(e,!!l,l?[]:"",!1));return;case"textarea":Z=Y=null;for(h in l)if(n=l[h],l.hasOwnProperty(h)&&n!=null&&!s.hasOwnProperty(h))switch(h){case"value":break;case"children":break;default:Ae(e,t,h,null,s,n)}for(c in s)if(n=s[c],r=l[c],s.hasOwnProperty(c)&&(n!=null||r!=null))switch(c){case"value":Y=n;break;case"defaultValue":Z=n;break;case"children":break;case"dangerouslySetInnerHTML":if(n!=null)throw Error(o(91));break;default:n!==r&&Ae(e,t,c,n,s,r)}Mc(e,Y,Z);return;case"option":for(var ie in l)if(Y=l[ie],l.hasOwnProperty(ie)&&Y!=null&&!s.hasOwnProperty(ie))switch(ie){case"selected":e.selected=!1;break;default:Ae(e,t,ie,null,s,Y)}for(A in s)if(Y=s[A],Z=l[A],s.hasOwnProperty(A)&&Y!==Z&&(Y!=null||Z!=null))switch(A){case"selected":e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:Ae(e,t,A,Y,s,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var de in l)Y=l[de],l.hasOwnProperty(de)&&Y!=null&&!s.hasOwnProperty(de)&&Ae(e,t,de,null,s,Y);for(F in s)if(Y=s[F],Z=l[F],s.hasOwnProperty(F)&&Y!==Z&&(Y!=null||Z!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(o(137,t));break;default:Ae(e,t,F,Y,s,Z)}return;default:if(Qr(t)){for(var Te in l)Y=l[Te],l.hasOwnProperty(Te)&&Y!==void 0&&!s.hasOwnProperty(Te)&&To(e,t,Te,void 0,s,Y);for($ in s)Y=s[$],Z=l[$],!s.hasOwnProperty($)||Y===Z||Y===void 0&&Z===void 0||To(e,t,$,Y,s,Z);return}}for(var H in l)Y=l[H],l.hasOwnProperty(H)&&Y!=null&&!s.hasOwnProperty(H)&&Ae(e,t,H,null,s,Y);for(P in s)Y=s[P],Z=l[P],!s.hasOwnProperty(P)||Y===Z||Y==null&&Z==null||Ae(e,t,P,Y,s,Z)}function R0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Gh(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,l=performance.getEntriesByType("resource"),s=0;s<l.length;s++){var n=l[s],r=n.transferSize,c=n.initiatorType,h=n.duration;if(r&&h&&R0(c)){for(c=0,h=n.responseEnd,s+=1;s<l.length;s++){var A=l[s],F=A.startTime;if(F>h)break;var $=A.transferSize,P=A.initiatorType;$&&R0(P)&&(A=A.responseEnd,c+=$*(A<h?1:(h-F)/(A-F)))}if(--s,t+=8*(r+c)/(n.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var zo=null,Uo=null;function nr(e){return e.nodeType===9?e:e.ownerDocument}function _0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function B0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Mo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Lo=null;function Yh(){var e=window.event;return e&&e.type==="popstate"?e===Lo?!1:(Lo=e,!0):(Lo=null,!1)}var H0=typeof setTimeout=="function"?setTimeout:void 0,Xh=typeof clearTimeout=="function"?clearTimeout:void 0,q0=typeof Promise=="function"?Promise:void 0,Zh=typeof queueMicrotask=="function"?queueMicrotask:typeof q0<"u"?function(e){return q0.resolve(null).then(e).catch(Jh)}:H0;function Jh(e){setTimeout(function(){throw e})}function Ol(e){return e==="head"}function V0(e,t){var l=t,s=0;do{var n=l.nextSibling;if(e.removeChild(l),n&&n.nodeType===8)if(l=n.data,l==="/$"||l==="/&"){if(s===0){e.removeChild(n),Za(t);return}s--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")s++;else if(l==="html")Bs(e.ownerDocument.documentElement);else if(l==="head"){l=e.ownerDocument.head,Bs(l);for(var r=l.firstChild;r;){var c=r.nextSibling,h=r.nodeName;r[ls]||h==="SCRIPT"||h==="STYLE"||h==="LINK"&&r.rel.toLowerCase()==="stylesheet"||l.removeChild(r),r=c}}else l==="body"&&Bs(e.ownerDocument.body);l=n}while(l);Za(t)}function Q0(e,t){var l=e;e=0;do{var s=l.nextSibling;if(l.nodeType===1?t?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(t?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),s&&s.nodeType===8)if(l=s.data,l==="/$"){if(e===0)break;e--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||e++;l=s}while(l)}function Oo(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var l=t;switch(t=t.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Oo(l),Br(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}e.removeChild(l)}}function Kh(e,t,l,s){for(;e.nodeType===1;){var n=l;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[ls])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(r=e.getAttribute("rel"),r==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(r!==n.rel||e.getAttribute("href")!==(n.href==null||n.href===""?null:n.href)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin)||e.getAttribute("title")!==(n.title==null?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(r=e.getAttribute("src"),(r!==(n.src==null?null:n.src)||e.getAttribute("type")!==(n.type==null?null:n.type)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var r=n.name==null?null:""+n.name;if(n.type==="hidden"&&e.getAttribute("name")===r)return e}else return e;if(e=At(e.nextSibling),e===null)break}return null}function $h(e,t,l){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!l||(e=At(e.nextSibling),e===null))return null;return e}function F0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=At(e.nextSibling),e===null))return null;return e}function Do(e){return e.data==="$?"||e.data==="$~"}function Ro(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Wh(e,t){var l=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||l.readyState!=="loading")t();else{var s=function(){t(),l.removeEventListener("DOMContentLoaded",s)};l.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function At(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var _o=null;function G0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var l=e.data;if(l==="/$"||l==="/&"){if(t===0)return At(e.nextSibling);t--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||t++}e=e.nextSibling}return null}function Y0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var l=e.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(t===0)return e;t--}else l!=="/$"&&l!=="/&"||t++}e=e.previousSibling}return null}function X0(e,t,l){switch(t=nr(l),e){case"html":if(e=t.documentElement,!e)throw Error(o(452));return e;case"head":if(e=t.head,!e)throw Error(o(453));return e;case"body":if(e=t.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function Bs(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Br(e)}var Tt=new Map,Z0=new Set;function rr(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var rl=q.d;q.d={f:Ph,r:Ih,D:eg,C:tg,L:lg,m:ag,X:ng,S:sg,M:rg};function Ph(){var e=rl.f(),t=Wn();return e||t}function Ih(e){var t=fa(e);t!==null&&t.tag===5&&t.type==="form"?du(t):rl.r(e)}var Ga=typeof document>"u"?null:document;function J0(e,t,l){var s=Ga;if(s&&typeof t=="string"&&t){var n=jt(t);n='link[rel="'+e+'"][href="'+n+'"]',typeof l=="string"&&(n+='[crossorigin="'+l+'"]'),Z0.has(n)||(Z0.add(n),e={rel:e,crossOrigin:l,href:t},s.querySelector(n)===null&&(t=s.createElement("link"),We(t,"link",e),Ge(t),s.head.appendChild(t)))}}function eg(e){rl.D(e),J0("dns-prefetch",e,null)}function tg(e,t){rl.C(e,t),J0("preconnect",e,t)}function lg(e,t,l){rl.L(e,t,l);var s=Ga;if(s&&e&&t){var n='link[rel="preload"][as="'+jt(t)+'"]';t==="image"&&l&&l.imageSrcSet?(n+='[imagesrcset="'+jt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(n+='[imagesizes="'+jt(l.imageSizes)+'"]')):n+='[href="'+jt(e)+'"]';var r=n;switch(t){case"style":r=Ya(e);break;case"script":r=Xa(e)}Tt.has(r)||(e=p({rel:"preload",href:t==="image"&&l&&l.imageSrcSet?void 0:e,as:t},l),Tt.set(r,e),s.querySelector(n)!==null||t==="style"&&s.querySelector(Hs(r))||t==="script"&&s.querySelector(qs(r))||(t=s.createElement("link"),We(t,"link",e),Ge(t),s.head.appendChild(t)))}}function ag(e,t){rl.m(e,t);var l=Ga;if(l&&e){var s=t&&typeof t.as=="string"?t.as:"script",n='link[rel="modulepreload"][as="'+jt(s)+'"][href="'+jt(e)+'"]',r=n;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Xa(e)}if(!Tt.has(r)&&(e=p({rel:"modulepreload",href:e},t),Tt.set(r,e),l.querySelector(n)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(qs(r)))return}s=l.createElement("link"),We(s,"link",e),Ge(s),l.head.appendChild(s)}}}function sg(e,t,l){rl.S(e,t,l);var s=Ga;if(s&&e){var n=ma(s).hoistableStyles,r=Ya(e);t=t||"default";var c=n.get(r);if(!c){var h={loading:0,preload:null};if(c=s.querySelector(Hs(r)))h.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},l),(l=Tt.get(r))&&Bo(e,l);var A=c=s.createElement("link");Ge(A),We(A,"link",e),A._p=new Promise(function(F,$){A.onload=F,A.onerror=$}),A.addEventListener("load",function(){h.loading|=1}),A.addEventListener("error",function(){h.loading|=2}),h.loading|=4,ir(c,t,s)}c={type:"stylesheet",instance:c,count:1,state:h},n.set(r,c)}}}function ng(e,t){rl.X(e,t);var l=Ga;if(l&&e){var s=ma(l).hoistableScripts,n=Xa(e),r=s.get(n);r||(r=l.querySelector(qs(n)),r||(e=p({src:e,async:!0},t),(t=Tt.get(n))&&Ho(e,t),r=l.createElement("script"),Ge(r),We(r,"link",e),l.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(n,r))}}function rg(e,t){rl.M(e,t);var l=Ga;if(l&&e){var s=ma(l).hoistableScripts,n=Xa(e),r=s.get(n);r||(r=l.querySelector(qs(n)),r||(e=p({src:e,async:!0,type:"module"},t),(t=Tt.get(n))&&Ho(e,t),r=l.createElement("script"),Ge(r),We(r,"link",e),l.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(n,r))}}function K0(e,t,l,s){var n=(n=pe.current)?rr(n):null;if(!n)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(t=Ya(l.href),l=ma(n).hoistableStyles,s=l.get(t),s||(s={type:"style",instance:null,count:0,state:null},l.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){e=Ya(l.href);var r=ma(n).hoistableStyles,c=r.get(e);if(c||(n=n.ownerDocument||n,c={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(e,c),(r=n.querySelector(Hs(e)))&&!r._p&&(c.instance=r,c.state.loading=5),Tt.has(e)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Tt.set(e,l),r||ig(n,e,l,c.state))),t&&s===null)throw Error(o(528,""));return c}if(t&&s!==null)throw Error(o(529,""));return null;case"script":return t=l.async,l=l.src,typeof l=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Xa(l),l=ma(n).hoistableScripts,s=l.get(t),s||(s={type:"script",instance:null,count:0,state:null},l.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Ya(e){return'href="'+jt(e)+'"'}function Hs(e){return'link[rel="stylesheet"]['+e+"]"}function $0(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function ig(e,t,l,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),We(t,"link",l),Ge(t),e.head.appendChild(t))}function Xa(e){return'[src="'+jt(e)+'"]'}function qs(e){return"script[async]"+e}function W0(e,t,l){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+jt(l.href)+'"]');if(s)return t.instance=s,Ge(s),s;var n=p({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),Ge(s),We(s,"style",n),ir(s,l.precedence,e),t.instance=s;case"stylesheet":n=Ya(l.href);var r=e.querySelector(Hs(n));if(r)return t.state.loading|=4,t.instance=r,Ge(r),r;s=$0(l),(n=Tt.get(n))&&Bo(s,n),r=(e.ownerDocument||e).createElement("link"),Ge(r);var c=r;return c._p=new Promise(function(h,A){c.onload=h,c.onerror=A}),We(r,"link",s),t.state.loading|=4,ir(r,l.precedence,e),t.instance=r;case"script":return r=Xa(l.src),(n=e.querySelector(qs(r)))?(t.instance=n,Ge(n),n):(s=l,(n=Tt.get(r))&&(s=p({},l),Ho(s,n)),e=e.ownerDocument||e,n=e.createElement("script"),Ge(n),We(n,"link",s),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(o(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,ir(s,l.precedence,e));return t.instance}function ir(e,t,l){for(var s=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=s.length?s[s.length-1]:null,r=n,c=0;c<s.length;c++){var h=s[c];if(h.dataset.precedence===t)r=h;else if(r!==n)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=l.nodeType===9?l.head:l,t.insertBefore(e,t.firstChild))}function Bo(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Ho(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var or=null;function P0(e,t,l){if(or===null){var s=new Map,n=or=new Map;n.set(l,s)}else n=or,s=n.get(l),s||(s=new Map,n.set(l,s));if(s.has(e))return s;for(s.set(e,null),l=l.getElementsByTagName(e),n=0;n<l.length;n++){var r=l[n];if(!(r[ls]||r[Ze]||e==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var c=r.getAttribute(t)||"";c=e+c;var h=s.get(c);h?h.push(r):s.set(c,[r])}}return s}function I0(e,t,l){e=e.ownerDocument||e,e.head.insertBefore(l,t==="title"?e.querySelector("head > title"):null)}function og(e,t,l){if(l===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ef(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function cg(e,t,l,s){if(l.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var n=Ya(s.href),r=t.querySelector(Hs(n));if(r){t=r._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=cr.bind(e),t.then(e,e)),l.state.loading|=4,l.instance=r,Ge(r);return}r=t.ownerDocument||t,s=$0(s),(n=Tt.get(n))&&Bo(s,n),r=r.createElement("link"),Ge(r);var c=r;c._p=new Promise(function(h,A){c.onload=h,c.onerror=A}),We(r,"link",s),l.instance=r}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(l,t),(t=l.state.preload)&&(l.state.loading&3)===0&&(e.count++,l=cr.bind(e),t.addEventListener("load",l),t.addEventListener("error",l))}}var qo=0;function dg(e,t){return e.stylesheets&&e.count===0&&ur(e,e.stylesheets),0<e.count||0<e.imgCount?function(l){var s=setTimeout(function(){if(e.stylesheets&&ur(e,e.stylesheets),e.unsuspend){var r=e.unsuspend;e.unsuspend=null,r()}},6e4+t);0<e.imgBytes&&qo===0&&(qo=62500*Gh());var n=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&ur(e,e.stylesheets),e.unsuspend)){var r=e.unsuspend;e.unsuspend=null,r()}},(e.imgBytes>qo?50:800)+t);return e.unsuspend=l,function(){e.unsuspend=null,clearTimeout(s),clearTimeout(n)}}:null}function cr(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ur(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var dr=null;function ur(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,dr=new Map,t.forEach(ug,e),dr=null,cr.call(e))}function ug(e,t){if(!(t.state.loading&4)){var l=dr.get(e);if(l)var s=l.get(null);else{l=new Map,dr.set(e,l);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<n.length;r++){var c=n[r];(c.nodeName==="LINK"||c.getAttribute("media")!=="not all")&&(l.set(c.dataset.precedence,c),s=c)}s&&l.set(null,s)}n=t.instance,c=n.getAttribute("data-precedence"),r=l.get(c)||s,r===s&&l.set(null,n),l.set(c,n),this.count++,s=cr.bind(this),n.addEventListener("load",s),n.addEventListener("error",s),r?r.parentNode.insertBefore(n,r.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(n,e.firstChild)),t.state.loading|=4}}var Vs={$$typeof:w,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function fg(e,t,l,s,n,r,c,h,A){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Or(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Or(0),this.hiddenUpdates=Or(null),this.identifierPrefix=s,this.onUncaughtError=n,this.onCaughtError=r,this.onRecoverableError=c,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function tf(e,t,l,s,n,r,c,h,A,F,$,P){return e=new fg(e,t,l,c,A,F,$,P,h),t=1,r===!0&&(t|=24),r=ht(3,null,null,t),e.current=r,r.stateNode=e,t=yi(),t.refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:s,isDehydrated:l,cache:t},wi(r),e}function lf(e){return e?(e=Na,e):Na}function af(e,t,l,s,n,r){n=lf(n),s.context===null?s.context=n:s.pendingContext=n,s=Nl(t),s.payload={element:l},r=r===void 0?null:r,r!==null&&(s.callback=r),l=kl(e,s,t),l!==null&&(ot(l,e,t),ps(l,e,t))}function sf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var l=e.retryLane;e.retryLane=l!==0&&l<t?l:t}}function Vo(e,t){sf(e,t),(e=e.alternate)&&sf(e,t)}function nf(e){if(e.tag===13||e.tag===31){var t=Zl(e,67108864);t!==null&&ot(t,e,67108864),Vo(e,67108864)}}function rf(e){if(e.tag===13||e.tag===31){var t=pt();t=Dr(t);var l=Zl(e,t);l!==null&&ot(l,e,t),Vo(e,t)}}var fr=!0;function mg(e,t,l,s){var n=O.T;O.T=null;var r=q.p;try{q.p=2,Qo(e,t,l,s)}finally{q.p=r,O.T=n}}function hg(e,t,l,s){var n=O.T;O.T=null;var r=q.p;try{q.p=8,Qo(e,t,l,s)}finally{q.p=r,O.T=n}}function Qo(e,t,l,s){if(fr){var n=Fo(s);if(n===null)Ao(e,t,s,mr,l),cf(e,s);else if(xg(n,e,t,l,s))s.stopPropagation();else if(cf(e,s),t&4&&-1<gg.indexOf(e)){for(;n!==null;){var r=fa(n);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var c=Ql(r.pendingLanes);if(c!==0){var h=r;for(h.pendingLanes|=2,h.entangledLanes|=2;c;){var A=1<<31-ft(c);h.entanglements[1]|=A,c&=~A}qt(r),(Ne&6)===0&&(Kn=dt()+500,Ds(0))}}break;case 31:case 13:h=Zl(r,2),h!==null&&ot(h,r,2),Wn(),Vo(r,2)}if(r=Fo(s),r===null&&Ao(e,t,s,mr,l),r===n)break;n=r}n!==null&&s.stopPropagation()}else Ao(e,t,s,null,l)}}function Fo(e){return e=Gr(e),Go(e)}var mr=null;function Go(e){if(mr=null,e=ua(e),e!==null){var t=m(e);if(t===null)e=null;else{var l=t.tag;if(l===13){if(e=g(t),e!==null)return e;e=null}else if(l===31){if(e=b(t),e!==null)return e;e=null}else if(l===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return mr=e,null}function of(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(em()){case gc:return 2;case xc:return 8;case tn:case tm:return 32;case bc:return 268435456;default:return 32}default:return 32}}var Yo=!1,Dl=null,Rl=null,_l=null,Qs=new Map,Fs=new Map,Bl=[],gg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function cf(e,t){switch(e){case"focusin":case"focusout":Dl=null;break;case"dragenter":case"dragleave":Rl=null;break;case"mouseover":case"mouseout":_l=null;break;case"pointerover":case"pointerout":Qs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fs.delete(t.pointerId)}}function Gs(e,t,l,s,n,r){return e===null||e.nativeEvent!==r?(e={blockedOn:t,domEventName:l,eventSystemFlags:s,nativeEvent:r,targetContainers:[n]},t!==null&&(t=fa(t),t!==null&&nf(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function xg(e,t,l,s,n){switch(t){case"focusin":return Dl=Gs(Dl,e,t,l,s,n),!0;case"dragenter":return Rl=Gs(Rl,e,t,l,s,n),!0;case"mouseover":return _l=Gs(_l,e,t,l,s,n),!0;case"pointerover":var r=n.pointerId;return Qs.set(r,Gs(Qs.get(r)||null,e,t,l,s,n)),!0;case"gotpointercapture":return r=n.pointerId,Fs.set(r,Gs(Fs.get(r)||null,e,t,l,s,n)),!0}return!1}function df(e){var t=ua(e.target);if(t!==null){var l=m(t);if(l!==null){if(t=l.tag,t===13){if(t=g(l),t!==null){e.blockedOn=t,Nc(e.priority,function(){rf(l)});return}}else if(t===31){if(t=b(l),t!==null){e.blockedOn=t,Nc(e.priority,function(){rf(l)});return}}else if(t===3&&l.stateNode.current.memoizedState.isDehydrated){e.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hr(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var l=Fo(e.nativeEvent);if(l===null){l=e.nativeEvent;var s=new l.constructor(l.type,l);Fr=s,l.target.dispatchEvent(s),Fr=null}else return t=fa(l),t!==null&&nf(t),e.blockedOn=l,!1;t.shift()}return!0}function uf(e,t,l){hr(e)&&l.delete(t)}function bg(){Yo=!1,Dl!==null&&hr(Dl)&&(Dl=null),Rl!==null&&hr(Rl)&&(Rl=null),_l!==null&&hr(_l)&&(_l=null),Qs.forEach(uf),Fs.forEach(uf)}function gr(e,t){e.blockedOn===t&&(e.blockedOn=null,Yo||(Yo=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,bg)))}var xr=null;function ff(e){xr!==e&&(xr=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){xr===e&&(xr=null);for(var t=0;t<e.length;t+=3){var l=e[t],s=e[t+1],n=e[t+2];if(typeof s!="function"){if(Go(s||l)===null)continue;break}var r=fa(l);r!==null&&(e.splice(t,3),t-=3,Qi(r,{pending:!0,data:n,method:l.method,action:s},s,n))}}))}function Za(e){function t(A){return gr(A,e)}Dl!==null&&gr(Dl,e),Rl!==null&&gr(Rl,e),_l!==null&&gr(_l,e),Qs.forEach(t),Fs.forEach(t);for(var l=0;l<Bl.length;l++){var s=Bl[l];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Bl.length&&(l=Bl[0],l.blockedOn===null);)df(l),l.blockedOn===null&&Bl.shift();if(l=(e.ownerDocument||e).$$reactFormReplay,l!=null)for(s=0;s<l.length;s+=3){var n=l[s],r=l[s+1],c=n[lt]||null;if(typeof r=="function")c||ff(l);else if(c){var h=null;if(r&&r.hasAttribute("formAction")){if(n=r,c=r[lt]||null)h=c.formAction;else if(Go(n)!==null)continue}else h=c.action;typeof h=="function"?l[s+1]=h:(l.splice(s,3),s-=3),ff(l)}}}function mf(){function e(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(c){return n=c})},focusReset:"manual",scroll:"manual"})}function t(){n!==null&&(n(),n=null),s||setTimeout(l,20)}function l(){if(!s&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,n=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(l,100),function(){s=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),n!==null&&(n(),n=null)}}}function Xo(e){this._internalRoot=e}br.prototype.render=Xo.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(o(409));var l=t.current,s=pt();af(l,s,e,t,null,null)},br.prototype.unmount=Xo.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;af(e.current,2,null,e,null,null),Wn(),t[da]=null}};function br(e){this._internalRoot=e}br.prototype.unstable_scheduleHydration=function(e){if(e){var t=wc();e={blockedOn:null,target:e,priority:t};for(var l=0;l<Bl.length&&t!==0&&t<Bl[l].priority;l++);Bl.splice(l,0,e),l===0&&df(e)}};var hf=f.version;if(hf!=="19.2.0")throw Error(o(527,hf,"19.2.0"));q.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=j(t),e=e!==null?S(e):null,e=e===null?null:e.stateNode,e};var yg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yr.isDisabled&&yr.supportsFiber)try{Ia=yr.inject(yg),ut=yr}catch{}}return Xs.createRoot=function(e,t){if(!d(e))throw Error(o(299));var l=!1,s="",n=vu,r=ju,c=wu;return t!=null&&(t.unstable_strictMode===!0&&(l=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(n=t.onUncaughtError),t.onCaughtError!==void 0&&(r=t.onCaughtError),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=tf(e,1,!1,null,null,l,s,null,n,r,c,mf),e[da]=t.current,Eo(e),new Xo(t)},Xs.hydrateRoot=function(e,t,l){if(!d(e))throw Error(o(299));var s=!1,n="",r=vu,c=ju,h=wu,A=null;return l!=null&&(l.unstable_strictMode===!0&&(s=!0),l.identifierPrefix!==void 0&&(n=l.identifierPrefix),l.onUncaughtError!==void 0&&(r=l.onUncaughtError),l.onCaughtError!==void 0&&(c=l.onCaughtError),l.onRecoverableError!==void 0&&(h=l.onRecoverableError),l.formState!==void 0&&(A=l.formState)),t=tf(e,1,!0,t,l??null,s,n,A,r,c,h,mf),t.context=lf(null),l=t.current,s=pt(),s=Dr(s),n=Nl(s),n.callback=null,kl(l,n,s),l=s,t.current.lanes=l,ts(t,l),qt(t),e[da]=t.current,Eo(e),new br(t)},Xs.version="19.2.0",Xs}var vf;function Eg(){if(vf)return Jo.exports;vf=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(f){console.error(f)}}return i(),Jo.exports=Cg(),Jo.exports}var Ag=Eg();const Tg=Tf(Ag),zf="http://localhost:5000/api",ye=async(i,f)=>{const x=await fetch(`${zf}${i}`,{headers:{"Content-Type":"application/json"},...f});if(!x.ok){const o=await x.json().catch(()=>({}));throw new Error(o.message||`API Error: ${x.statusText}`)}return x.json()},zg=async i=>{const f=await fetch(`${zf}/upload`,{method:"POST",body:i});if(!f.ok){const x=await f.json().catch(()=>({}));throw new Error(x.message||`API Error: ${f.statusText}`)}return f.json()},cl=()=>ye("/classes"),Ug=i=>ye("/classes",{method:"POST",body:JSON.stringify({name:i})}),Mg=(i,f)=>ye(`/classes/${i}`,{method:"PUT",body:JSON.stringify({name:f})}),Lg=i=>ye(`/classes/${i}`,{method:"DELETE"}),dl=i=>ye(`/subjects?classId=${i}`),Og=(i,f)=>ye("/subjects",{method:"POST",body:JSON.stringify({name:i,classId:f})}),Dg=(i,f)=>ye(`/subjects/${i}`,{method:"PUT",body:JSON.stringify({name:f})}),Rg=i=>ye(`/subjects/${i}`,{method:"DELETE"}),ul=i=>ye(`/units?subjectId=${i}`),_g=(i,f)=>ye("/units",{method:"POST",body:JSON.stringify({name:i,subjectId:f})}),Bg=(i,f)=>ye(`/units/${i}`,{method:"PUT",body:JSON.stringify({name:f})}),Hg=i=>ye(`/units/${i}`,{method:"DELETE"}),fl=i=>ye(`/subUnits?unitId=${i}`),qg=(i,f)=>ye("/subUnits",{method:"POST",body:JSON.stringify({name:i,unitId:f})}),Vg=(i,f)=>ye(`/subUnits/${i}`,{method:"PUT",body:JSON.stringify({name:f})}),Qg=i=>ye(`/subUnits/${i}`,{method:"DELETE"}),ml=i=>ye(`/lessons?subUnitId=${i}`),Fg=(i,f)=>ye("/lessons",{method:"POST",body:JSON.stringify({name:i,subUnitId:f})}),Gg=(i,f)=>ye(`/lessons/${i}`,{method:"PUT",body:JSON.stringify({name:f})}),Yg=i=>ye(`/lessons/${i}`,{method:"DELETE"}),tt=(i,f)=>{let x=`/content?lessonId=${i}`;return console.log("[API] getContentsByLessonId called:",{lessonId:i,types:f,url:x}),f&&f.length>0&&(x+=`&type=${f[0]}`,console.log("[API] getContentsByLessonId with type filter:",x)),ye(x)},Xg=async i=>{const f=await tt(i),x={};return f.forEach(o=>{x[o.type]=o.count}),x},Ut=i=>(console.log("[API] addContent called:",i),ye("/content",{method:"POST",body:JSON.stringify(i)})),Zg=async i=>{const f=i.map(x=>Ut(x));return Promise.all(f)},$a=(i,f)=>ye(`/content/${i}`,{method:"PUT",body:JSON.stringify(f)}),Qt=i=>ye(`/content/${i}`,{method:"DELETE"}),Jg=i=>ye(`/content/${i}/view`,{method:"POST"}),Wa=async i=>"",Kg=(i,f)=>ye("/auth/login",{method:"POST",body:JSON.stringify({username:i,password:f})}),$g=()=>ye("/users"),Wg=i=>ye("/users",{method:"POST",body:JSON.stringify(i)}),Pg=(i,f)=>ye(`/users/${i}`,{method:"PUT",body:JSON.stringify(f)}),Ig=i=>ye(`/users/${i}`,{method:"DELETE"}),ex=(i,f)=>ye(`/users/${i}/profile`,{method:"PUT",body:JSON.stringify(f)}),tx=(i,f)=>ye(`/users/${i}/update-profile`,{method:"PUT",body:JSON.stringify(f)}),lx=(i,f)=>ye(`/users/${i}/change-password`,{method:"PUT",body:JSON.stringify(f)}),ax=()=>ye("/stats"),il="learningPlatformNavigation",ra="learningPlatformLastActivity",Wo="learningPlatformRestartDetected",sx=1800*1e3,Uf={classId:null,subjectId:null,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null,activePage:"browser",scrollPosition:0},Mf={classId:null,subjectId:null,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null,scrollPosition:0},Zs={adminState:Uf,teacherState:Mf,lastUpdated:Date.now()},nx=()=>{const[i,f]=u.useState(()=>{try{const y=localStorage.getItem(il),v=localStorage.getItem(ra),z=localStorage.getItem(Wo);if(console.log("[PersistentNavigation] Initializing...",{hasSavedState:!!y,hasLastActivity:!!v,restartDetected:z}),z==="true")return console.log("[PersistentNavigation] System restart detected, clearing state"),localStorage.removeItem(il),localStorage.removeItem(ra),localStorage.removeItem(Wo),Zs;if(v){const C=parseInt(v,10);if(Date.now()-C>sx)return console.log("[PersistentNavigation] Session expired, clearing state"),localStorage.removeItem(il),localStorage.removeItem(ra),Zs}if(y)try{const C=JSON.parse(y);console.log("[PersistentNavigation] Successfully loaded saved state:",C);const E=C.adminState&&(C.adminState.classId||C.adminState.subjectId||C.adminState.unitId||C.adminState.lessonId||C.adminState.selectedResourceType),U=C.teacherState&&(C.teacherState.classId||C.teacherState.subjectId||C.teacherState.unitId||C.teacherState.lessonId||C.teacherState.selectedResourceType);console.log("[PersistentNavigation] State has data:",{hasAdminData:E,hasTeacherData:U});const w={adminState:{...Uf,...C.adminState},teacherState:{...Mf,...C.teacherState},lastUpdated:C.lastUpdated||Date.now()};return console.log("[PersistentNavigation] Restored state:",w),w}catch(C){console.error("[PersistentNavigation] Failed to parse saved state:",C),localStorage.removeItem(il),localStorage.removeItem(ra)}else console.log("[PersistentNavigation] No saved state found, using defaults")}catch(y){console.error("[PersistentNavigation] Error reading navigation state:",y),localStorage.removeItem(il),localStorage.removeItem(ra)}return Zs}),x=u.useCallback(()=>{try{localStorage.setItem(ra,Date.now().toString())}catch(y){console.error("Failed to update last activity:",y)}},[]),o=u.useRef(void 0),d=u.useCallback(y=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{const v={...i,...y,lastUpdated:Date.now()};console.log("[PersistentNavigation] Debounced saving state:",v),f(v),localStorage.setItem(il,JSON.stringify(v)),x()},100)},[i,x]),m=u.useCallback(y=>{console.log("[PersistentNavigation] Updating admin state with:",y);const v={...i.adminState,...y};console.log("[PersistentNavigation] New admin state will be:",v),d({adminState:v})},[i.adminState,d]),g=u.useCallback(y=>{console.log("[PersistentNavigation] Updating teacher state with:",y);const v={...i.teacherState,...y};console.log("[PersistentNavigation] New teacher state will be:",v),d({teacherState:v})},[i.teacherState,d]),b=u.useCallback(()=>{console.log("[PersistentNavigation] Clearing navigation state"),localStorage.removeItem(il),localStorage.removeItem(ra),f(Zs)},[]);u.useEffect(()=>{const y=C=>{console.log("[PersistentNavigation] Browser closing, marking restart"),localStorage.setItem(Wo,"true")},v=()=>{document.visibilityState==="visible"&&x()},z=()=>{console.log("[PersistentNavigation] Page hiding, force saving state");try{localStorage.setItem(il,JSON.stringify(i))}catch(C){console.error("Failed to save state on page hide:",C)}};return window.addEventListener("beforeunload",y),window.addEventListener("pagehide",z),document.addEventListener("visibilitychange",v),x(),()=>{window.removeEventListener("beforeunload",y),window.removeEventListener("pagehide",z),document.removeEventListener("visibilitychange",v)}},[x,i]),u.useEffect(()=>{const y=setInterval(x,3e5);return()=>clearInterval(y)},[x]);const k=u.useCallback(()=>{console.log("[PersistentNavigation] Force saving current state"),localStorage.setItem(il,JSON.stringify(i))},[i]),j=()=>{const y=i.adminState,v=i.teacherState,z=!!(y.classId||y.subjectId||y.unitId||y.subUnitId||y.lessonId||y.selectedResourceType),C=!!(v.classId||v.subjectId||v.unitId||v.subUnitId||v.lessonId||v.selectedResourceType);return z||C},S=i.lastUpdated!==Zs.lastUpdated,p=j(),T=!!(S&&p);return{adminState:i.adminState,teacherState:i.teacherState,updateAdminState:m,updateTeacherState:g,clearNavigationState:b,isNavigationRestored:T,getCurrentState:()=>({adminState:i.adminState,teacherState:i.teacherState,lastUpdated:i.lastUpdated,isRestored:T}),forceSave:k}},rx={classId:null,subjectId:null,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null,activePage:"browser",scrollPosition:0},ix={classId:null,subjectId:null,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null,scrollPosition:0},Po={user:null,token:null,adminState:rx,teacherState:ix,fontSize:12},pr="learningPlatformSession",Lf=u.createContext(void 0),ox=({children:i})=>{const[f,x]=u.useState(()=>{try{const N=localStorage.getItem(pr);if(N){const D=JSON.parse(N);return{...Po,user:D.user||null,token:D.token||null,fontSize:typeof D.fontSize=="number"?D.fontSize:12}}}catch(N){console.error("Failed to parse session from localStorage",N),localStorage.removeItem(pr)}return Po}),{adminState:o,teacherState:d,updateAdminState:m,updateTeacherState:g,clearNavigationState:b,isNavigationRestored:k,getCurrentState:j,forceSave:S}=nx(),p=u.useMemo(()=>{const N={...f,adminState:o,teacherState:d};return console.log("[SessionContext] Combining session and navigation state:",{session:{user:f.user?"present":"null",token:f.token?"present":"null",fontSize:f.fontSize},navigation:{adminState:{classId:o.classId,subjectId:o.subjectId,unitId:o.unitId,subUnitId:o.subUnitId,lessonId:o.lessonId},teacherState:{classId:d.classId,subjectId:d.subjectId,unitId:d.unitId,subUnitId:d.subUnitId,lessonId:d.lessonId}},isNavigationRestored:k}),N},[f,o,d,k]);u.useEffect(()=>{try{const N={user:p.user,token:p.token,fontSize:p.fontSize};localStorage.setItem(pr,JSON.stringify(N))}catch(N){console.error("Failed to save session to localStorage",N)}},[p.user,p.token,p.fontSize]);const T=u.useCallback(N=>{x(D=>({...D,user:N.user,token:N.token}))},[]),y=u.useCallback(()=>{x(Po),localStorage.removeItem(pr),b()},[b]),v=u.useCallback(N=>{x(D=>D.user?{...D,user:N}:D)},[]),z=u.useCallback(N=>{m(N)},[m]),C=u.useCallback(N=>{g(N)},[g]),E=u.useCallback(N=>{x(D=>({...D,fontSize:N}))},[]),U=u.useCallback(()=>{b()},[b]),w=u.useMemo(()=>({session:p,login:T,logout:y,updateProfile:v,updateAdminState:z,updateTeacherState:C,setFontSize:E,clearNavigationState:U,isNavigationRestored:k,getCurrentNavigationState:j,forceSaveNavigation:S}),[p,T,y,v,z,C,E,U,k,j,S]);return a.jsx(Lf.Provider,{value:w,children:i})},Rt=()=>{const i=u.useContext(Lf);if(i===void 0)throw new Error("useSession must be used within a SessionProvider");return i},cx=()=>{const[i,f]=u.useState([]),x=["","","","","","","","","","","","","","","","","1","2","3","4","5","6","7","8","9","0","+","-","","","=","%","E=mc","a+b=c","f(x)","lim","log","sin","cos","tan","HO","CO","NaCl","HSO","O","N","He","Ne","Ar","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""];return u.useEffect(()=>{const o=g=>({id:g,x:Math.random()*100,y:Math.random()*100,symbol:x[Math.floor(Math.random()*x.length)],delay:Math.random()*5,duration:8+Math.random()*12,size:12+Math.random()*20,opacity:.1+Math.random()*.3}),d=Array.from({length:25},(g,b)=>o(b));f(d);const m=setInterval(()=>{f(g=>{const b=[...g];return b.length<30&&b.push(o(Date.now())),b.length>30&&b.shift(),b})},3e3);return()=>clearInterval(m)},[]),a.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none z-0",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900 dark:to-indigo-900"}),a.jsxs("div",{className:"absolute inset-0",children:[a.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-300 dark:bg-blue-700 rounded-full mix-blend-multiply dark:mix-blend-overlay filter blur-xl opacity-20 animate-pulse"}),a.jsx("div",{className:"absolute top-3/4 right-1/4 w-96 h-96 bg-purple-300 dark:bg-purple-700 rounded-full mix-blend-multiply dark:mix-blend-overlay filter blur-xl opacity-20 animate-pulse delay-1000"}),a.jsx("div",{className:"absolute bottom-1/4 left-1/3 w-96 h-96 bg-indigo-300 dark:bg-indigo-700 rounded-full mix-blend-multiply dark:mix-blend-overlay filter blur-xl opacity-20 animate-pulse delay-2000"})]}),i.map(o=>a.jsx("div",{className:"absolute text-blue-600 dark:text-blue-300 font-mono select-none animate-float",style:{left:`${o.x}%`,top:`${o.y}%`,fontSize:`${o.size}px`,opacity:o.opacity,animationDelay:`${o.delay}s`,animationDuration:`${o.duration}s`},children:o.symbol},o.id)),a.jsx("div",{className:"absolute inset-0 opacity-10",children:a.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[a.jsx("defs",{children:a.jsx("pattern",{id:"grid",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:a.jsx("path",{d:"M 10 0 L 0 0 0 10",fill:"none",stroke:"currentColor",strokeWidth:"0.5"})})}),a.jsx("rect",{width:"100",height:"100",fill:"url(#grid)",className:"animate-pulse"})]})})]})},dx=()=>{const{login:i}=Rt(),[f,x]=u.useState(""),[o,d]=u.useState(""),[m,g]=u.useState(null),[b,k]=u.useState(!1),[j,S]=u.useState(!1),p=async y=>{y.preventDefault(),g(null),k(!0);try{const v=await Kg(f,o);i(v)}catch(v){v instanceof Error?g(v.message):g("An unknown error occurred.")}finally{k(!1)}},T=()=>{S(!j)};return a.jsxs("div",{className:"relative flex items-center justify-center min-h-screen p-4 sm:p-6 lg:p-8",children:[a.jsx(cx,{}),a.jsxs("div",{className:"relative z-10 w-full max-w-md p-6 sm:p-8 space-y-6 bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl shadow-2xl border border-white/20 mx-auto",children:[a.jsxs("div",{className:"text-center welcome-text",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 dark:text-white mb-2",children:"Learning Platform"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-300",children:"Please sign in to your account"})]}),a.jsxs("form",{className:"space-y-5 sm:space-y-6",onSubmit:p,children:[a.jsxs("div",{className:"edu-symbol",children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username"}),a.jsx("input",{id:"username",type:"text",value:f,onChange:y=>x(y.target.value),required:!0,className:"w-full px-4 py-3 text-base bg-white/90 dark:bg-gray-700/90 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 backdrop-blur-sm",placeholder:"Enter your username",autoComplete:"username"})]}),a.jsxs("div",{className:"edu-symbol",children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"password",type:j?"text":"password",value:o,onChange:y=>d(y.target.value),required:!0,className:"w-full px-4 py-3 text-base bg-white/90 dark:bg-gray-700/90 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 pr-12 backdrop-blur-sm",placeholder:"Enter your password",autoComplete:"current-password"}),a.jsx("button",{type:"button",onClick:T,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-300 focus:outline-none focus:text-blue-500 transition-all duration-300 p-1 rounded-full hover:bg-blue-50 dark:hover:bg-blue-900/30","aria-label":j?"Hide password":"Show password",children:j?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),m&&a.jsx("div",{className:"error-message p-3 text-sm text-red-600 dark:text-red-400 bg-red-50/80 dark:bg-red-900/30 rounded-lg border border-red-200 dark:border-red-800 backdrop-blur-sm",children:m}),a.jsx("button",{type:"submit",disabled:b,className:"w-full enhanced-button px-4 py-3 sm:py-4 text-base sm:text-lg font-semibold text-white bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-900 rounded-lg transition-all duration-300 disabled:from-blue-400 disabled:to-blue-500 disabled:cursor-not-allowed shadow-lg hover:shadow-xl animated-gradient",children:b?"Signing in...":"Sign In"})]}),a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:" 2025 Learning Platform. All rights reserved."})})]})]})};function Ce(i,f=[],x=!0){const[o,d]=u.useState(null),[m,g]=u.useState(!1),[b,k]=u.useState(null);return u.useEffect(()=>{if(d(null),k(null),!x){g(!1);return}const j=new AbortController;return(async()=>{g(!0);try{const p=await i();j.signal.aborted||d(p)}catch(p){j.signal.aborted||(p instanceof Error?k(p):k(new Error("An unknown error occurred")))}finally{j.signal.aborted||g(!1)}})(),()=>{j.abort()}},[...f,x]),{data:o,isLoading:m,error:b,setData:d}}const Ka=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})}),ux=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})}),ct=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),oa=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),et=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),a.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),a.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),kr=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),a.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),a.jsx("polyline",{points:"7 3 7 8 15 8"})]}),fx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})}),mx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}),hx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),gx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),Pa=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),lc=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),a.jsx("polyline",{points:"9 15 12 12 15 15"})]}),Cr=({className:i})=>a.jsx("svg",{className:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"})}),ia=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Of=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),xx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),bx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),yx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})}),Js=({label:i,value:f,onChange:x,options:o,isLoading:d,disabled:m})=>a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:f||"",onChange:x,disabled:m||d,className:"w-full px-4 py-3 text-base bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed",children:[a.jsx("option",{value:"",disabled:!0,children:d?"Loading...":`Select ${i}`}),o==null?void 0:o.map(g=>a.jsx("option",{value:g._id,children:g.name},g._id))]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:a.jsx("svg",{className:"w-4 h-4 text-gray-400 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),Df=({isOpen:i,onClose:f,classId:x,subjectId:o,unitId:d,subUnitId:m,lessonId:g,onClassChange:b,onSubjectChange:k,onUnitChange:j,onSubUnitChange:S,onLessonChange:p,onSave:T,defaultClass:y})=>{const{data:v,isLoading:z}=Ce(cl,[]),{data:C,isLoading:E}=Ce(()=>dl(x),[x],!!x),{data:U,isLoading:w}=Ce(()=>ul(o),[o],!!o),{data:N,isLoading:D}=Ce(()=>fl(d),[d],!!d),{data:_,isLoading:K}=Ce(()=>ml(m),[m],!!m);u.useEffect(()=>{if(i&&v&&v.length>0&&!x&&y){const M=v.find(B=>B.name.toLowerCase().includes(y.toLowerCase())||B._id===y);M&&b(M._id)}},[i,v,x,y,b]);const X=()=>{T(),f()},L=x||o||d||m||g;return i?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:f}),a.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-gray-900 shadow-xl rounded-2xl border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Select Options"}),a.jsx("button",{onClick:f,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:a.jsx(ia,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx(Js,{label:"Class",value:x,onChange:M=>b(M.target.value||null),options:v,isLoading:z,disabled:!1}),x&&a.jsx(Js,{label:"Subject",value:o,onChange:M=>k(M.target.value||null),options:C,isLoading:E,disabled:!x}),o&&a.jsx(Js,{label:"Unit",value:d,onChange:M=>j(M.target.value||null),options:U,isLoading:w,disabled:!o}),d&&(D||N&&N.length>0)&&a.jsx(Js,{label:"Sub-Unit",value:m,onChange:M=>S(M.target.value||null),options:N,isLoading:D,disabled:!d}),m&&(K||_&&_.length>0)&&a.jsx(Js,{label:"Chapter",value:g,onChange:M=>p(M.target.value||null),options:_,isLoading:K,disabled:!m})]}),a.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[a.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:X,className:"px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!L,children:"Save Selection"})]})]})]})}):null},cc=({classId:i,subjectId:f,unitId:x,subUnitId:o,lessonId:d,onClassChange:m,onSubjectChange:g,onUnitChange:b,onSubUnitChange:k,onLessonChange:j,onModalToggle:S})=>{const{data:p,isLoading:T}=Ce(cl,[]),{data:y,isLoading:v}=Ce(()=>dl(i),[i],!!i),{data:z,isLoading:C}=Ce(()=>ul(f),[f],!!f),{data:E,isLoading:U}=Ce(()=>fl(x),[x],!!x),{data:w,isLoading:N}=Ce(()=>ml(o),[o],!!o),[D,_]=u.useState(!1),K=i||f||x||o||d,X=()=>{if(!i||!p)return null;const V=p.find(O=>O._id===i);return(V==null?void 0:V.name)||null},L=()=>{if(!f||!y)return null;const V=y.find(O=>O._id===f);return(V==null?void 0:V.name)||null},M=()=>{if(d&&w){const V=w.find(O=>O._id===d);return(V==null?void 0:V.name)||null}if(o&&E){const V=E.find(O=>O._id===o);return(V==null?void 0:V.name)||null}if(x&&z){const V=z.find(O=>O._id===x);return(V==null?void 0:V.name)||null}if(f&&y){const V=y.find(O=>O._id===f);return(V==null?void 0:V.name)||null}return null},B=()=>{const V=X(),O=L(),q=M();if(!V&&!O&&!q)return"Choose Class, Subject, Unit, Sub-Unit & Chapter";const J=[];if(V&&J.push(V.length>15?V.substring(0,12)+"...":V),O){const le=J.length===0?20:15;J.push(O.length>le?O.substring(0,le-3)+"...":O)}if(q){const le=J.length===0?25:J.length===1?18:12;J.push(q.length>le?q.substring(0,le-3)+"...":q)}return J.join("  ")};u.useEffect(()=>{!K&&p&&p.length>0&&(_(!0),S==null||S(!0))},[K,p,S]),u.useEffect(()=>{x&&!U&&E&&E.length===0&&d!==x&&j(x)},[x,E,U,d,j]),u.useEffect(()=>{o&&!N&&w&&w.length===0&&d!==o&&(console.log("[CascadeSelectors] SubUnit as lesson - setting lessonId to subUnitId:",{subUnitId:o,previousLessonId:d}),j(o))},[o,w,N,d,j]);const I=()=>{_(!0),S==null||S(!0)},G=()=>{_(!1),S==null||S(!1)},ee=()=>{_(!1),S==null||S(!1)};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block p-4 bg-white dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700 shrink-0",children:a.jsxs("div",{className:"flex flex-wrap gap-3 lg:gap-4 overflow-hidden",children:[a.jsx(Ks,{label:"Class",value:i,onChange:V=>m(V.target.value||null),options:p,isLoading:T,disabled:!1}),i&&a.jsx(Ks,{label:"Subject",value:f,onChange:V=>g(V.target.value||null),options:y,isLoading:v,disabled:!i}),f&&a.jsx(Ks,{label:"Unit",value:x,onChange:V=>b(V.target.value||null),options:z,isLoading:C,disabled:!f}),x&&(U||E&&E.length>0)&&a.jsx(Ks,{label:"Sub-Unit",value:o,onChange:V=>k(V.target.value||null),options:E,isLoading:U,disabled:!x}),o&&(N||w&&w.length>0)&&a.jsx(Ks,{label:"Chapter",value:d,onChange:V=>j(V.target.value||null),options:w,isLoading:N,disabled:!o})]})}),a.jsx("div",{className:"md:hidden shrink-0",children:a.jsxs("button",{onClick:I,className:"w-full flex items-center bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 shadow-sm rounded-md",children:[a.jsx("div",{className:"flex-1 min-w-0 px-3 py-2 text-left",children:a.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 truncate leading-tight",children:B()})}),a.jsx("div",{className:"flex-shrink-0 px-3 py-2",children:a.jsx("div",{className:"p-1.5 rounded-md bg-gray-100 dark:bg-gray-700",children:a.jsx("svg",{className:"h-4 w-4 text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]})}),a.jsx(Df,{isOpen:D,onClose:G,classId:i,subjectId:f,unitId:x,subUnitId:o,lessonId:d,onClassChange:m,onSubjectChange:g,onUnitChange:b,onSubUnitChange:k,onLessonChange:j,onSave:ee,defaultClass:"8"})]})},Ks=({label:i,value:f,onChange:x,options:o,isLoading:d,disabled:m})=>a.jsx("div",{className:"relative flex-1 min-w-[160px] max-w-[200px]",children:a.jsxs("select",{value:f||"",onChange:x,disabled:m||d,className:"w-full px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed truncate",style:{textOverflow:"ellipsis"},children:[a.jsx("option",{value:"",disabled:!0,children:d?"Loading...":`Select ${i}`}),o==null?void 0:o.map(g=>a.jsx("option",{value:g._id,className:"truncate",children:g.name},g._id))]})}),Is=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),a.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]}),jr=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),a.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),ac=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}),a.jsx("polyline",{points:"13 2 13 9 20 9"})]}),sc=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),Rf=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),a.jsx("polyline",{points:"2 17 12 22 22 17"}),a.jsx("polyline",{points:"2 12 12 17 22 12"})]}),px=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),a.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),Sr=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("polygon",{points:"23 7 16 12 23 17 23 7"}),a.jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]}),nc=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),a.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),a.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"})]}),rc=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),wr=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),Ja=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M17 10C17 13.866 12 13 12 13C12 13 7 13.866 7 10C7 6.13401 9.23858 4 12 4C14.7614 4 17 6.13401 17 10Z"}),a.jsx("path",{d:"M12 13V15"}),a.jsx("path",{d:"M10.5 15.5L12 17L13.5 15.5"}),a.jsx("path",{d:"M12 17V20"}),a.jsx("path",{d:"M12 7.5C12 7.5 12.5 8 13 8.5C13.5 9 14 9 14 9"}),a.jsx("path",{d:"M12 7.5V7"})]}),ql=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"12",rx:"2",ry:"2"}),a.jsx("line",{x1:"7",y1:"8",x2:"17",y2:"8"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"}),a.jsx("circle",{cx:"9",cy:"10",r:"1",fill:"currentColor"}),a.jsx("circle",{cx:"13",cy:"10",r:"1",fill:"currentColor"}),a.jsx("path",{d:"M8 18l-2 3h12l-2-3"})]}),dc=[{key:"book",label:"Book",Icon:Is},{key:"slide",label:"Slides",Icon:ql},{key:"flashcard",label:"Flashcard",Icon:jr},{key:"notes",label:"Notes",Icon:ac},{key:"qa",label:"Q&A",Icon:sc},{key:"quiz",label:"Quiz",Icon:Ja},{key:"activity",label:"Bookback Activity",Icon:Rf},{key:"extra",label:"More Activity",Icon:px},{key:"video",label:"Video",Icon:Sr},{key:"audio",label:"Audio",Icon:nc},{key:"worksheet",label:"Worksheet",Icon:rc},{key:"questionPaper",label:"Question Papers",Icon:wr}],vx=({lessonId:i,selectedType:f,onSelectType:x})=>{const{data:o}=Ce(()=>Xg(i),[i],!!i);return a.jsx("div",{className:"flex flex-col gap-1",children:dc.map(d=>{const m=(o==null?void 0:o[d.key])||0,g=f===d.key;return a.jsxs("button",{onClick:()=>x(d.key),className:`w-full flex items-center justify-start text-left py-2 pr-2 rounded-r-md border-l-4 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-900 focus:ring-blue-500 ${g?"border-blue-500 bg-blue-50 dark:bg-blue-900/50 text-blue-700 dark:text-blue-200 font-semibold pl-2":"border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300 pl-3"}`,title:`${d.label} (${m})`,"aria-pressed":g,disabled:!i,children:[a.jsx(d.Icon,{className:"w-5 h-5 mr-3 shrink-0"}),a.jsx("span",{className:"text-sm flex-1",children:d.label}),m>0&&a.jsx("span",{className:"px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-xs font-semibold rounded-full",children:m})]},d.key)})})},_f=({lessonId:i,selectedResourceType:f,onSelectResourceType:x,isOpen:o})=>a.jsx("aside",{className:`flex flex-col bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 ease-in-out ${o?"w-72":"w-0"} overflow-hidden`,children:a.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-200",children:"Resources"}),a.jsx(vx,{lessonId:i,selectedType:f,onSelectType:x})]})}),jx=[{label:"Mobile (360px)",value:"mobile",description:"Optimized for mobile devices"},{label:"Tablet (768px)",value:"tablet",description:"Optimized for tablets"},{label:"Desktop (1024px)",value:"desktop",description:"Optimized for desktop displays"},{label:"Large Desktop (1440px)",value:"large",description:"Optimized for large screens"}],wx=({isOpen:i,onClose:f,onResolutionSelect:x})=>{const[o,d]=u.useState(""),m=()=>{o&&(x(o),f())},g=b=>{d(b)};return i?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:f}),a.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-gray-900 shadow-xl rounded-2xl border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Select Page Resolution"}),a.jsx("button",{onClick:f,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:a.jsx(ia,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"space-y-4",children:jx.map(b=>a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex items-center h-5",children:a.jsx("input",{id:b.value,name:"resolution",type:"radio",value:b.value,checked:o===b.value,onChange:k=>g(k.target.value),className:"focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 dark:bg-gray-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:b.value,className:"block text-sm font-medium text-gray-900 dark:text-white cursor-pointer",children:b.label}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:b.description})]})]},b.value))}),a.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[a.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o,children:"Apply Resolution"})]})]})]})}):null},Nx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),kx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),a.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),a.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),a.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),a.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),a.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),a.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),a.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),Sx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),Bf=({user:i,onToggleSidebar:f,onToggleAdminSidebar:x,onLogout:o,selectedClass:d,onClassSelect:m,onProfile:g})=>{var q;const[b,k]=u.useState(!1),[j,S]=u.useState(()=>typeof window<"u"?localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches:!1),[p,T]=u.useState(!1),[y,v]=u.useState(!1),[z,C]=u.useState(!1),[E,U]=u.useState(d||"8"),[w,N]=u.useState(null),[D,_]=u.useState(null),[K,X]=u.useState(null),[L,M]=u.useState(null),[B,I]=u.useState(null),G=u.useRef(null);u.useEffect(()=>{d&&U(d)},[d]),u.useEffect(()=>{j?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[j]);const ee=()=>{S(!j)},V=()=>{var J;document.fullscreenElement?(J=document.exitFullscreen)==null||J.call(document):document.documentElement.requestFullscreen().catch(console.error)},O=J=>{console.log("Selected resolution:",J)};return u.useEffect(()=>{const J=()=>{k(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",J),()=>document.removeEventListener("fullscreenchange",J)},[]),u.useEffect(()=>{const J=le=>{G.current&&!G.current.contains(le.target)&&T(!1)};return document.addEventListener("mousedown",J),()=>document.removeEventListener("mousedown",J)},[]),a.jsxs("header",{className:"flex items-center justify-between px-2 sm:px-4 h-16 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 z-30 shrink-0",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[a.jsx("button",{onClick:f,className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Toggle resource sidebar",children:a.jsx(Nx,{className:"h-5 w-5 sm:h-6 sm:w-6 text-gray-600 dark:text-gray-300"})}),!b&&a.jsx("div",{className:"flex items-center space-x-3",children:a.jsx("h1",{className:"text-sm sm:text-xl font-bold text-gray-800 dark:text-white truncate max-w-40 sm:max-w-none",children:"Learning Platform"})})]}),a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[a.jsx("button",{onClick:V,className:"hidden md:flex w-8 h-8 sm:w-7 sm:h-7 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-150 items-center justify-center overflow-hidden",title:b?"Exit Full Screen":"Enter Full Screen",children:b?a.jsx(mx,{className:"h-6 w-6 sm:h-5 sm:w-5 text-gray-600 dark:text-gray-300"}):a.jsx(fx,{className:"h-6 w-6 sm:h-5 sm:w-5 text-gray-600 dark:text-gray-300"})}),i.role==="admin"&&x&&a.jsx("button",{onClick:x,className:"w-8 h-8 sm:w-7 sm:h-7 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-150 flex items-center justify-center overflow-hidden",title:"Admin Settings",children:a.jsx(gx,{className:"h-6 w-6 sm:h-6 sm:w-6 text-gray-600 dark:text-gray-300"})}),a.jsxs("div",{className:"relative",ref:G,children:[p&&a.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 z-50 border border-gray-200 dark:border-gray-700 transform origin-top-right",children:[a.jsxs("button",{onClick:()=>{g==null||g(),T(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-3 transition-colors duration-150",children:[a.jsx(Of,{className:"h-4 w-4"}),a.jsx("span",{children:"Profile"})]}),a.jsx("hr",{className:"border-gray-200 dark:border-gray-600 my-1"}),a.jsxs("button",{onClick:()=>{ee(),T(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-3 transition-colors duration-150",children:[j?a.jsx(kx,{className:"h-4 w-4"}):a.jsx(Sx,{className:"h-4 w-4"}),a.jsx("span",{children:"Toggle Dark Mode"})]}),a.jsx("hr",{className:"border-gray-200 dark:border-gray-600 my-1"}),a.jsxs("button",{onClick:()=>{o(),T(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-3 transition-colors duration-150",children:[a.jsx(hx,{className:"h-4 w-4"}),a.jsx("span",{children:"Logout"})]})]}),a.jsx("button",{onClick:()=>T(!p),className:"w-8 h-8 sm:w-7 sm:h-7 bg-blue-500 rounded-full user-avatar text-white font-semibold hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-150 mobile-user-icon flex items-center justify-center overflow-hidden","aria-label":"User menu","aria-expanded":p,"aria-haspopup":"true",children:a.jsx("span",{className:"text-sm sm:text-xs font-medium leading-none select-none",children:(q=i.name)==null?void 0:q[0]})})]})]}),a.jsx(Df,{isOpen:y,onClose:()=>v(!1),classId:w,subjectId:D,unitId:K,subUnitId:L,lessonId:B,onClassChange:N,onSubjectChange:_,onUnitChange:X,onSubUnitChange:M,onLessonChange:I,onSave:()=>{w&&U(d||"8"),m&&m()},defaultClass:"8"}),a.jsx(wx,{isOpen:z,onClose:()=>C(!1),onResolutionSelect:O})]})},Cx=[{id:"browser",label:"Content Browser",roles:["admin","teacher"]},{id:"course-structure",label:"Course Structure Management",roles:["admin"]},{id:"quiz-configuration",label:"Quiz Configuration",roles:["admin","teacher"]},{id:"user-management",label:"User Management",roles:["admin"]},{id:"collections-management",label:"Database Management",roles:["admin"]},{id:"reports",label:"Reports",roles:["admin","teacher"]}],Ex=({isOpen:i,activePage:f,setActivePage:x,userRole:o})=>{const d=Cx.filter(m=>m.roles.includes(o));return a.jsxs("aside",{className:`flex flex-col bg-white dark:bg-gray-900 border-l border-gray-200 dark:border-gray-700 transition-all duration-300 ease-in-out ${i?"w-72":"w-0"} overflow-hidden shrink-0`,children:[a.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:a.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:o==="admin"?"Admin Panel":"Editor Panel"})}),a.jsx("nav",{className:"flex-1 p-4 space-y-2",children:d.map(m=>a.jsx("button",{onClick:()=>x(m.id),className:`w-full text-left px-3 py-2 text-sm font-medium rounded-md transition-colors ${f===m.id?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:m.label},m.id))})]})},jf=i=>i.replace(/-/g," ").replace(/\w\S*/g,f=>f.charAt(0).toUpperCase()+f.substr(1).toLowerCase()),Ax=({title:i})=>a.jsx("div",{className:"p-8 h-full flex items-center justify-center",children:a.jsxs("div",{className:"text-center bg-white dark:bg-gray-800/50 p-10 rounded-lg shadow-md",children:[a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white mb-4",children:jf(i)}),a.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["This is the placeholder page for managing ",jf(i).toLowerCase(),"."]}),a.jsx("p",{className:"mt-2 text-sm text-gray-400 dark:text-gray-500",children:"Functionality for this section will be implemented here."})]})}),Mt=({isOpen:i,onClose:f,onConfirm:x,title:o,message:d})=>{if(!i)return null;const m=()=>{x&&x()};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-sm m-4",onClick:g=>g.stopPropagation(),children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:o}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:d}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:f,className:"px-4 py-2 rounded-md text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500",children:"Cancel"}),a.jsx("button",{onClick:m,className:"px-4 py-2 rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-red-500",children:"Confirm"})]})]})})},Tx=({isOpen:i,onClose:f,onSave:x,itemToEdit:o,level:d})=>{const[m,g]=u.useState(""),[b,k]=u.useState(!1);if(Vt.useEffect(()=>{g(o?o.name:"")},[o,i]),!i)return null;const j=async p=>{p.preventDefault(),m.trim()&&!b&&(k(!0),await x(m.trim()),k(!1))},S={class:"Class",subject:"Subject",unit:"Unit",subUnit:"Sub-Unit",lesson:"Chapter"}[d||"class"];return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:p=>p.stopPropagation(),children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:o?`Edit ${S}`:`Add New ${S}`}),a.jsxs("form",{onSubmit:j,children:[a.jsx("input",{type:"text",value:m,onChange:p=>g(p.target.value),placeholder:`${S} Name`,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",autoFocus:!0}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 rounded-md text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 disabled:opacity-50",disabled:b,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-wait",disabled:b,children:b?"Saving...":o?"Save Changes":`Create ${S}`})]})]})]})})},$s=({title:i,items:f,isLoading:x,selectedId:o,onSelect:d,onAdd:m,onEdit:g,onDelete:b,addDisabled:k=!1})=>a.jsxs("div",{className:"bg-white dark:bg-gray-800/50 shadow-md rounded-lg flex flex-col h-[calc(100vh-14rem)] min-h-[300px]",children:[a.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center shrink-0",children:[a.jsx("h2",{className:"font-semibold text-gray-700 dark:text-gray-200 text-sm",children:i}),a.jsxs("button",{onClick:m,disabled:k,className:"flex items-center gap-1 px-2 py-1 rounded text-xs font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 disabled:text-gray-400 dark:disabled:text-gray-500 disabled:cursor-not-allowed disabled:hover:bg-transparent",title:`Add New ${i.slice(0,-1)}`,children:[a.jsx(ct,{className:"w-3 h-3"}),a.jsx("span",{children:"Add"})]})]}),a.jsxs("div",{className:"overflow-y-auto flex-1",children:[x&&a.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"Loading..."}),!x&&(f==null?void 0:f.length)===0&&a.jsx("div",{className:"p-4 text-center text-xs text-gray-500",children:"No items found."}),f==null?void 0:f.map(j=>a.jsxs("div",{onClick:()=>d(j._id),className:`group flex justify-between items-center p-2.5 text-sm cursor-pointer border-l-4 ${o===j._id?"border-blue-500 bg-blue-50 dark:bg-blue-900/50":"border-transparent hover:bg-gray-50 dark:hover:bg-gray-700/50"}`,children:[a.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200 truncate pr-2",children:j.name}),a.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity space-x-1 shrink-0",children:[a.jsx("button",{onClick:S=>{S.stopPropagation(),g(j)},className:"p-1 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:a.jsx(oa,{className:"w-4 h-4"})}),a.jsx("button",{onClick:S=>{S.stopPropagation(),b(j._id)},className:"p-1 text-gray-500 hover:text-red-600 dark:hover:text-red-400",children:a.jsx(et,{className:"w-4 h-4"})})]})]},j._id))]})]}),zx=()=>{const[i,f]=u.useState(null),[x,o]=u.useState(null),[d,m]=u.useState(null),[g,b]=u.useState(null),[k,j]=u.useState(null),[S,p]=u.useState({isOpen:!1,level:null,itemToEdit:null}),[T,y]=u.useState({isOpen:!1,onConfirm:null}),[v,z]=u.useState(0),[C,E]=u.useState(0),[U,w]=u.useState(0),[N,D]=u.useState(0),[_,K]=u.useState(0),{data:X,isLoading:L}=Ce(cl,[v]),{data:M,isLoading:B}=Ce(()=>dl(i),[i,C],!!i),{data:I,isLoading:G}=Ce(()=>ul(x),[x,U],!!x),{data:ee,isLoading:V}=Ce(()=>fl(d),[d,N],!!d),{data:O,isLoading:q}=Ce(()=>ml(g),[g,_],!!g),J=(ae,pe=null)=>p({isOpen:!0,level:ae,itemToEdit:pe}),le=()=>p({isOpen:!1,level:null,itemToEdit:null}),te=ae=>{y({isOpen:!0,onConfirm:ae})},ne=()=>{y({isOpen:!1,onConfirm:null})},se=u.useCallback((ae,pe)=>{switch(ae){case"class":f(pe),o(null),m(null),b(null),j(null);break;case"subject":o(pe),m(null),b(null),j(null);break;case"unit":m(pe),b(null),j(null);break;case"subUnit":b(pe),j(null);break;case"lesson":j(pe);break}},[]),re=(ae,pe)=>{te(async()=>{switch(ae){case"class":await Lg(pe),z(Le=>Le+1),i===pe&&se("class",null);break;case"subject":await Rg(pe),E(Le=>Le+1),x===pe&&se("subject",null);break;case"unit":await Hg(pe),w(Le=>Le+1),d===pe&&se("unit",null);break;case"subUnit":await Qg(pe),D(Le=>Le+1),g===pe&&se("subUnit",null);break;case"lesson":await Yg(pe),K(Le=>Le+1),k===pe&&se("lesson",null);break}ne()})},ve=async ae=>{const{level:pe,itemToEdit:Pe}=S;switch(pe){case"class":Pe?await Mg(Pe._id,ae):await Ug(ae),z(Le=>Le+1);break;case"subject":Pe?await Dg(Pe._id,ae):i&&await Og(ae,i),E(Le=>Le+1);break;case"unit":Pe?await Bg(Pe._id,ae):x&&await _g(ae,x),w(Le=>Le+1);break;case"subUnit":Pe?await Vg(Pe._id,ae):d&&await qg(ae,d),D(Le=>Le+1);break;case"lesson":Pe?await Gg(Pe._id,ae):g&&await Fg(ae,g),K(Le=>Le+1);break}le()};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full flex flex-col",children:[a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white mb-4",children:"Course Structure Management"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 flex-1",children:[a.jsx($s,{title:"Classes",items:X,isLoading:L,selectedId:i,onSelect:ae=>se("class",ae),onAdd:()=>J("class"),onEdit:ae=>J("class",ae),onDelete:ae=>re("class",ae)}),a.jsx($s,{title:"Subjects",items:M,isLoading:B,selectedId:x,onSelect:ae=>se("subject",ae),onAdd:()=>J("subject"),onEdit:ae=>J("subject",ae),onDelete:ae=>re("subject",ae),addDisabled:!i}),a.jsx($s,{title:"Units",items:I,isLoading:G,selectedId:d,onSelect:ae=>se("unit",ae),onAdd:()=>J("unit"),onEdit:ae=>J("unit",ae),onDelete:ae=>re("unit",ae),addDisabled:!x}),a.jsx($s,{title:"Sub-Units",items:ee,isLoading:V,selectedId:g,onSelect:ae=>se("subUnit",ae),onAdd:()=>J("subUnit"),onEdit:ae=>J("subUnit",ae),onDelete:ae=>re("subUnit",ae),addDisabled:!d}),a.jsx($s,{title:"Chapters",items:O,isLoading:q,selectedId:k,onSelect:ae=>se("lesson",ae),onAdd:()=>J("lesson"),onEdit:ae=>J("lesson",ae),onDelete:ae=>re("lesson",ae),addDisabled:!g})]}),a.jsx(Tx,{isOpen:S.isOpen,onClose:le,onSave:ve,itemToEdit:S.itemToEdit,level:S.level}),a.jsx(Mt,{isOpen:T.isOpen,onClose:ne,onConfirm:T.onConfirm,title:"Confirm Deletion",message:"Are you sure you want to delete this item and all its contents? This action cannot be undone."})]})},Ux=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})}),Mx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),a.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),Lx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Ox=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),a.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),Hf=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),qf=u.createContext(void 0),Dx=({children:i})=>{const[f,x]=u.useState([]),o=u.useCallback((m,g="info")=>{const b=Math.random().toString(36).substr(2,9);x(k=>[...k,{id:b,message:m,type:g}]),setTimeout(()=>{d(b)},3e3)},[]),d=u.useCallback(m=>{x(g=>g.filter(b=>b.id!==m))},[]);return a.jsxs(qf.Provider,{value:{showToast:o},children:[i,a.jsx("div",{className:"fixed top-4 right-4 z-[9999] flex flex-col gap-3 pointer-events-none",children:f.map(m=>a.jsx(Rx,{toast:m,onClose:()=>d(m.id)},m.id))})]})},Rx=({toast:i,onClose:f})=>{const x={success:a.jsx(Ux,{className:"w-5 h-5 text-green-500"}),error:a.jsx(Mx,{className:"w-5 h-5 text-red-500"}),warning:a.jsx(Ox,{className:"w-5 h-5 text-yellow-500"}),info:a.jsx(Lx,{className:"w-5 h-5 text-blue-500"})},o={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200"};return a.jsxs("div",{className:`pointer-events-auto flex items-center w-full max-w-xs p-4 rounded-lg shadow-lg border ${o[i.type]} transform transition-all duration-300 ease-in-out animate-slide-in`,children:[a.jsx("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8 rounded-lg bg-white",children:x[i.type]}),a.jsx("div",{className:"ml-3 text-sm font-normal text-gray-800",children:i.message}),a.jsx("button",{onClick:f,className:"ml-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex h-8 w-8","aria-label":"Close",children:a.jsx(Hf,{className:"w-3 h-3"})})]})},Xe=()=>{const i=u.useContext(qf);if(!i)throw new Error("useToast must be used within a ToastProvider");return i},_x=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),Bx=({isOpen:i,onClose:f,onSave:x,userToEdit:o})=>{const[d,m]=u.useState(""),[g,b]=u.useState(""),[k,j]=u.useState(""),[S,p]=u.useState(""),[T,y]=u.useState("teacher"),[v,z]=u.useState("active"),[C,E]=u.useState(!1),[U,w]=u.useState(!1);if(u.useEffect(()=>{o?(m(o.name),b(o.email),y(o.role),z(o.status),j(o.username),E(!!o.canEdit),p("")):(m(""),b(""),j(""),p(""),y("teacher"),z("active"),E(!1))},[o,i]),!i)return null;const N=async _=>{if(_.preventDefault(),d.trim()&&g.trim()&&k.trim()&&!U){if(!o&&!S.trim())return;w(!0);const K={name:d.trim(),email:g.trim(),username:k.trim(),role:T,status:v};S.trim()&&(K.password=S.trim()),T==="teacher"?K.canEdit=C:T==="admin"?K.canEdit=!0:K.canEdit=!1,await x(K,o==null?void 0:o._id),w(!1)}},D="mt-1 w-full px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:_=>_.stopPropagation(),children:[a.jsx("h2",{className:"text-xl font-bold mb-6 text-gray-800 dark:text-white",children:o?"Edit User":"Add New User"}),a.jsxs("form",{onSubmit:N,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Name"}),a.jsx("input",{type:"text",value:d,onChange:_=>m(_.target.value),required:!0,className:D,autoFocus:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Username"}),a.jsx("input",{type:"text",value:k,onChange:_=>j(_.target.value),required:!0,className:D})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email"}),a.jsx("input",{type:"email",value:g,onChange:_=>b(_.target.value),required:!0,className:D})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),a.jsx("input",{type:"password",value:S,onChange:_=>p(_.target.value),required:!o,placeholder:o?"Leave blank to keep unchanged":"",className:D})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Role"}),a.jsxs("select",{value:T,onChange:_=>y(_.target.value),className:D,children:[a.jsx("option",{value:"teacher",children:"Teacher"}),a.jsx("option",{value:"student",children:"Student"}),a.jsx("option",{value:"admin",children:"Admin"})]})]}),T==="teacher"&&a.jsxs("div",{className:"flex items-center mt-2",children:[a.jsx("input",{id:"canEdit",type:"checkbox",checked:C,onChange:_=>E(_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"canEdit",className:"ml-2 block text-sm text-gray-900 dark:text-gray-300",children:"Can Edit Content?"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Status"}),a.jsxs("select",{value:v,onChange:_=>z(_.target.value),className:D,children:[a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})]}),a.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 rounded-md text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 disabled:opacity-50",disabled:U,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-wait",disabled:!d||!g||!k||U,children:U?"Saving...":o?"Save Changes":"Create User"})]})]})]})})},Hx=()=>{const[i,f]=u.useState(0),{data:x,isLoading:o,error:d}=Ce($g,[i]),[m,g]=u.useState({isOpen:!1,userToEdit:null}),[b,k]=u.useState({isOpen:!1,onConfirm:null}),[j,S]=u.useState(""),{showToast:p}=Xe(),T=(w=null)=>g({isOpen:!0,userToEdit:w}),y=()=>g({isOpen:!1,userToEdit:null}),v=w=>{k({isOpen:!0,onConfirm:w})},z=()=>{k({isOpen:!1,onConfirm:null})},C=async(w,N)=>{try{N?await Pg(N,w):await Wg(w),f(D=>D+1),p("User saved successfully","success")}catch{p("Failed to save user","error")}y()},E=async w=>{v(async()=>{try{(await Ig(w._id)).success?(f(_=>_+1),p("User deleted successfully","success")):p("Failed to delete user","error")}catch{p("Error deleting user","error")}z()})},U=u.useMemo(()=>{if(!x)return[];if(!j)return x;const w=j.toLowerCase();return x.filter(N=>N.name.toLowerCase().includes(w)||N.username.toLowerCase().includes(w)||N.email.toLowerCase().includes(w))},[x,j]);return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"User Management"}),a.jsxs("button",{onClick:()=>T(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800 transition-colors",title:"Add User",children:[a.jsx(ct,{className:"w-5 h-5"}),a.jsx("span",{children:"Add New"})]})]}),a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search users by name, username, or email...",value:j,onChange:w=>S(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(_x,{className:"w-5 h-5 text-gray-400"})})]})}),a.jsx("div",{className:"flex-1 overflow-x-auto bg-white dark:bg-gray-800/50 shadow-md rounded-lg",children:a.jsxs("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[a.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3",children:"Name"}),a.jsx("th",{scope:"col",className:"px-6 py-3",children:"Username"}),a.jsx("th",{scope:"col",className:"px-6 py-3",children:"Email"}),a.jsx("th",{scope:"col",className:"px-6 py-3",children:"Role"}),a.jsx("th",{scope:"col",className:"px-6 py-3",children:"Permissions"}),a.jsx("th",{scope:"col",className:"px-6 py-3",children:"Status"}),a.jsx("th",{scope:"col",className:"px-6 py-3",children:a.jsx("span",{className:"sr-only",children:"Actions"})})]})}),a.jsxs("tbody",{children:[o&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center p-4",children:"Loading users..."})}),d&&a.jsx("tr",{children:a.jsxs("td",{colSpan:7,className:"text-center p-4 text-red-500",children:["Error: ",d.message]})}),!o&&!d&&U.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center p-6",children:j?"No users match your search.":"No users found."})}),U.map(w=>a.jsxs("tr",{className:"bg-white dark:bg-gray-800 border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[a.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:w.name}),a.jsx("td",{className:"px-6 py-4",children:w.username}),a.jsx("td",{className:"px-6 py-4",children:w.email}),a.jsx("td",{className:"px-6 py-4 capitalize",children:w.role}),a.jsx("td",{className:"px-6 py-4",children:w.role==="teacher"&&w.canEdit&&a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:"Editor"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}`,children:w.status})}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx("button",{onClick:()=>T(w),className:"p-1.5 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",title:"Edit User",children:a.jsx(oa,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>E(w),className:"p-1.5 text-gray-500 hover:text-red-600 dark:hover:text-red-400",title:"Delete User",children:a.jsx(et,{className:"w-4 h-4"})})]})})]},w._id))]})]})}),a.jsx(Bx,{isOpen:m.isOpen,onClose:y,onSave:C,userToEdit:m.userToEdit}),a.jsx(Mt,{isOpen:b.isOpen,onClose:z,onConfirm:b.onConfirm,title:"Confirm User Deletion",message:"Are you sure you want to delete this user? This action cannot be undone."})]})},qx=({isOpen:i,onClose:f,onImport:x})=>{const[o,d]=u.useState(""),[m,g]=u.useState(null);u.useEffect(()=>{i&&(d(""),g(null))},[i]);const b=T=>{console.log("[autoFixJson] Attempting to auto-fix JSON syntax errors...");let y=T,v=0;try{const z=y.split(`
`);for(let N=0;N<z.length;N++){const D=z[N];if(D.includes('"')&&!D.match(/^.*".*".*$/)){const _=D.trim();_.startsWith('"')&&!_.endsWith('"')&&(z[N]=_+'"',v++,console.log("[autoFixJson] Fixed unclosed quote on line",N+1))}}y=z.join(`
`),y=y.replace(/"answerOption"/g,'"answerOptions"'),v++,y=y.replace(/,\s*}/g,"}"),y=y.replace(/,\s*]/g,"]"),v+=2;const C=(y.match(/{/g)||[]).length,E=(y.match(/}/g)||[]).length,U=(y.match(/\[/g)||[]).length,w=(y.match(/\]/g)||[]).length;for(let N=E;N<C;N++)y+="}",v++;for(let N=w;N<U;N++)y+="]",v++;return console.log("[autoFixJson] Applied",v,"automatic fixes"),JSON.parse(y),console.log("[autoFixJson] Auto-fix successful!"),y}catch(z){return console.log("[autoFixJson] Auto-fix failed, original error:",z.message),T}},k=T=>{const y=T.trim();if(!y.startsWith("["))return"JSON must start with '['";if(!y.endsWith("]"))return"JSON must end with ']'";const v=[],z=y.split(`
`);for(let C=0;C<z.length;C++){const E=z[C].trim();E.includes("&quot;")&&v.push(`Line ${C+1}: Still contains &quot; entities`),E.includes("&#39;")&&v.push(`Line ${C+1}: Still contains &#39; entities`);const U=(E.match(/"/g)||[]).length;(E.match(/'/g)||[]).length,U%2!==0&&v.push(`Line ${C+1}: Unclosed double quote`)}return v.length>0?v.join("; "):null},j=T=>{console.log("[sanitizeAndParse] Raw input (first 200 chars):",T.substring(0,200));const y=k(T);y&&console.log("[sanitizeAndParse] Entity check result:",y);let v=T.trim().replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#38;/g,"&").replace(/&#60;/g,"<").replace(/&#62;/g,">").replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'");console.log("[sanitizeAndParse] Cleaned input (first 200 chars):",v.substring(0,200)),console.log("[sanitizeAndParse] Cleaned input length:",v.length);try{const z=k(v);if(z)throw new Error(`JSON structure issues: ${z}`);const C=JSON.parse(v);if(!Array.isArray(C))throw new Error("JSON must be an array of questions.");return console.log("[sanitizeAndParse] Successfully parsed:",C.length,"questions"),C}catch(z){console.error("[sanitizeAndParse] First parsing attempt failed:",z.message),console.error("[sanitizeAndParse] Attempting automatic JSON fixing...");try{const E=b(v);if(E!==v){console.log("[sanitizeAndParse] Auto-fix applied, trying to parse fixed JSON...");const U=JSON.parse(E);if(!Array.isArray(U))throw new Error("JSON must be an array of questions.");return console.log("[sanitizeAndParse] Successfully parsed after auto-fix:",U.length,"questions"),U}}catch(E){console.error("[sanitizeAndParse] Auto-fix failed:",E.message)}console.error("[sanitizeAndParse] Raw input length:",T.length),console.error("[sanitizeAndParse] First 100 chars:",T.substring(0,100)),console.error("[sanitizeAndParse] Last 100 chars:",T.substring(Math.max(0,T.length-100)));const C=z.message.match(/position (\d+)/);if(C){const E=parseInt(C[1]),U=Math.max(0,E-50),w=Math.min(v.length,E+50);console.error("[sanitizeAndParse] Error context around position",E+":",v.substring(U,w));const N=v[E],D=v[E-1],_=v[E+1];console.error("[sanitizeAndParse] Error analysis:"),console.error("[sanitizeAndParse]  - Error character:",JSON.stringify(N)),console.error("[sanitizeAndParse]  - Character before:",JSON.stringify(D)),console.error("[sanitizeAndParse]  - Character after:",JSON.stringify(_))}return null}},S=()=>{console.log("[Quiz Import] Current input:",o);const T=j(o);T?(d(JSON.stringify(T,null,2)),g(null),console.log("[Quiz Import] Successfully parsed and formatted")):(g("Invalid JSON format. Please check your input."),console.log("[Quiz Import] Failed to parse JSON"))},p=()=>{const T=j(o);T?(x(T),f()):g("Invalid JSON. Cannot import.")};return i?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-3xl flex flex-col max-h-[90vh]",children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:"Import Quiz JSON"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:`Paste your JSON below. HTML entities are automatically replaced as you type (&quot;  ", &#39;  ', &amp;  &, etc.).`}),a.jsx("textarea",{value:o,onChange:T=>{const y=T.target.value.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#38;/g,"&").replace(/&#60;/g,"<").replace(/&#62;/g,">").replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'");d(y),g(null)},onPaste:T=>{T.preventDefault();const v=T.clipboardData.getData("text").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#38;/g,"&").replace(/&#60;/g,"<").replace(/&#62;/g,">").replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'"),z=T.target,C=z.selectionStart,E=z.selectionEnd,U=o.substring(0,C)+v+o.substring(E);d(U),g(null),setTimeout(()=>{const w=C+v.length;z.setSelectionRange(w,w)},0)},className:"flex-1 w-full p-3 border rounded-md font-mono text-xs bg-gray-50 dark:bg-gray-700 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 outline-none resize-none",placeholder:`[
  {
    "question": "Your Question?",
    "answerOptions": [...]
  }
]`,rows:15}),m&&a.jsx("p",{className:"text-red-500 text-sm mt-2",children:m}),a.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[a.jsx("button",{onClick:S,className:"px-4 py-2 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 rounded-md hover:bg-yellow-200 dark:hover:bg-yellow-800",children:"Format & Preview"}),a.jsx("button",{onClick:f,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),a.jsx("button",{onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Import"})]})]})}):null},Vx=()=>{const[i,f]=u.useState(null),[x,o]=u.useState(null),[d,m]=u.useState(null),[g,b]=u.useState(null),[k,j]=u.useState(null),[S,p]=u.useState([]),[T,y]=u.useState(null),[v,z]=u.useState("Lesson Quiz"),[C,E]=u.useState([]),[U,w]=u.useState(!1),[N,D]=u.useState(!1),[_,K]=u.useState(!1),[X,L]=u.useState(!1),{showToast:M}=Xe();u.useEffect(()=>{o(null),m(null),b(null),j(null)},[i]),u.useEffect(()=>{m(null),b(null),j(null)},[x]),u.useEffect(()=>{b(null),j(null)},[d]),u.useEffect(()=>{j(null)},[g]),u.useEffect(()=>{if(!k){p([]),E([]),y(null),z("Lesson Quiz");return}(async()=>{var ne;K(!0);try{const se=await tt(k,["quiz"]),re=((ne=se==null?void 0:se[0])==null?void 0:ne.docs)||[];p(re),re.length>0?B(re[0]):I()}catch(se){console.error("Error loading quizzes",se),M("Failed to load quizzes","error")}finally{K(!1)}})()},[k]);const B=te=>{y(te._id),z(te.title);try{const ne=te.body.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#38;/g,"&").replace(/&#60;/g,"<").replace(/&#62;/g,">").replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'");E(JSON.parse(ne))}catch(ne){console.error("Failed to parse quiz",ne),E([])}w(!1)},I=()=>{y(null),z("New Quiz"),E([]),w(!1)},G=()=>{const te={question:"",answerOptions:[{text:"",isCorrect:!1,rationale:""},{text:"",isCorrect:!1,rationale:""}],hint:""};E([...C,te]),w(!0)},ee=te=>{const ne=[...C];ne.splice(te,1),E(ne),w(!0),M("Question removed","error")},V=(te,ne,se)=>{const re=[...C];re[te]={...re[te],[ne]:se},E(re),w(!0)},O=te=>{const ne=[...C];ne[te].answerOptions.push({text:"",isCorrect:!1,rationale:""}),E(ne),w(!0)},q=(te,ne)=>{const se=[...C];se[te].answerOptions.splice(ne,1),E(se),w(!0)},J=(te,ne,se,re)=>{const ve=[...C],ae=ve[te].answerOptions[ne];ve[te].answerOptions[ne]={...ae,[se]:re},E(ve),w(!0)},le=async()=>{if(k){D(!0);try{const te=JSON.stringify(C);let ne;T?(ne=await $a(T,{title:v,body:te}),p(se=>se.map(re=>re._id===T?ne:re))):(ne=await Ut({lessonId:k,type:"quiz",title:v,body:te}),p(se=>[...se,ne]),y(ne._id)),w(!1),M("Quiz saved successfully!","success")}catch(te){M("Failed to save quiz.","error"),console.error(te)}finally{D(!1)}}};return a.jsxs("div",{className:"flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[a.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm sticky top-0 z-10",children:a.jsxs("div",{className:"p-4",children:[a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white mb-4",children:"Quiz Configuration"}),a.jsx(cc,{classId:i,subjectId:x,unitId:d,subUnitId:g,lessonId:k,onClassChange:f,onSubjectChange:o,onUnitChange:m,onSubUnitChange:b,onLessonChange:j})]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex",children:k?_?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("div",{className:"text-center",children:"Loading..."})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[a.jsx("h2",{className:"font-semibold text-gray-700 dark:text-gray-200",children:"Quizzes"}),a.jsx("button",{onClick:I,className:"p-1 text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700 rounded",title:"Create New Quiz",children:a.jsx(ct,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[S.map(te=>a.jsx("button",{onClick:()=>B(te),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors ${T===te._id?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:te.title},te._id)),S.length===0&&a.jsx("div",{className:"text-center py-4 text-xs text-gray-400",children:"No quizzes found."})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"flex flex-col gap-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1 mr-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-1",children:"Quiz Title"}),a.jsx("input",{type:"text",value:v,onChange:te=>{z(te.target.value),w(!0)},className:"w-full p-2 border dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-white font-semibold focus:ring-2 focus:ring-blue-500 outline-none"})]}),a.jsxs("div",{className:"flex gap-3 items-end",children:[a.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md text-sm transition-colors h-10",children:[a.jsx(lc,{className:"w-4 h-4"}),a.jsx("span",{children:"Import JSON"})]}),a.jsxs("button",{onClick:le,disabled:!U||N,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white rounded-md text-sm font-semibold transition-colors h-10",children:[a.jsx(kr,{className:"w-4 h-4"}),a.jsx("span",{children:N?"Saving...":U?"Save Changes":"Saved"})]})]})]}),a.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[C.length," Questions"]})]}),C.map((te,ne)=>a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-200",children:["Question ",ne+1]}),a.jsx("button",{onClick:()=>ee(ne),className:"text-red-500 hover:text-red-700 p-1",title:"Delete Question",children:a.jsx(et,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-1",children:"Question Text (HTML Supported)"}),a.jsx("textarea",{value:te.question,onChange:se=>V(ne,"question",se.target.value),className:"w-full p-3 border dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 outline-none min-h-[80px]",placeholder:"Enter question here..."})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-1",children:"Hint (Optional)"}),a.jsx("input",{type:"text",value:te.hint,onChange:se=>V(ne,"hint",se.target.value),className:"w-full p-2 border dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 outline-none text-sm",placeholder:"Enter a hint..."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase",children:"Answer Options"}),te.answerOptions.map((se,re)=>a.jsxs("div",{className:"flex gap-3 items-start bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md",children:[a.jsx("div",{className:"pt-2",children:a.jsx("input",{type:"checkbox",checked:se.isCorrect,onChange:ve=>J(ne,re,"isCorrect",ve.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 cursor-pointer",title:"Mark as Correct Answer"})}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("input",{type:"text",value:se.text,onChange:ve=>J(ne,re,"text",ve.target.value),className:"w-full p-2 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm text-gray-800 dark:text-gray-100 focus:ring-1 focus:ring-blue-500 outline-none",placeholder:"Option Text (HTML Supported)"}),a.jsx("input",{type:"text",value:se.rationale,onChange:ve=>J(ne,re,"rationale",ve.target.value),className:"w-full p-2 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-xs text-gray-600 dark:text-gray-400 italic focus:ring-1 focus:ring-blue-500 outline-none",placeholder:"Rationale / Explanation (Optional)"})]}),a.jsx("button",{onClick:()=>q(ne,re),className:"text-gray-400 hover:text-red-500 p-1",children:a.jsx(et,{className:"w-4 h-4"})})]},re)),a.jsxs("button",{onClick:()=>O(ne),className:"text-sm text-blue-600 hover:text-blue-500 font-medium flex items-center gap-1 mt-2",children:[a.jsx(ct,{className:"w-3 h-3"})," Add Option"]})]})]},ne)),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pb-10",children:[a.jsxs("button",{onClick:G,className:"w-full py-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-500 dark:text-gray-400 hover:border-blue-500 hover:text-blue-500 transition-colors flex flex-col items-center justify-center gap-2",children:[a.jsx(ct,{className:"w-8 h-8"}),a.jsx("span",{className:"font-medium",children:"Add New Question"})]}),a.jsxs("button",{onClick:le,disabled:!U||N,className:"w-full py-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex flex-col items-center justify-center gap-2 shadow-md",children:[a.jsx(kr,{className:"w-8 h-8"}),a.jsx("span",{className:"font-medium",children:N?"Saving...":U?"Save Changes":"Saved"})]})]})]})})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400",children:a.jsx("p",{children:"Please select a lesson (leaf node) to configure its quiz."})})}),a.jsx(qx,{isOpen:X,onClose:()=>L(!1),onImport:te=>{E(ne=>[...ne,...te]),w(!0)}})]})},Io=({title:i,value:f,Icon:x,color:o})=>a.jsxs("div",{className:"bg-white dark:bg-gray-800/50 p-6 rounded-lg shadow-md flex items-center",children:[a.jsx("div",{className:`p-3 rounded-full mr-4 ${o}`,children:a.jsx(x,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i}),a.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:f})]})]}),Qx=()=>{const{data:i,isLoading:f,error:x}=Ce(ax);return f?a.jsx("div",{className:"p-8 text-center",children:"Loading reports..."}):x?a.jsxs("div",{className:"p-8 text-center text-red-500",children:["Error loading reports: ",x.message]}):i?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full",children:[a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white mb-6",children:"Platform Reports"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[a.jsx(Io,{title:"Total Users",value:i.userCount,Icon:Of,color:"bg-blue-500"}),a.jsx(Io,{title:"Total Chapters",value:i.lessonCount,Icon:xx,color:"bg-green-500"}),a.jsx(Io,{title:"Total Content Items",value:i.contentCount,Icon:Rf,color:"bg-purple-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800/50 p-6 rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800 dark:text-white",children:"Course Structure"}),a.jsxs("ul",{className:"space-y-3",children:[a.jsxs("li",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Classes"}),a.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:i.classCount})]}),a.jsxs("li",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Subjects"}),a.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:i.subjectCount})]}),a.jsxs("li",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Units"}),a.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:i.unitCount})]}),a.jsxs("li",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Sub-Units"}),a.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:i.subUnitCount})]}),a.jsxs("li",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Chapters"}),a.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:i.lessonCount})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800/50 p-6 rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800 dark:text-white",children:"User Roles"}),a.jsxs("ul",{className:"space-y-3",children:[a.jsxs("li",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Administrators"}),a.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:i.adminCount})]}),a.jsxs("li",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Teachers"}),a.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:i.teacherCount})]}),a.jsxs("li",{className:"flex justify-between items-center text-sm border-t dark:border-gray-700 pt-3 mt-3",children:[a.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-200",children:"Total Users"}),a.jsx("span",{className:"font-bold text-lg text-gray-900 dark:text-white",children:i.userCount})]})]})]})]}),a.jsxs("div",{className:"mt-8 bg-white dark:bg-gray-800/50 p-6 rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800 dark:text-white",children:"Content by Type"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:dc.map(({key:o,label:d,Icon:m})=>a.jsxs("div",{className:"flex items-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:[a.jsx(m,{className:"w-5 h-5 mr-3 text-blue-500"}),a.jsx("span",{className:"text-sm flex-1 text-gray-600 dark:text-gray-300",children:d}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-white",children:i.contentByType[o]||0})]},o))})]})]}):a.jsx("div",{className:"p-8 text-center",children:"No statistics available."})},Vf=({user:i,onBack:f})=>{var E;const[x,o]=u.useState(!1),[d,m]=u.useState(!1),[g,b]=u.useState(!1),{showToast:k}=Xe(),[j,S]=u.useState({name:i.name||"",email:i.email||"",role:i.role,mobileNumber:i.mobileNumber||""}),[p,T]=u.useState({currentPassword:"",newPassword:"",confirmPassword:""}),y=U=>{S({...j,[U.target.name]:U.target.value})},v=U=>{T({...p,[U.target.name]:U.target.value})},z=async()=>{b(!0);try{await tx(i._id,{name:j.name,email:j.email,mobileNumber:j.mobileNumber}),k("Profile updated successfully!","success"),o(!1)}catch(U){console.error("Error updating profile:",U),k("Failed to update profile. Please try again.","error")}finally{b(!1)}},C=async U=>{if(U.preventDefault(),p.newPassword!==p.confirmPassword){k("New passwords do not match","error");return}b(!0);try{await lx(i._id,{currentPassword:p.currentPassword,newPassword:p.newPassword,confirmPassword:p.confirmPassword}),k("Password changed successfully!","success"),m(!1),T({currentPassword:"",newPassword:"",confirmPassword:""})}catch(w){console.error("Error changing password:",w),k(w.message||"Failed to change password. Please try again.","error")}finally{b(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white dark:bg-gray-900 rounded-lg shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Profile Settings"}),a.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors duration-200",children:" Back"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Profile Information"}),!x&&a.jsx("button",{onClick:()=>o(!0),className:"px-3 py-1 text-sm font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition-colors duration-200",children:"Edit"})]}),x?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),a.jsx("input",{type:"text",name:"name",value:j.name,onChange:y,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),a.jsx("input",{type:"email",name:"email",value:j.email,onChange:y,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mobile Number"}),a.jsx("input",{type:"tel",name:"mobileNumber",value:j.mobileNumber,onChange:y,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter mobile number"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Role"}),a.jsx("input",{type:"text",name:"role",value:j.role,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:z,disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Saving...":"Save Changes"}),a.jsx("button",{onClick:()=>o(!1),disabled:g,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50",children:"Cancel"})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-xl uppercase",children:(E=i.name)==null?void 0:E[0]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:i.name}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:i.role})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),a.jsx("p",{className:"text-gray-900 dark:text-white",children:i.email||"Not provided"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mobile Number"}),a.jsx("p",{className:"text-gray-900 dark:text-white",children:i.mobileNumber||"Not provided"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"User ID"}),a.jsx("p",{className:"text-gray-900 dark:text-white font-mono text-sm",children:i._id})]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Security"}),!d&&a.jsx("button",{onClick:()=>m(!0),className:"px-3 py-1 text-sm font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition-colors duration-200",children:"Change Password"})]}),d?a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current Password"}),a.jsx("input",{type:"password",name:"currentPassword",value:p.currentPassword,onChange:v,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"New Password"}),a.jsx("input",{type:"password",name:"newPassword",value:p.newPassword,onChange:v,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm New Password"}),a.jsx("input",{type:"password",name:"confirmPassword",value:p.confirmPassword,onChange:v,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{type:"submit",disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Updating...":"Update Password"}),a.jsx("button",{type:"button",onClick:()=>{m(!1),T({currentPassword:"",newPassword:"",confirmPassword:""})},disabled:g,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50",children:"Cancel"})]})]}):a.jsx("div",{children:a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Change your password to keep your account secure."})})]})]})]})},Fx=()=>{var I;const{session:i,logout:f}=Rt(),[x,o]=u.useState(!1),[d,m]=u.useState([]),[g,b]=u.useState(!1),[k,j]=u.useState(!1),[S,p]=u.useState(null),[T,y]=u.useState(null),[v,z]=u.useState({username:"",password:""}),[C,E]=u.useState({}),[U,w]=u.useState(null);if(!i.user||i.user.role!=="admin")return a.jsx("div",{className:"p-6 text-center",children:a.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:a.jsx("p",{className:"text-red-600 dark:text-red-400",children:"Access denied. This page is restricted to admin users only."})})});const N=async(G,ee={})=>{const O=await fetch(`http://localhost:5000/api${G}`,{...ee,headers:{"Content-Type":"application/json",...ee.headers}});if(!O.ok){const J=await O.json().catch(()=>({message:"Network error"}));throw new Error(J.message||`HTTP ${O.status}`)}const q=O.headers.get("content-type");return q&&q.includes("application/json")?await O.json():O},D=async G=>{G.preventDefault(),j(!0);try{(await N("/auth/webmaster-login",{method:"POST",body:JSON.stringify(v)})).webmaster&&(o(!0),await K())}catch(ee){alert(`Authentication failed: ${ee.message||"Invalid credentials"}`)}finally{j(!1)}},_=()=>{o(!1),z({username:"",password:""})},K=async()=>{b(!0);try{const G=await N("/collections/list");m(G)}catch(G){console.error("Failed to load collections:",G),alert("Failed to load collections")}finally{b(!1)}},X=async G=>{try{const ee=await fetch(`http://localhost:5000/api/collections/export/${G}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!ee.ok)throw new Error("Export failed");const V=await ee.blob(),O=window.URL.createObjectURL(V),q=document.createElement("a");q.href=O,q.download=`${G}_export_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(q),q.click(),window.URL.revokeObjectURL(O),document.body.removeChild(q),alert(`${G} collection exported successfully!`)}catch(ee){console.error("Export failed:",ee),alert("Export failed: "+ee.message)}},L=async G=>{if(!C[G]){alert("Please select a file to import");return}p(G);try{const ee=await N(`/collections/import/${G}`,{method:"POST",body:JSON.stringify({data:C[G]})});ee.success&&(alert(`Import completed successfully!
Inserted: ${ee.result.inserted}
Errors: ${ee.result.errors}`),await K(),w(null),E(V=>({...V,[G]:null})))}catch(ee){console.error("Import failed:",ee),alert("Import failed: "+ee.message)}finally{p(null)}},M=async G=>{if(window.confirm(`Are you sure you want to clear all data from ${G}? This action cannot be undone.`)){y(G);try{(await N(`/collections/clear/${G}`,{method:"DELETE"})).success&&(alert(`${G} database cleared successfully!`),await K())}catch(V){console.error("Clear failed:",V),alert("Clear failed: "+V.message)}finally{y(null)}}},B=(G,ee)=>{const V=new FileReader;V.onload=O=>{var q;try{const J=JSON.parse((q=O.target)==null?void 0:q.result);E(le=>({...le,[G]:J.data||J})),alert("File loaded successfully. Click Import to proceed.")}catch{alert("Invalid JSON file")}},V.readAsText(ee)};return x?a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-2",children:"Database Management"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage database collections - Export, Import and Clear data"})]}),a.jsxs("button",{onClick:_,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]}),g?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"Loading collections..."})]}):a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"SL"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Table Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Count"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Import"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Export"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Clear DB"})]})}),a.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:d.map((G,ee)=>a.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:ee+1}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-300",children:G.displayName}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:a.jsx("span",{className:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full text-xs",children:G.count})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsx("button",{onClick:()=>w(G.name),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs transition duration-200",children:"Import"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsx("button",{onClick:()=>X(G.name),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs transition duration-200",children:"Export"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsx("button",{onClick:()=>M(G.name),disabled:T===G.name||G.count===0,className:"bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white px-3 py-1 rounded text-xs transition duration-200",children:T===G.name?"Clearing...":"Clear"})})]},G.name))})]})})}),U&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:[(I=d.find(G=>G.name===U))==null?void 0:I.displayName," - Import"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select JSON file"}),a.jsx("input",{type:"file",accept:".json",onChange:G=>{var V;const ee=(V=G.target.files)==null?void 0:V[0];ee&&B(U,ee)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),C[U]&&a.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded p-3",children:a.jsxs("p",{className:"text-green-700 dark:text-green-300 text-sm",children:["File loaded! ",Array.isArray(C[U])?C[U].length:"N/A"," records found."]})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>L(U),disabled:!C[U]||S===U,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white py-2 px-4 rounded-md transition duration-200",children:S===U?"Importing...":"Import"}),a.jsx("button",{onClick:()=>{w(null),E(G=>({...G,[U]:null}))},className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md transition duration-200",children:"Cancel"})]})]})]})})]}):a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"max-w-md mx-auto",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-center mb-6 text-gray-800 dark:text-white",children:"Webmaster Access"}),a.jsx("p",{className:"text-center text-gray-600 dark:text-gray-300 mb-6",children:"Enter webmaster credentials to access Database Management"}),a.jsxs("form",{onSubmit:D,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username"}),a.jsx("input",{type:"text",value:v.username,onChange:G=>z(ee=>({...ee,username:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),a.jsx("input",{type:"password",value:v.password,onChange:G=>z(ee=>({...ee,password:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),a.jsx("button",{type:"submit",disabled:k,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white py-2 px-4 rounded-md transition duration-200",children:k?"Authenticating...":"Login"})]})]})})})},Gx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),a.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),Yx=({className:i})=>a.jsxs("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),Xx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})}),Zx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})}),Jx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})}),Kx=({className:i})=>a.jsx("svg",{className:i,stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})}),wf="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js",Qf="/pdf.worker.min.js";Nr.workerSrc=Qf;const hl=({url:i,initialScale:f=1})=>{const[x,o]=u.useState(null),[d,m]=u.useState(1),[g,b]=u.useState(0),[k,j]=u.useState(f),[S,p]=u.useState(!0),[T,y]=u.useState(null),[v,z]=u.useState(!1),[C,E]=u.useState(!1),U=u.useRef(null),w=u.useRef(null),N=u.useRef(null),D=u.useRef(null),_=u.useRef(!0);u.useEffect(()=>{const G=()=>{z(window.innerWidth<768)};return G(),window.addEventListener("resize",G),()=>window.removeEventListener("resize",G)},[]),u.useEffect(()=>{j(v?.65:f)},[v,f]);const K=u.useCallback(async(G,ee,V=0)=>{if(!(!ee||!U.current||!w.current||!_.current)){N.current&&N.current.cancel();try{const O=await ee.getPage(G);if(!_.current)return;const q=O.getViewport({scale:k}),J=U.current,le=J.getContext("2d");if(le&&_.current){J.height=q.height,J.width=q.width;const te={canvasContext:le,viewport:q},ne=O.render(te);N.current=ne,await ne.promise,N.current=null}}catch(O){if(!_.current||O.name==="RenderingCancelledException"||O.message==="cancelled")return;if(O.message&&(O.message.includes("Worker was destroyed")||O.message.includes("Worker"))&&(console.warn("PDF worker destroyed, attempting retry...",V),V<3&&_.current)){setTimeout(()=>{_.current&&K(G,ee,V+1)},Math.pow(2,V)*150);return}console.error("Render error:",O),(!O.message||!O.message.includes("Worker was destroyed"))&&y("Failed to render PDF page. Please try again.")}}},[k]);u.useEffect(()=>{if(!i)return;if(typeof jg>"u"){y("PDF.js library is not loaded."),p(!1);return}return _.current=!0,(async()=>{try{(await fetch(Qf,{method:"HEAD"})).ok||(console.warn("Local PDF worker not accessible, using CDN fallback"),Nr.workerSrc=wf)}catch(V){console.warn("Failed to access local PDF worker, using CDN fallback:",V),Nr.workerSrc=wf}const ee=tc(i);D.current=ee,p(!0),y(null),ee.promise.then(V=>{_.current&&(o(V),b(V.numPages),m(1),p(!1))}).catch(V=>{_.current&&(console.error("Error loading PDF:",V),V.name==="InvalidPDFException"?y("Failed to load PDF. Invalid PDF format."):V.name==="PasswordException"?y("Failed to load PDF. Password protected files are not supported."):V.name==="MissingPDFException"?y("Failed to load PDF. File not found or corrupted."):V.name==="UnexpectedResponseException"?y("Failed to load PDF. Network error occurred."):V.message&&(V.message.includes("Worker was destroyed")||V.message.includes("Worker"))?(console.warn("Worker destroyed during loading, retrying silently..."),setTimeout(()=>{if(_.current&&i){const O=tc(i);D.current=O,p(!0),y(null),O.promise.then(q=>{_.current&&(o(q),b(q.numPages),m(1),p(!1))}).catch(q=>{_.current&&(console.error("PDF reload failed:",q),y("Failed to load PDF. Please refresh the page."),p(!1))})}},200)):y(`Failed to load PDF. ${V.message||"Unknown error"}.`),p(!1))})})(),()=>{if(_.current=!1,D.current&&D.current.status!=="destroyed")try{D.current.destroy()}catch(ee){console.debug("Loading task cleanup error:",ee)}if(N.current)try{N.current.cancel()}catch(ee){console.debug("Render task cleanup error:",ee)}o(null)}},[i]),u.useEffect(()=>{x&&_.current&&K(d,x)},[x,d,K]),u.useEffect(()=>()=>{if(_.current=!1,N.current)try{N.current.cancel()}catch(G){console.debug("Render task cleanup error:",G)}if(D.current&&D.current.status!=="destroyed")try{D.current.destroy()}catch(G){console.debug("Loading task cleanup error:",G)}},[]);const X=()=>{d<=1||m(d-1)},L=()=>{d>=g||m(d+1)},M=()=>{j(G=>G+.1)},B=()=>{j(G=>Math.max(.1,G-.1))},I=()=>{w.current&&(C?document.exitFullscreen&&document.exitFullscreen():w.current.requestFullscreen&&w.current.requestFullscreen())};return u.useEffect(()=>{const G=()=>{E(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",G),()=>{document.removeEventListener("fullscreenchange",G)}},[]),a.jsxs("div",{ref:w,className:"w-full h-full bg-gray-200 dark:bg-gray-900 flex flex-col relative",children:[a.jsxs("div",{className:"w-full flex items-center justify-center p-2 bg-gray-100 dark:bg-gray-800 border-b border-gray-300 dark:border-gray-700 sticky top-0 z-10 shrink-0 gap-2 shadow-sm",children:[a.jsx("button",{onClick:X,disabled:d<=1||!x,className:"p-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700 disabled:opacity-30 transition-colors","aria-label":"Previous Page",title:"Previous Page",children:a.jsx(Xx,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"})}),a.jsxs("span",{className:"mx-2 text-sm font-medium text-gray-700 dark:text-gray-200",children:["Page ",d," of ",g||"--"]}),a.jsx("button",{onClick:L,disabled:d>=g||!x,className:"p-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700 disabled:opacity-30 transition-colors","aria-label":"Next Page",title:"Next Page",children:a.jsx(Zx,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"})}),a.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-2"}),a.jsx("button",{onClick:B,disabled:!x,className:"p-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700 disabled:opacity-30 transition-colors","aria-label":"Zoom Out",title:"Zoom Out",children:a.jsx(Yx,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"})}),a.jsxs("span",{className:"mx-2 text-sm font-medium text-gray-700 dark:text-gray-200 min-w-[3ch] text-center",children:[(k*100).toFixed(0),"%"]}),a.jsx("button",{onClick:M,disabled:!x,className:"p-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700 disabled:opacity-30 transition-colors","aria-label":"Zoom In",title:"Zoom In",children:a.jsx(Gx,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"})}),!v&&a.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-2"}),!v&&a.jsx("button",{onClick:I,disabled:!x,className:"p-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700 disabled:opacity-30 transition-colors","aria-label":C?"Exit Fullscreen":"Enter Fullscreen",title:C?"Exit Fullscreen":"Enter Fullscreen",children:C?a.jsx(Kx,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"}):a.jsx(Jx,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"})})]}),a.jsxs("div",{className:"flex-1 overflow-auto flex items-start justify-center bg-gray-500/20 p-4 relative w-full",children:[S&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-black/50 z-20",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}),T?a.jsxs("div",{className:"text-center p-10 text-red-500 bg-white dark:bg-gray-800 rounded-lg shadow-lg mt-10",children:[a.jsx("p",{className:"font-bold mb-2",children:"Error"}),T]}):a.jsx("canvas",{ref:U,className:"shadow-xl max-w-none bg-white"})]})]})},$x=i=>{const[f,x]=u.useState(null);return u.useEffect(()=>{if(!i||!i.startsWith("data:application/pdf")){x(null);return}let o=null;const d=setTimeout(()=>{try{const g=i.split(",")[1],b=atob(g),k=b.length,j=new Uint8Array(k);for(let p=0;p<k;p++)j[p]=b.charCodeAt(p);const S=new Blob([j],{type:"application/pdf"});o=URL.createObjectURL(S),x(o)}catch{x(i)}},0);return()=>{clearTimeout(d),o&&URL.revokeObjectURL(o)}},[i]),f},Wx=({content:i,onRemove:f,isAdmin:x,onExpand:o})=>{const d=$x(i.body),m=d||i.body,g=i.body.startsWith("data:application/pdf"),[b,k]=Vt.useState(!1);Vt.useEffect(()=>{const S=()=>{k(window.innerWidth<768)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const j=b?.65:1.5;return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-2 relative h-full flex flex-col",children:[a.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 z-20",children:[g&&a.jsx("button",{onClick:()=>o(m),className:`${b?"p-3":"p-2"} rounded-full bg-white/50 dark:bg-black/50 hover:bg-white/80 dark:hover:bg-black/80 backdrop-blur-sm shadow-md`,title:"View Fullscreen",children:a.jsx(Cr,{className:`${b?"w-6 h-6":"w-5 h-5"} text-gray-600 dark:text-gray-300`})}),x&&a.jsx("button",{onClick:f,className:`${b?"p-3":"p-2"} rounded-full bg-white/50 dark:bg-black/50 hover:bg-white/80 dark:hover:bg-black/80 backdrop-blur-sm shadow-md`,title:"Remove Book",children:a.jsx(et,{className:`${b?"w-6 h-6":"w-5 h-5"} text-gray-600 dark:text-gray-300`})})]}),a.jsx("h2",{className:"text-lg font-semibold mb-4 pr-24 shrink-0 text-gray-800 dark:text-white truncate",title:i.title,children:i.title}),g?a.jsx("div",{className:"flex-1 overflow-hidden rounded border dark:border-gray-700 bg-gray-100 dark:bg-gray-900 relative",children:d?a.jsx(hl,{url:d,initialScale:j}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Preparing PDF..."})}):a.jsxs("div",{className:"aspect-[8.5/11] w-full bg-gray-200 dark:bg-gray-700 rounded border dark:border-gray-600 flex flex-col items-center justify-center text-center p-4",children:[a.jsx(Is,{className:"w-16 h-16 text-gray-400 dark:text-gray-500 mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-semibold",children:"Cannot display PDF"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"This book is referencing a mock file path and cannot be opened."}),a.jsxs("p",{className:"text-xs text-gray-400 mt-1 truncate max-w-full",children:["(",i.body,")"]})]})]})},Px=({lessonId:i,onUpload:f,onExpand:x})=>{const[o,d]=u.useState(null),[m,g]=u.useState(null),[b,k]=u.useState("Loading title..."),[j,S]=u.useState(""),[p,T]=u.useState(!1),{showToast:y}=Xe(),[v,z]=Vt.useState(!1);Vt.useEffect(()=>{const w=()=>{z(window.innerWidth<768)};return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]);const C=v?.65:.5;u.useEffect(()=>{i?(async()=>{try{const N=await Wa(i);if(N&&N.trim()){const L=N.split(" > ").filter(M=>M.trim());if(L.length>=2){const M=L[L.length-1],B=L.join("/"),I=L[1].toLowerCase().replace(/\s+/g,""),G=L[2].replace(/\s+/g,""),ee=`../uploads/${L[0]}/${I}/${G}/Books/${M}.pdf`;k(M),S(ee);return}}let D=!1,_=[],K="New Book";const X=await cl();for(const L of X){const M=await dl(L._id);for(const B of M){const I=await ul(B._id),G=I.find(ee=>ee._id===i);if(G){_=[L.name,B.name,G.name],K=G.name,D=!0;break}for(const ee of I){const V=await fl(ee._id),O=V.find(q=>q._id===i);if(O){_=[L.name,B.name,ee.name,O.name],K=O.name,D=!0;break}if(!D)for(const q of V){const le=(await ml(q._id)).find(te=>te._id===i);if(le){_=[L.name,B.name,ee.name,q.name,le.name],K=le.name,D=!0;break}}}if(D)break}if(D)break}if(D&&_.length>0){const L=_.join("/"),M=_[1].toLowerCase().replace(/\s+/g,""),B=_[2].replace(/\s+/g,""),I=`../uploads/${_[0]}/${M}/${B}/Books/${K}.pdf`;k(K),S(I)}else{const L=`Book_${i.slice(-4)}`,M=`../uploads/Class/default/Unit/Books/${L}.pdf`;k(L),S(M)}}catch{k("New Book"),S("Default/Book/New Book.pdf")}})():(k("Select a lesson/unit first"),S("../uploads/Class/Pending/Unit/Books/Pending Selection.pdf"))},[i]),u.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const E=w=>{var D;const N=(D=w.target.files)==null?void 0:D[0];if(N)if(N.type==="application/pdf"){d(N);const _=URL.createObjectURL(N);g(_)}else y("Please select a valid PDF file.","error"),d(null),g(null)},U=async w=>{if(w.preventDefault(),!o||!b||p)return;T(!0);const N=new FileReader;N.onload=async()=>{try{const D=N.result;await Ut({title:b,body:D,lessonId:i,type:"book",metadata:{category:"Custom",subCategory:j}}),y("Book uploaded successfully!","success"),f()}catch{y("Failed to upload book.","error"),T(!1)}},N.onerror=()=>{y("Failed to read file.","error"),T(!1)},N.readAsDataURL(o)};return a.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-white dark:bg-gray-800/50 p-8 rounded-lg shadow-md h-full flex flex-col overflow-hidden",children:[a.jsx("h3",{className:"text-lg font-semibold text-center mb-1 text-gray-800 dark:text-white shrink-0",children:"Upload New Book"}),a.jsxs("p",{className:"text-sm text-center text-gray-500 dark:text-gray-400 mb-2 shrink-0",children:["File will be saved as: ",a.jsx("span",{className:"font-mono font-medium text-blue-600 dark:text-blue-400",children:b})]}),a.jsxs("p",{className:"text-xs text-center text-gray-400 dark:text-gray-500 mb-6 shrink-0 font-mono truncate",title:j,children:["Folder: ",j]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-start flex-1 overflow-y-auto pr-2",children:[a.jsxs("form",{onSubmit:U,className:"space-y-6 shrink-0",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"pdfFile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"PDF File"}),a.jsx("div",{className:"mt-1 flex items-center justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Pa,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:a.jsxs("label",{htmlFor:"pdfFile",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[a.jsx("span",{children:"Upload a file"}),a.jsx("input",{id:"pdfFile",name:"pdfFile",type:"file",className:"sr-only",onChange:E,accept:".pdf"})]})}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:o?o.name:"PDF up to 10MB"})]})})]}),a.jsxs("button",{type:"submit",disabled:!o||p,className:"w-full flex items-center justify-center gap-2 px-4 py-3 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed",children:[a.jsx(kr,{className:`${v?"w-6 h-6":"w-5 h-5"}`}),a.jsx("span",{className:v?"hidden":"inline",children:p?"Saving...":"Save Book"})]})]}),a.jsxs("div",{className:"flex flex-col h-full overflow-hidden min-h-[300px]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1 shrink-0",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Preview"}),m&&a.jsx("button",{type:"button",onClick:()=>x(m),className:"p-1.5 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",title:"View Fullscreen",children:a.jsx(Cr,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]}),a.jsx("div",{className:"flex-1 rounded border dark:border-gray-600 overflow-hidden relative",children:m?a.jsx(hl,{url:m,initialScale:C}):a.jsxs("div",{className:"w-full h-full bg-gray-200 dark:bg-gray-700 flex flex-col items-center justify-center text-center text-gray-500 dark:text-gray-400 rounded",children:[a.jsx(Is,{className:"w-12 h-12 mb-2"}),a.jsx("p",{children:"PDF preview will appear here"})]})})]})]})]})},Ix=({lessonId:i,user:f})=>{var v;const[x,o]=u.useState(0);u.useEffect(()=>{console.log("[BookView] LessonId changed:",i)},[i]);const{data:d,isLoading:m}=Ce(()=>tt(i,["book"]),[i,x]);u.useEffect(()=>{console.log("[BookView] Content loaded:",d)},[d]);const[g,b]=u.useState({isOpen:!1,onConfirm:null}),[k,j]=u.useState(null),{showToast:S}=Xe(),p=(v=d==null?void 0:d[0])==null?void 0:v.docs[0],T=f.role==="admin"||!!f.canEdit,y=z=>{b({isOpen:!0,onConfirm:async()=>{await Qt(z),o(E=>E+1),S("Book deleted successfully.","success"),b({isOpen:!1,onConfirm:null})}})};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full overflow-hidden flex flex-col",children:[a.jsx("div",{className:"hidden sm:flex justify-between items-center mb-6 shrink-0",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Is,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Book"})]})}),a.jsxs("div",{className:"flex-1 overflow-hidden min-h-0 flex flex-col",children:[m&&a.jsx("div",{className:"text-center py-10",children:"Loading book..."}),!m&&p&&a.jsx(Wx,{content:p,onRemove:()=>y(p._id),isAdmin:T,onExpand:j}),!m&&!p&&(T?a.jsx(Px,{lessonId:i,onUpload:()=>o(z=>z+1),onExpand:j}):a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(Is,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-4 text-gray-500",children:"No book available."})]}))]}),a.jsx(Mt,{isOpen:g.isOpen,onClose:()=>b({isOpen:!1,onConfirm:null}),onConfirm:g.onConfirm,title:"Remove Book",message:"Are you sure you want to remove this book? This action cannot be undone."}),k&&a.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex flex-col animate-fade-in h-screen w-screen",children:[a.jsx("div",{className:"hidden md:flex justify-end p-2 bg-black/50 absolute top-0 right-0 z-50 rounded-bl-lg",children:a.jsx("button",{onClick:()=>j(null),className:"p-2 rounded-full bg-red-600/80 hover:bg-red-500 text-white transition-colors","aria-label":"Close fullscreen PDF viewer",children:a.jsx(ia,{className:"w-6 h-6"})})}),a.jsx("div",{className:"md:hidden fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50",children:a.jsx("button",{onClick:()=>j(null),className:"p-3 rounded-full bg-red-600/80 hover:bg-red-500 text-white transition-colors backdrop-blur-sm shadow-lg","aria-label":"Close fullscreen PDF viewer",children:a.jsx(ia,{className:"w-6 h-6"})})}),a.jsx("div",{className:"w-full h-full pt-12 md:pt-0",children:a.jsx(hl,{url:k,initialScale:2.5})})]})]})},eb="/pdf.worker.min.js";Nr.workerSrc=eb;const Ff=i=>{const[f,x]=u.useState(null);return u.useEffect(()=>{if(!i||!i.startsWith("data:application/pdf")){x(null);return}let o=null;const d=setTimeout(()=>{try{const g=i.split(",")[1],b=atob(g),k=b.length,j=new Uint8Array(k);for(let p=0;p<k;p++)j[p]=b.charCodeAt(p);const S=new Blob([j],{type:"application/pdf"});o=URL.createObjectURL(S),x(o)}catch{x(i)}},0);return()=>{clearTimeout(d),o&&URL.revokeObjectURL(o)}},[i]),f},tb=({content:i,onClose:f,isMobile:x,isLandscape:o})=>{const[d,m]=u.useState(null),[g,b]=u.useState(1),[k,j]=u.useState(1),[S,p]=u.useState(null),[T,y]=u.useState(null),v=u.useRef(null),[z,C]=u.useState(0),[E,U]=u.useState(!1);u.useEffect(()=>{(async()=>{try{if(console.log("[FullscreenSlideViewer] Loading PDF for content:",i._id),i.filePath){const B=`/api/content/${i._id}/file`;console.log("[FullscreenSlideViewer] Using file URL:",B),m(B)}else if(i.body&&i.body.startsWith("data:application/pdf")){const B=Ff(i.body);m(B)}else console.log("[FullscreenSlideViewer] No filePath or base64 data found")}catch(B){console.error("[FullscreenSlideViewer] Error loading PDF:",B)}})()},[i]);const w=50,N=M=>{y(null),p(M.targetTouches[0].clientX)},D=M=>{y(M.targetTouches[0].clientX)},_=()=>{if(!S||!T)return;const M=S-T,B=M>w,I=M<-w;B&&g<k&&b(G=>G+1),I&&g>1&&b(G=>G-1)};u.useEffect(()=>{const M=B=>{B.key==="ArrowLeft"||B.key==="ArrowUp"?(B.preventDefault(),b(I=>Math.max(1,I-1))):B.key==="ArrowRight"||B.key==="ArrowDown"?(B.preventDefault(),b(I=>Math.min(k,I+1))):B.key==="Escape"&&f()};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[k,f]);const K=u.useCallback(M=>{const B=new Date().getTime();B-z<300&&f(),C(B)},[z,f]),X=u.useCallback(M=>{if(!v.current)return;const B=M.currentTarget.getBoundingClientRect(),G=(M.clientX-B.left)/B.width*100;G<=25?b(ee=>Math.max(1,ee-1)):G>=75&&b(ee=>Math.min(k,ee+1))},[k]),L=u.useCallback(M=>{j(M.numPages),b(1)},[]);return!o&&x?a.jsx("div",{className:"fixed inset-0 bg-black flex items-center justify-center z-50",children:a.jsxs("div",{className:"text-center text-white p-8",children:[a.jsx("div",{className:"w-24 h-24 mx-auto mb-6 border-4 border-white rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Please rotate your device"}),a.jsx("p",{className:"text-gray-300",children:"Slides work best in landscape mode. Please rotate your device to continue."})]})}):a.jsx("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",onTouchStart:N,onTouchMove:D,onTouchEnd:_,children:a.jsxs("div",{className:"w-full h-full relative cursor-pointer select-none",onClick:X,onDoubleClick:K,ref:v,children:[d?a.jsx(lb,{url:d,currentSlide:g,onSlideChange:b,onPdfLoad:L,isMobile:x}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-white",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ql,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Loading slides..."}),i.body&&!i.body.startsWith("data:application/pdf")&&a.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"No PDF data found"})]})}),a.jsx("div",{className:`absolute top-0 left-0 right-0 h-20 bg-gradient-to-b from-black/50 to-transparent transition-opacity duration-300 ${E?"opacity-100":"opacity-0"}`,onMouseEnter:()=>U(!0),onMouseLeave:()=>U(!1),children:a.jsx("button",{onClick:f,className:"absolute top-4 right-4 bg-black/70 backdrop-blur-sm hover:bg-black/90 text-white p-2 rounded-full transition-all duration-200 hover:scale-110 hover:rotate-90",title:"Close (ESC)",children:a.jsx(Hf,{className:"w-5 h-5"})})}),a.jsxs("div",{className:`absolute bottom-4 left-4 bg-black/70 backdrop-blur-sm px-4 py-2 rounded-lg text-white text-sm font-medium transition-opacity duration-300 ${E?"opacity-100":"opacity-0"}`,children:[g," / ",k]}),x&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute left-0 top-[75px] w-1/4 h-[calc(100%-75px)] bg-transparent hover:bg-white/5 transition-colors"}),a.jsx("div",{className:"absolute right-0 top-[75px] w-1/4 h-[calc(100%-75px)] bg-transparent hover:bg-white/5 transition-colors"}),a.jsx("div",{className:"absolute left-1/4 top-[75px] w-1/2 h-[calc(100%-75px)] bg-transparent hover:bg-blue-500/10 transition-colors border-l border-r border-blue-400/20"})]}),!x&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute left-0 top-[75px] w-1/4 h-[calc(100%-75px)] bg-transparent hover:bg-white/3 transition-colors cursor-pointer"}),a.jsx("div",{className:"absolute right-0 top-[75px] w-1/4 h-[calc(100%-75px)] bg-transparent hover:bg-white/3 transition-colors cursor-pointer"})]})]})})},lb=({url:i,currentSlide:f,onSlideChange:x,onPdfLoad:o,isMobile:d})=>{const[m,g]=u.useState(null),[b,k]=u.useState(1),j=u.useRef(null),S=u.useRef(null),p=u.useRef(null);return u.useEffect(()=>{if(!i)return;(async()=>{try{const v=await(await tc(i)).promise;g(v),o(v)}catch(y){console.error("Error loading PDF:",y)}})()},[i,o]),u.useEffect(()=>{const T=()=>{if(!m||!S.current)return;const y=S.current,v=y.clientWidth,z=y.clientHeight;m.getPage(f).then(C=>{const E=C.getViewport({scale:1}),U=E.width,w=E.height,N=v/U,D=z/w,_=Math.min(N,D);k(_)})};return window.addEventListener("resize",T),T(),()=>window.removeEventListener("resize",T)},[m,f]),u.useEffect(()=>{if(!m||!j.current||!S.current)return;(async()=>{try{p.current&&p.current.cancel();const y=await m.getPage(f),v=y.getViewport({scale:b}),z=j.current,C=z.getContext("2d");if(C){z.height=v.height,z.width=v.width;const E={canvasContext:C,viewport:v},U=y.render(E);p.current=U,await U.promise,p.current=null}}catch(y){console.error("Error rendering page:",y)}})()},[m,f,b]),a.jsx("div",{ref:S,className:"w-full h-full flex items-center justify-center bg-white overflow-hidden select-none",style:{userSelect:"none"},children:a.jsx("canvas",{ref:j,className:"shadow-2xl max-w-full max-h-full object-contain",style:{maxWidth:"100vw",maxHeight:"100vh",width:"auto",height:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"}})})},ab=({content:i,onRemove:f,isAdmin:x,onExpand:o})=>{const[d,m]=u.useState(null),[g,b]=u.useState(!1),[k,j]=u.useState(!0),[S,p]=u.useState(0);u.useEffect(()=>{(async()=>{try{if(console.log("[SavedSlideViewer] Loading content:",i._id),console.log("[SavedSlideViewer] Content has filePath:",!!i.filePath),console.log("[SavedSlideViewer] Content body:",i.body),i.filePath){const v=`/api/content/${i._id}/file`;console.log("[SavedSlideViewer] Using file URL:",v),m(v)}else if(i.body&&i.body.startsWith("data:application/pdf")){const v=Ff(i.body);m(v)}else{console.log("[SavedSlideViewer] No filePath or base64 data found, checking if body contains file path...");try{const v=JSON.parse(i.body);if(v.subCategory&&v.subCategory.includes(".pdf")){const z=`/api/content/${i._id}/file`;console.log("[SavedSlideViewer] Found file path in metadata:",z),m(z)}}catch{console.log("[SavedSlideViewer] Could not parse body as JSON")}}}catch(v){console.error("Error loading PDF:",v)}})()},[i]);const T=u.useCallback(y=>{const v=new Date().getTime();v-S<300&&o(),p(v)},[S,o]);return u.useEffect(()=>{const y=()=>{b(window.innerWidth<768),j(window.innerWidth>window.innerHeight)};return y(),window.addEventListener("resize",y),window.addEventListener("orientationchange",y),()=>{window.removeEventListener("resize",y),window.removeEventListener("orientationchange",y)}},[]),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md relative h-full flex flex-col",children:[a.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 z-20",children:[a.jsx("button",{onClick:o,className:`${g?"p-3":"p-2"} rounded-full bg-white/50 dark:bg-black/50 hover:bg-white/80 dark:hover:bg-black/80 backdrop-blur-sm shadow-md`,title:"View Fullscreen",children:a.jsx(Cr,{className:`${g?"w-6 h-6":"w-5 h-5"} text-gray-600 dark:text-gray-300`})}),x&&a.jsx("button",{onClick:f,className:`${g?"p-3":"p-2"} rounded-full bg-white/50 dark:bg-black/50 hover:bg-white/80 dark:hover:bg-black/80 backdrop-blur-sm shadow-md`,title:"Remove Slides",children:a.jsx(et,{className:`${g?"w-6 h-6":"w-5 h-5"} text-gray-600 dark:text-gray-300`})})]}),a.jsx("h2",{className:"text-lg p-3 font-semibold pr-24 shrink-0 text-gray-800 dark:text-white truncate",title:i.title,children:i.title}),d?a.jsxs("div",{className:"flex-1 overflow-hidden rounded border dark:border-gray-700 bg-gray-100 dark:bg-gray-900 relative cursor-pointer",onClick:o,onDoubleClick:T,title:"Double-click to view in fullscreen",children:[a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-900",children:a.jsxs("div",{className:"text-center p-8",children:[a.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-white dark:bg-gray-700 rounded-lg shadow-lg flex items-center justify-center",children:a.jsx(ql,{className:"w-10 h-10 text-blue-500 dark:text-blue-400"})}),a.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",children:"PDF Slides Ready"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Double-click to open fullscreen"}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Use left/right clicks to navigate slides"})]})}),a.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 bg-black/70 text-white text-xs px-2 py-1 rounded opacity-0 hover:opacity-100 transition-opacity",children:"Double-click to enter fullscreen"})]}):a.jsxs("div",{className:"flex-1 aspect-[16/9] w-full bg-gray-200 dark:bg-gray-700 rounded border dark:border-gray-600 flex flex-col items-center justify-center text-center p-4",children:[a.jsx(ql,{className:"w-16 h-16 text-gray-400 dark:text-gray-500 mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-semibold",children:"Cannot display PDF"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"This slide deck cannot be opened."})]})]})},sb=({lessonId:i,onUpload:f,onExpand:x})=>{const[o,d]=u.useState(null),[m,g]=u.useState(null),[b,k]=u.useState("Loading title..."),[j,S]=u.useState(""),[p,T]=u.useState(!1),{showToast:y}=Xe(),[v,z]=Vt.useState(!1);Vt.useEffect(()=>{const U=()=>{z(window.innerWidth<768)};return U(),window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[]),u.useEffect(()=>{i?(async()=>{try{const w=await Wa(i);if(w&&w.trim()){const X=w.split(" > ").filter(L=>L.trim());if(X.length>=2){const L=X[X.length-1],M=X.join("/"),B=X[1].toLowerCase().replace(/\s+/g,""),I=X[2].replace(/\s+/g,""),G=`../uploads/${X[0]}/${B}/${I}/Slides/${L}.pdf`;k(L),S(G);return}}let N=!1,D=[],_="New Slides";const K=await cl();for(const X of K){const L=await dl(X._id);for(const M of L){const B=await ul(M._id),I=B.find(G=>G._id===i);if(I){D=[X.name,M.name,I.name],_=I.name,N=!0;break}for(const G of B){const ee=await fl(G._id),V=ee.find(O=>O._id===i);if(V){D=[X.name,M.name,G.name,V.name],_=V.name,N=!0;break}if(!N)for(const O of ee){const J=(await ml(O._id)).find(le=>le._id===i);if(J){D=[X.name,M.name,G.name,O.name,J.name],_=J.name,N=!0;break}}}if(N)break}if(N)break}if(N&&D.length>0){const X=D.join("/"),L=D[1].toLowerCase().replace(/\s+/g,""),M=D[2].replace(/\s+/g,""),B=`../uploads/${D[0]}/${L}/${M}/Slides/${_}.pdf`;k(_),S(B)}else{const X=`Slides_${i.slice(-4)}`,L=`../uploads/Class/default/Unit/Slides/${X}.pdf`;k(X),S(L)}}catch{k("New Slides"),S("Default/Slides/New Slides.pdf")}})():(k("Select a lesson/unit first"),S("../uploads/Class/Pending/Unit/Slides/Pending Selection.pdf"))},[i]),u.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const C=U=>{var N;const w=(N=U.target.files)==null?void 0:N[0];if(w)if(w.type==="application/pdf"){d(w);const D=URL.createObjectURL(w);g(D)}else y("Please select a valid PDF file.","error"),d(null),g(null)},E=async U=>{if(U.preventDefault(),!(!o||!b||p)){T(!0);try{const w=new FormData;w.append("file",o),w.append("lessonId",i),w.append("type","slide"),w.append("title",b),w.append("metadata",JSON.stringify({category:"Custom",subCategory:j})),await zg(w),y("Slides uploaded successfully!","success"),f()}catch(w){console.error("Upload error:",w),y("Failed to upload slides.","error"),T(!1)}}};return a.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-white dark:bg-gray-800/50 rounded-lg shadow-md h-full flex flex-col overflow-hidden",children:[a.jsx("h3",{className:"text-lg p-3 font-semibold text-center text-gray-800 dark:text-white shrink-0",children:"Upload New Slides"}),a.jsxs("p",{className:"text-sm text-center p-3 text-gray-500 dark:text-gray-400 shrink-0",children:["File will be saved as: ",a.jsx("span",{className:"font-mono font-medium text-blue-600 dark:text-blue-400",children:b})]}),a.jsxs("p",{className:"text-xs text-center text-gray-400 dark:text-gray-500 shrink-0 font-mono truncate",title:j,children:["Folder: ",j]}),a.jsxs("div",{className:"grid ml-4 mr-4 p-2 md:grid-cols-2 gap-4 items-start flex-1 overflow-y-auto",children:[a.jsxs("form",{onSubmit:E,className:"shrink-0",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"pdfFile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"PDF File"}),a.jsx("div",{className:"flex mt-3 items-center justify-center border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Pa,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:a.jsxs("label",{htmlFor:"pdfFile",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[a.jsx("span",{children:"Upload a file"}),a.jsx("input",{id:"pdfFile",name:"pdfFile",type:"file",className:"sr-only",onChange:C,accept:".pdf"})]})}),a.jsx("p",{className:"text-xs p-3 text-gray-500 dark:text-gray-500",children:o?`${o.name} (${(o.size/(1024*1024)).toFixed(2)} MB)`:"PDF up to 500MB (upload limit)"})]})})]}),a.jsxs("button",{type:"submit",disabled:!o||p,className:"w-full flex mt-4 items-center justify-center gap-2 px-4 py-3 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed",children:[a.jsx(kr,{className:`${v?"w-6 h-6":"w-5 h-5"}`}),a.jsx("span",{className:v?"hidden":"inline",children:p?"Saving...":"Save Slides"})]})]}),a.jsxs("div",{className:"flex flex-col h-full overflow-hidden min-h-[300px]",children:[a.jsxs("div",{className:"flex justify-between items-center shrink-0",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Preview"}),m&&a.jsx("button",{type:"button",onClick:x,className:"p-1.5 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",title:"View Fullscreen",children:a.jsx(Cr,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]}),a.jsx("div",{className:"flex-1 rounded border dark:border-gray-600 overflow-hidden relative",children:m?a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-700",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ql,{className:"w-16 h-16 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-semibold",children:"Slides Preview"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Full-screen viewer will be available after upload"})]})}):a.jsxs("div",{className:"w-full h-full bg-gray-200 dark:bg-gray-700 flex flex-col items-center justify-center text-center text-gray-500 dark:text-gray-400 rounded",children:[a.jsx(ql,{className:"w-12 h-12 mb-2"}),a.jsx("p",{children:"Slides preview will appear here"})]})})]})]})]})},nb=({lessonId:i,user:f})=>{var v;const[x,o]=u.useState(0);u.useEffect(()=>{console.log("[SlideView] LessonId changed:",i)},[i]);const{data:d,isLoading:m}=Ce(()=>tt(i,["slide"]),[i,x]);u.useEffect(()=>{console.log("[SlideView] Content loaded:",d)},[d]);const[g,b]=u.useState({isOpen:!1,onConfirm:null}),[k,j]=u.useState(!1),{showToast:S}=Xe(),p=(v=d==null?void 0:d[0])==null?void 0:v.docs[0],T=f.role==="admin"||!!f.canEdit,y=z=>{b({isOpen:!0,onConfirm:async()=>{await Qt(z),o(E=>E+1),S("Slides deleted successfully.","success"),b({isOpen:!1,onConfirm:null})}})};return a.jsxs("div",{className:"h-full overflow-hidden flex flex-col",children:[a.jsx("div",{className:"hidden p-4 sm:flex justify-between items-center shrink-0",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(ql,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Slides"})]})}),a.jsxs("div",{className:"flex-1 p-5 overflow-hidden min-h-0 flex flex-col",children:[m&&a.jsx("div",{className:"text-center py-10",children:"Loading slides..."}),!m&&p&&a.jsx(ab,{content:p,onRemove:()=>y(p._id),isAdmin:T,onExpand:()=>j(!0)}),!m&&!p&&(T?a.jsx(sb,{lessonId:i,onUpload:()=>o(z=>z+1),onExpand:()=>j(!0)}):a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(ql,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-4 text-gray-500",children:"No slides available."})]}))]}),a.jsx(Mt,{isOpen:g.isOpen,onClose:()=>b({isOpen:!1,onConfirm:null}),onConfirm:g.onConfirm,title:"Remove Slides",message:"Are you sure you want to remove these slides? This action cannot be undone."}),k&&p&&a.jsx(tb,{content:p,onClose:()=>j(!1),isMobile:window.innerWidth<768,isLandscape:window.innerWidth>window.innerHeight})]})},rb=i=>{const[f,x]=u.useState(null);return u.useEffect(()=>{if(!i||!i.startsWith("data:application/pdf")){x(null);return}let o=null;const d=setTimeout(()=>{try{const g=i.split(",")[1],b=atob(g),k=b.length,j=new Uint8Array(k);for(let p=0;p<k;p++)j[p]=b.charCodeAt(p);const S=new Blob([j],{type:"application/pdf"});o=URL.createObjectURL(S),x(o)}catch(m){console.error("Failed to convert base64 to blob",m),x(i)}},0);return()=>{clearTimeout(d),o&&URL.revokeObjectURL(o)}},[i]),f},ib=({content:i,onRemove:f,isAdmin:x,onExpand:o,index:d})=>{const g=rb(i.body)||i.body;i.body.startsWith("data:application/pdf");const b=[{bg:"from-blue-400 to-purple-600",text:"text-white",icon:"bg-white/20"},{bg:"from-green-400 to-blue-600",text:"text-white",icon:"bg-white/20"},{bg:"from-purple-400 to-pink-600",text:"text-white",icon:"bg-white/20"},{bg:"from-red-400 to-orange-600",text:"text-white",icon:"bg-white/20"},{bg:"from-indigo-400 to-purple-600",text:"text-white",icon:"bg-white/20"},{bg:"from-yellow-400 to-red-600",text:"text-white",icon:"bg-white/20"},{bg:"from-pink-400 to-rose-600",text:"text-white",icon:"bg-white/20"},{bg:"from-teal-400 to-cyan-600",text:"text-white",icon:"bg-white/20"}],k=b[d%b.length];return a.jsxs("div",{className:"group relative bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-2xl transform hover:scale-105 transition-all duration-300 overflow-hidden cursor-pointer border border-gray-200 dark:border-gray-700",onClick:()=>o(g),children:[a.jsxs("div",{className:`h-24 bg-gradient-to-br ${k.bg} relative overflow-hidden`,children:[a.jsx("div",{className:"absolute inset-0 bg-black/10"}),a.jsx("div",{className:"absolute -top-4 -right-4 w-12 h-12 bg-white/10 rounded-full"}),a.jsx("div",{className:"absolute -bottom-2 -left-2 w-8 h-8 bg-white/10 rounded-full"}),a.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:a.jsx("div",{className:`p-3 ${k.icon} rounded-full backdrop-blur-sm shadow-md`,children:a.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})}),a.jsx("div",{className:"absolute top-3 right-3 flex gap-2 z-10",children:x&&a.jsx("button",{onClick:j=>{j.stopPropagation(),f()},className:"p-1.5 rounded-full bg-white/20 hover:bg-red-500/50 backdrop-blur-sm shadow-md transition-all",title:"Delete Worksheet",children:a.jsx(et,{className:"w-3 h-3 text-white"})})})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white mb-3 text-center line-clamp-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:i.title}),a.jsx("div",{className:"text-center",children:a.jsx("span",{className:"text-xs text-blue-500 dark:text-blue-400 font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:"Click to open PDF"})})]})]})},ob=({lessonId:i,onUpload:f,onExpand:x,onCancel:o,existingTitles:d})=>{const[m,g]=u.useState(null),[b,k]=u.useState(null),[j,S]=u.useState("Loading title..."),[p,T]=u.useState(!1),{showToast:y}=Xe();u.useEffect(()=>{i?(async()=>{try{console.log("=== FAST WORKSHEET PATH GENERATION START ===");const U=await Wa(i);if(U&&U.trim()){const K=U.split(" > ").filter(X=>X.trim());if(K.length>=2){const X=K[K.length-1],L=K.join("/"),M=K[1].toLowerCase().replace(/\s+/g,""),B=K[2].replace(/\s+/g,""),I=`../uploads/${K[0]}/${M}/${B}/Worksheets/${X}.pdf`;console.log("Fast worksheet path from breadcrumbs:",I),S(X);return}}console.log("Breadcrumbs failed, trying fast search...");let w=!1,N=[],D="New Worksheet";const _=await cl();for(const K of _){const X=await dl(K._id);for(const L of X){const M=await ul(L._id),B=M.find(I=>I._id===i);if(B){N=[K.name,L.name,B.name],D=B.name,w=!0;break}for(const I of M){const G=await fl(I._id),ee=G.find(V=>V._id===i);if(ee){N=[K.name,L.name,I.name,ee.name],D=ee.name,w=!0;break}if(!w)for(const V of G){const q=(await ml(V._id)).find(J=>J._id===i);if(q){N=[K.name,L.name,I.name,V.name,q.name],D=q.name,w=!0;break}}}if(w)break}if(w)break}if(w&&N.length>0){const K=N[1].toLowerCase().replace(/\s+/g,""),X=N[2].replace(/\s+/g,""),L=`../uploads/${N[0]}/${K}/${X}/Worksheets/${D}.pdf`;console.log("Fast worksheet path from search:",L),S(D)}else{console.log("Quick worksheet fallback for:",i);const K=`Worksheet_${i.slice(-4)}`;S(K)}}catch(U){console.error("Fast worksheet path generation error:",U),S("New Worksheet")}})():S("Select a lesson/unit first")},[i]),u.useEffect(()=>()=>{b&&URL.revokeObjectURL(b)},[b]);const v=E=>{var w;const U=(w=E.target.files)==null?void 0:w[0];if(U)if(U.type==="application/pdf"){g(U);const N=URL.createObjectURL(U);k(N),(!j||j==="Loading title..."||j==="New Worksheet"||j.startsWith("Worksheet_"))&&S(U.name.replace(/\.[^/.]+$/,""))}else y("Please select a valid PDF file.","error"),g(null),k(null)},z=E=>{if(!d.includes(E))return E;let U=1,w=`${E} ${U}`;for(;d.includes(w);)U++,w=`${E} ${U}`;return w},C=async E=>{if(E.preventDefault(),!m||!j||p)return;T(!0);const U=new FileReader;U.onload=async()=>{try{const w=U.result,N=z(j);N!==j&&y(`Title adjusted to avoid duplicate: "${N}"`,"info"),await Ut({title:N,body:w,lessonId:i,type:"worksheet",metadata:{category:"Custom"}}),y("Worksheet uploaded successfully!","success"),f(),g(null),k(null),o()}catch{y("Failed to upload worksheet.","error")}finally{T(!1)}},U.onerror=()=>{y("Failed to read file.","error"),T(!1)},U.readAsDataURL(m)};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6 upload-form-enter",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800 dark:text-white",children:"Upload Worksheet (PDF)"}),a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Title"}),a.jsx("input",{type:"text",value:j,onChange:E=>S(E.target.value),className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 text-gray-900 dark:text-gray-100",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"PDF File"}),a.jsx("div",{className:"mt-1 flex items-center justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Pa,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("div",{className:"flex text-sm text-gray-600 dark:text-gray-400 justify-center",children:a.jsxs("label",{htmlFor:"worksheet-upload",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[a.jsx("span",{children:"Upload a file"}),a.jsx("input",{id:"worksheet-upload",name:"worksheet-upload",type:"file",className:"sr-only",onChange:v,accept:".pdf"})]})}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:m?m.name:"PDF up to 15MB"})]})})]}),b&&a.jsx("div",{className:"h-64 border rounded overflow-hidden",children:a.jsx(hl,{url:b,initialScale:.6})}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsxs("button",{type:"button",onClick:()=>{g(null),k(null)},className:"px-3 py-2 sm:px-4 bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-200",disabled:p,title:"Clear",children:[a.jsx("span",{className:"hidden sm:inline",children:"Clear"}),a.jsx("span",{className:"sm:hidden",children:""})]}),a.jsxs("button",{type:"submit",className:"px-3 py-2 sm:px-4 bg-blue-600 text-white rounded-md disabled:bg-blue-400",disabled:p||!m,title:p?"Uploading...":"Upload Worksheet",children:[a.jsx("span",{className:"hidden sm:inline",children:p?"Uploading...":"Upload Worksheet"}),a.jsx("span",{className:"sm:hidden",children:""})]})]})]})]})},cb=({lessonId:i,user:f})=>{var C;const[x,o]=u.useState(0),[d,m]=u.useState(!1),{data:g,isLoading:b}=Ce(()=>tt(i,["worksheet"]),[i,x]),[k,j]=u.useState({isOpen:!1,onConfirm:null}),[S,p]=u.useState(null),{showToast:T}=Xe(),y=((C=g==null?void 0:g[0])==null?void 0:C.docs)||[],v=f.role==="admin"||!!f.canEdit,z=E=>{j({isOpen:!0,onConfirm:async()=>{await Qt(E),o(w=>w+1),T("Worksheet deleted successfully.","success"),j({isOpen:!1,onConfirm:null})}})};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(rc,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Worksheets"})]}),a.jsx("div",{className:"flex items-center gap-3",children:v&&a.jsxs("button",{onClick:()=>m(!d),className:"flex items-center gap-2 px-3 py-2 sm:px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:d?"Cancel":"Add Worksheet",children:[a.jsx(ct,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:d?"Cancel":"Add Worksheet"})]})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[b&&a.jsx("div",{className:"text-center py-10",children:"Loading worksheets..."}),d&&v&&a.jsx(ob,{lessonId:i,onUpload:()=>o(E=>E+1),onExpand:p,existingTitles:y.map(E=>E.title),onCancel:()=>m(!1)}),!b&&y.length>0&&a.jsx("div",{className:"pb-6",children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 max-w-4xl mx-auto",children:y.map((E,U)=>a.jsx(ib,{content:E,onRemove:()=>z(E._id),isAdmin:v,onExpand:p,index:U},E._id))})}),!b&&y.length===0&&a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(rc,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-4 text-gray-500",children:"No worksheets available for this chapter."})]})]}),a.jsx(Mt,{isOpen:k.isOpen,onClose:()=>j({isOpen:!1,onConfirm:null}),onConfirm:k.onConfirm,title:"Delete Worksheet",message:"Are you sure you want to delete this worksheet? This action cannot be undone."}),S&&a.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex flex-col animate-fade-in h-screen w-screen",children:[a.jsx("div",{className:"flex justify-end p-2 bg-black/50 absolute top-0 right-0 z-50 rounded-bl-lg",children:a.jsx("button",{onClick:()=>p(null),className:"p-2 rounded-full bg-white/20 hover:bg-white/40 text-white transition-colors","aria-label":"Close fullscreen PDF viewer",children:a.jsx(ia,{className:"w-6 h-6"})})}),a.jsx("div",{className:"w-full h-full",children:a.jsx(hl,{url:S,initialScale:2.5})})]})]})},Gf=i=>{if(!i)return"";const f=document.createElement("textarea");return f.innerHTML=i,f.value},db=i=>{if(!i)return"";let f=i;return[/`<pre><code[^>]*>([^<]*(&lt;[^&]*&gt;)[^<]*)<\/code><\/pre>`/gi,/`<code[^>]*>([^<]*(&lt;[^&]*&gt;)[^<]*)<\/code>`/gi,/```html\s*([\s\S]*?)\s*```/gi,/```\s*([\s\S]*?)\s*```/gi].forEach(o=>{f=f.replace(o,(d,m)=>`<pre class="html-code-display bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto font-mono text-sm"><code>${Gf(m)}</code></pre>`)}),f},zt=i=>{if(!i)return"";let f=i;f=Gf(f),f=f.replace(/<p>\s*&nbsp;\s*<\/p>/gi,""),f=f.replace(/<p>\s*<\/p>/gi,""),f=db(f);const x=/<(table|div|h[1-6]|ul|ol|li|pre|blockquote|header|footer|section|article|nav|form|fieldset|hr)/i.test(f);return!/<[a-zA-Z/][^>]*>/.test(f)&&f.trim()&&(x?f=`<div class="text-gray-700 dark:text-gray-300">${f}</div>`:f=`<p class="text-white-700 dark:text-gray-300">${f}</p>`),f=f.replace(/<p>\s*<\/p>/gi,""),f},ub=({initialValue:i,onSave:f,onCancel:x})=>{const o=u.useRef(null),d=u.useRef(null),m=u.useRef(!1),g=(j,S)=>{let p="";p+="";for(let y=0;y<S;y++)p+="".repeat(15),y<S-1&&(p+="");p+=`
`,p+="";for(let y=0;y<S;y++){const v=`Header ${y+1}`,z=Math.max(0,15-v.length);p+=v+" ".repeat(z),p+=""}p+=`
`,p+="";for(let y=0;y<S;y++)p+="".repeat(15),y<S-1&&(p+="");p+=`
`;for(let y=1;y<j;y++){p+="";for(let v=0;v<S;v++){const z=`Cell ${y}_${v+1}`,C=Math.max(0,15-z.length);p+=z+" ".repeat(C),p+=""}p+=`
`}p+="";for(let y=0;y<S;y++)p+="".repeat(15),y<S-1&&(p+="");return p+=`

`,`<div class="table-formatted" style="font-family: 'Courier New', monospace; background-color: #f8f9fa; padding: 10px; border: 1px solid #ddd; border-radius: 4px; white-space: pre; line-height: 1.2;">${p}</div>`},b=u.useCallback(()=>{if(o.current&&!d.current){const j=o.current.querySelector(".editor"),S=o.current.querySelector(".toolbar");if(j&&S){const p=new Quill(j,{debug:!1,theme:"snow",modules:{toolbar:{container:S,handlers:{"formula-custom":function(){const y=prompt("Enter your LaTeX formula (without delimiters):");if(y){const v=this.quill.getSelection(!0);this.quill.insertText(v.index,`$${y}$`,"user")}},table:function(){const y=parseInt(prompt("Enter number of rows (1-10):","3")||"3"),v=parseInt(prompt("Enter number of columns (1-10):","3")||"3");if(y>0&&y<=10&&v>0&&v<=10){const z=this.quill.getSelection(!0),C=g(y,v);this.quill.clipboard.dangerouslyPasteHTML(z.index,C,"user"),this.quill.setSelection(z.index+1,0,"user"),setTimeout(()=>{this.quill.format("line-height","1.2")},100)}}}},history:{delay:1e3,maxStack:50,userOnly:!0},clipboard:{matchVisual:!1}},placeholder:"Start writing your notes here..."}),T=zt(i);p.setText(""),p.root.innerHTML=T,p.setSelection(0,0),setTimeout(()=>{const y=p.root;y.querySelectorAll(".table-formatted").forEach(C=>{C.style.display="block",C.style.fontFamily="'Courier New', monospace",C.style.backgroundColor="#f8f9fa",C.style.border="2px solid #333",C.style.borderRadius="6px",C.style.padding="15px",C.style.margin="10px 0",C.style.whiteSpace="pre",C.style.lineHeight="1.2"}),y.querySelectorAll("*").forEach(C=>{!C.classList.contains("ql-editor")&&!C.closest(".ql-editor")&&(C.tagName==="DIV"||C.tagName==="SPAN")&&(C.style.display=C.style.display||"block")})},200),d.current=p}}},[i]);u.useEffect(()=>{b()},[b]);const k=async()=>{if(d.current&&!m.current){m.current=!0;let j=d.current.root.innerHTML;(!j||j.trim()===""||j==="<p><br></p>")&&(j="<p>New note content...</p>"),j=j.replace(/<div class="table-formatted">([\s\S]*?)<\/div>/g,(S,p)=>`<div class="table-formatted">${p}</div>`),await f(j),m.current=!1}};return a.jsxs("div",{ref:o,className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 w-full note-editor-container",children:[a.jsx("style",{children:`
                .table-formatted {
                    font-family: 'Courier New', monospace !important;
                    background-color: #f8f9fa !important;
                    padding: 15px !important;
                    border: 2px solid #333 !important;
                    border-radius: 6px !important;
                    white-space: pre !important;
                    line-height: 1.2 !important;
                    margin: 10px 0 !important;
                    display: block !important;
                }
                .table-formatted:hover {
                    background-color: #e9ecef !important;
                    border-color: #007bff !important;
                }
                /* Ensure HTML tables render properly in Quill editor */
                .ql-editor table {
                    border-collapse: collapse;
                    width: 100%;
                    margin: 10px 0;
                }
                .ql-editor th, .ql-editor td {
                    border: 1px solid #ddd;
                    padding: 8px;
                    text-align: left;
                }
                .ql-editor th {
                    background-color: #f2f2f2;
                    font-weight: bold;
                }
            `}),a.jsxs("div",{className:"toolbar border border-gray-300 dark:border-gray-600 rounded-t-lg bg-gray-50 dark:bg-gray-700 p-1",children:[a.jsx("span",{className:"ql-formats",children:a.jsx("select",{className:"ql-header",defaultValue:""})}),a.jsxs("span",{className:"ql-formats",children:[a.jsx("button",{className:"ql-bold"}),a.jsx("button",{className:"ql-italic"}),a.jsx("button",{className:"ql-underline"})]}),a.jsx("span",{className:"ql-formats",children:a.jsxs("select",{className:"ql-align",defaultValue:"",children:[a.jsx("option",{value:""}),a.jsx("option",{value:"center",children:"Center"}),a.jsx("option",{value:"right",children:"Right"}),a.jsx("option",{value:"justify",children:"Justify"})]})}),a.jsxs("span",{className:"ql-formats",children:[a.jsx("select",{className:"ql-color"}),a.jsx("select",{className:"ql-background"})]}),a.jsxs("span",{className:"ql-formats",children:[a.jsx("button",{className:"ql-list",value:"ordered"}),a.jsx("button",{className:"ql-list",value:"bullet"}),a.jsx("button",{className:"ql-blockquote"})]}),a.jsx("span",{className:"ql-formats",children:a.jsx("button",{className:"ql-table",title:"Insert Table",children:a.jsxs("svg",{viewBox:"0 0 18 18",style:{width:"18px",height:"18px"},children:[a.jsx("rect",{className:"ql-stroke",height:"7",rx:"1",ry:"1",width:"2",x:"2",y:"2"}),a.jsx("rect",{className:"ql-stroke",height:"7",rx:"1",ry:"1",width:"2",x:"8",y:"2"}),a.jsx("path",{className:"ql-fill",d:"M2,9h6v7H2Z"}),a.jsx("path",{className:"ql-fill",d:"M8,9h8v7H8Z"})]})})}),a.jsxs("span",{className:"ql-formats",children:[a.jsx("button",{className:"ql-link"}),a.jsx("button",{className:"ql-image"}),a.jsx("button",{className:"ql-video"})]}),a.jsx("span",{className:"ql-formats",children:a.jsx("button",{className:"ql-formula-custom",type:"button",title:"Insert Formula (LaTeX)",children:a.jsx("svg",{viewBox:"0 0 18 18",style:{width:"18px",height:"18px"},children:a.jsx("text",{x:"2",y:"14",style:{fontFamily:"monospace, sans-serif",fontSize:"14px"},children:"x"})})})}),a.jsx("span",{className:"ql-formats",children:a.jsx("button",{className:"ql-clean"})})]}),a.jsx("div",{className:"editor h-96 border-l border-r border-b border-gray-300 dark:border-gray-600 rounded-b-lg"}),a.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[a.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 rounded-md text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500",title:"Cancel",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),a.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]}),a.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700",title:"Save Note",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),a.jsx("span",{className:"hidden sm:inline",children:"Save Note"})]})]})]})},ol=[10,12,14,16,18,20,24,28,32],uc=()=>{const{session:i,setFontSize:f}=Rt(),x=o=>{let d=ol.findIndex(g=>g===i.fontSize);if(d===-1){const g=ol.reduce((b,k)=>Math.abs(k-i.fontSize)<Math.abs(b-i.fontSize)?k:b);d=ol.indexOf(g)}let m=o==="up"?d+1:d-1;m<0&&(m=0),m>=ol.length&&(m=ol.length-1),m!==d&&f(ol[m])};return a.jsxs("div",{className:"flex items-center bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 mr-2 h-9",children:[a.jsx("button",{onClick:()=>x("down"),disabled:i.fontSize<=ol[0],className:"px-2 h-full rounded-l-lg hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-30 text-gray-600 dark:text-gray-300 border-r border-gray-200 dark:border-gray-700 transition-colors flex items-center justify-center w-9",title:"Decrease Font Size",children:a.jsx(yx,{className:"w-4 h-4"})}),a.jsxs("div",{className:"px-3 h-full flex items-center justify-center min-w-[3.5rem] text-xs font-mono font-medium text-gray-700 dark:text-gray-200 bg-gray-50 dark:bg-gray-900",children:[i.fontSize,"px"]}),a.jsx("button",{onClick:()=>x("up"),disabled:i.fontSize>=ol[ol.length-1],className:"px-2 h-full rounded-r-lg hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-30 text-gray-600 dark:text-gray-300 border-l border-gray-200 dark:border-gray-700 transition-colors flex items-center justify-center w-9",title:"Increase Font Size",children:a.jsx(bx,{className:"w-4 h-4"})})]})},fb=({item:i,onEdit:f,onDelete:x,isAdmin:o})=>{const{session:d}=Rt(),m={fontSize:`${d.fontSize}px`};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 relative group",children:[a.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none text-gray-600 dark:text-gray-400 break-words overflow-y-auto note-content",style:{fontSize:`${m.fontSize}`,minHeight:"calc(100vh - 200px)",maxHeight:"calc(100vh - 150px)",scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},dangerouslySetInnerHTML:{__html:zt(i.body)}}),a.jsx("style",{children:`
                .note-content {
                    /* Hide scrollbar for WebKit browsers */
                    -webkit-overflow-scrolling: touch;
                }
                
                .note-content::-webkit-scrollbar {
                    display: none !important;
                    width: 0 !important;
                    height: 0 !important;
                }
                
                .note-content::-moz-scrollbar {
                    display: none !important;
                }
                
                .note-content::-ms-scrollbar {
                    display: none !important;
                }
                
                .note-content::-o-scrollbar {
                    display: none !important;
                }
                
                /* Hide scrollbar for Firefox */
                .note-content {
                    scrollbar-width: none !important;
                    -ms-overflow-style: none !important;
                }
                `}),o&&a.jsxs("div",{className:"absolute top-3 right-3 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity sm:opacity-0 md:group-hover:opacity-100",children:[a.jsx("button",{onClick:()=>f(i),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm shadow-sm",title:"Edit Note",children:a.jsx(oa,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),a.jsx("button",{onClick:()=>x(i._id),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm shadow-sm",title:"Delete Note",children:a.jsx(et,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]})]})},mb=({lessonId:i,user:f})=>{var E;const[x,o]=u.useState(0),{data:d,isLoading:m}=Ce(()=>tt(i,["notes"]),[i,x]),[g,b]=u.useState(null),[k,j]=u.useState({isOpen:!1,onConfirm:null}),{showToast:S}=Xe(),p=((E=d==null?void 0:d[0])==null?void 0:E.docs)||[],T="notes",y=f.role==="admin"||!!f.canEdit;u.useEffect(()=>{window.MathJax&&!m&&p.length>0&&g===null&&window.MathJax.typesetPromise()},[p,m,g]);const v=async U=>{try{if(typeof g=="object"&&g!==null)await $a(g._id,{body:U});else{const w=document.createElement("div");w.innerHTML=U;const D=(w.textContent||w.innerText||"").trim().substring(0,50)||`Note - ${new Date().toLocaleDateString()}`;await Ut({title:D,body:U,lessonId:i,type:T})}o(w=>w+1),S("Note saved successfully.","success")}catch{S("Failed to save note.","error")}b(null)},z=U=>{j({isOpen:!0,onConfirm:async()=>{try{await Qt(U),o(N=>N+1),S("Note deleted.","error")}catch{S("Failed to delete note.","error")}j({isOpen:!1,onConfirm:null})}})},C=()=>{b(null)};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ac,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Notes"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(uc,{}),y&&!g&&a.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Add New Note",children:[a.jsx(ct,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Add New"})]})]})]}),g?a.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 pb-3",children:a.jsx(ub,{initialValue:typeof g=="object"&&g!==null?g.body:"",onSave:v,onCancel:C})}):a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 pb-6",children:[m&&a.jsx("div",{className:"text-center py-10",children:"Loading notes..."}),!m&&p.length>0&&a.jsx("div",{className:"space-y-[30px]",children:p.map(U=>a.jsx(fb,{item:U,onEdit:b,onDelete:z,isAdmin:y},U._id))}),!m&&p.length===0&&a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(ac,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-4 text-gray-500",children:"No notes available for this chapter."})]})]}),a.jsx(Mt,{isOpen:k.isOpen,onClose:()=>j({isOpen:!1,onConfirm:null}),onConfirm:k.onConfirm,title:"Delete Note",message:"Are you sure you want to delete this note?"})]})},Yf={CP1:{label:"Conceptual Clarity",color:"bg-blue-100 text-blue-800 border-blue-200"},CP2:{label:"Application Skill",color:"bg-green-100 text-green-800 border-green-200"},CP3:{label:"Computational Thinking",color:"bg-purple-100 text-purple-800 border-purple-200"},CP4:{label:"Analytical Thinking",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},CP5:{label:"Critical Thinking",color:"bg-red-100 text-red-800 border-red-200"},CP6:{label:"Creative Thinking",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},CP7:{label:"Values/Attitudes",color:"bg-pink-100 text-pink-800 border-pink-200"}},hb=i=>{switch(i){case 2:return"bg-teal-100 text-teal-800 border-teal-200";case 3:return"bg-sky-100 text-sky-800 border-sky-200";case 5:return"bg-orange-100 text-orange-800 border-orange-200";case 6:return"bg-rose-100 text-rose-800 border-rose-200";default:return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}},gb=i=>{switch(i){case"Basic":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"Average":return"bg-amber-100 text-amber-800 border-amber-200";case"Profound":return"bg-violet-100 text-violet-800 border-violet-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},xb=({isOpen:i,onClose:f,onSave:x,contentToEdit:o})=>{const[d,m]=u.useState("question"),[g,b]=u.useState(""),[k,j]=u.useState(""),[S,p]=u.useState(2),[T,y]=u.useState("Basic"),[v,z]=u.useState("CP1"),[C,E]=u.useState(!1),[U,w]=u.useState(!1),N=u.useRef(null),D=u.useRef(null);u.useEffect(()=>{if(!i)return;const M=setTimeout(()=>{w(!1),m("question");const B=o?o.title:"",I=o?o.body:"";console.log("[QAEditor] Loading content for edit:",o?"existing":"new"),console.log("[QAEditor] Question content:",B.substring(0,100)+(B.length>100?"...":"")),console.log("[QAEditor] Answer content:",I.substring(0,100)+(I.length>100?"...":"")),b(B),j(I);const G=o==null?void 0:o.metadata;if(p((G==null?void 0:G.marks)||2),y((G==null?void 0:G.questionType)||"Basic"),z((G==null?void 0:G.cognitiveProcess)||"CP1"),N.current&&!D.current){console.log("[QAEditor] Initializing Quill editor");const ee=new Quill(N.current,{theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{color:[]},{background:[]}],["image","video","formula"],["clean"]]},placeholder:"Enter content..."}),V=d==="question"?B:I;console.log("[QAEditor] Setting initial content for",d,":",V.substring(0,100)+"..."),ee.root.innerHTML=V,D.current=ee,w(!0),console.log("[QAEditor] Editor initialized successfully")}},100);return()=>clearTimeout(M)},[i,o]),u.useEffect(()=>()=>{i||(console.log("[QAEditor] Cleaning up editor"),D.current=null,w(!1))},[i]),u.useEffect(()=>{if(D.current&&U&&i){const L=d==="question"?g:k,M=D.current.root.innerHTML;console.log("[QAEditor] Tab changed to",d),console.log("[QAEditor] Content to load:",L.substring(0,100)+"..."),console.log("[QAEditor] Current content:",M.substring(0,100)+"..."),M!==L&&(console.log("[QAEditor] Loading content into Quill editor"),D.current.root.innerHTML=L)}},[d,U,g,k,i]);const _=L=>{if(L===d||!D.current||!U)return;console.log("[QAEditor] Switching from",d,"to",L);const M=D.current.root.innerHTML;console.log("[QAEditor] Saving current content before switch:",M.substring(0,100)+"..."),d==="question"?(b(M),console.log("[QAEditor] Saved question content")):(j(M),console.log("[QAEditor] Saved answer content")),m(L),console.log("[QAEditor] Tab switched to:",L)},K=async()=>{if(C)return;let L=g,M=k;if(D.current&&U){const B=D.current.root.innerHTML;console.log("[QAEditor] Saving current editor content:",B.substring(0,100)+"..."),d==="question"?L=B:M=B}if(!L.trim()||!M.trim()){alert("Both Question and Answer must have content.");return}console.log("[QAEditor] Saving Q&A with question length:",L.length,"answer length:",M.length),E(!0);try{await x({title:L,body:M,metadata:{marks:S,questionType:T,cognitiveProcess:v}}),console.log("[QAEditor] Q&A saved successfully"),X()}catch(B){console.error("Error saving Q&A:",B),alert("Error saving Q&A. Please try again.")}finally{E(!1)}},X=()=>{console.log("[QAEditor] Closing modal and resetting form"),b(""),j(""),p(2),y("Basic"),z("CP1"),m("question"),w(!1),D.current&&(D.current.root.innerHTML=""),D.current=null,f()};return i?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl flex flex-col max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:o?"Edit Q&A":"Add New Q&A"}),a.jsx("button",{onClick:X,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:a.jsx("span",{className:"text-2xl",children:""})})]}),a.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 grid grid-cols-1 sm:grid-cols-3 gap-4 border-b border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-1",children:"Marks"}),a.jsxs("select",{value:S,onChange:L=>p(Number(L.target.value)),className:"w-full p-2 text-sm border rounded bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[a.jsx("option",{value:2,children:"2 Marks"}),a.jsx("option",{value:3,children:"3 Marks"}),a.jsx("option",{value:5,children:"5 Marks"}),a.jsx("option",{value:6,children:"6 Marks"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-1",children:"Question Type"}),a.jsxs("select",{value:T,onChange:L=>y(L.target.value),className:"w-full p-2 text-sm border rounded bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[a.jsx("option",{value:"Basic",children:"Basic"}),a.jsx("option",{value:"Average",children:"Average"}),a.jsx("option",{value:"Profound",children:"Profound"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-1",children:"Cognitive Process"}),a.jsx("select",{value:v,onChange:L=>z(L.target.value),className:"w-full p-2 text-sm border rounded bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Object.entries(Yf).map(([L,M])=>a.jsxs("option",{value:L,children:[L," - ",M.label]},L))})]})]}),a.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[a.jsx("button",{className:`flex-1 py-3 text-sm font-medium text-center transition-colors ${d==="question"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 border-t-2 border-blue-500":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>_("question"),children:"Question"}),a.jsx("button",{className:`flex-1 py-3 text-sm font-medium text-center transition-colors ${d==="answer"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 border-t-2 border-blue-500":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>_("answer"),children:"Answer"})]}),a.jsx("div",{className:"flex-1 flex flex-col p-4 overflow-hidden bg-white dark:bg-gray-800",children:a.jsx("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 flex-1 flex flex-col overflow-hidden text-gray-900 dark:text-gray-100",children:a.jsx("div",{ref:N,className:"flex-1 overflow-y-auto tamil-text",style:{minHeight:"200px",fontFamily:"'Noto Sans Tamil', 'Kailasa', 'Latha', sans-serif"}})})}),a.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex justify-end gap-3",children:[a.jsx("button",{onClick:X,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600",disabled:C,children:"Cancel"}),a.jsx("button",{onClick:K,className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-blue-400",disabled:C,children:C?"Saving...":"Save Q&A"})]})]})}):null},bb=({item:i,isOpen:f,onToggle:x,onEdit:o,onDelete:d,isAdmin:m})=>{const{session:g}=Rt(),b=i.metadata,k=b!=null&&b.cognitiveProcess?Yf[b.cognitiveProcess]:null,j={fontSize:`${g.fontSize}px`};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden mb-6 border border-gray-200 dark:border-gray-700 transition-all duration-300 hover:shadow-xl hover:scale-[1.02]",children:[a.jsxs("div",{onClick:x,className:"w-full text-left p-5 flex flex-col group focus:outline-none focus:bg-gray-50 dark:focus:bg-gray-700/50 transition-all duration-200 cursor-pointer",children:[a.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[(b==null?void 0:b.marks)&&a.jsxs("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider border ${hb(b.marks)}`,children:[b.marks," Marks"]}),(b==null?void 0:b.questionType)&&a.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider border ${gb(b.questionType)}`,children:b.questionType}),k&&a.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider border ${k.color}`,children:k.label})]}),a.jsxs("div",{className:"flex justify-between items-start w-full",children:[a.jsx("div",{className:"flex-1 pr-4",children:a.jsx("div",{className:"prose dark:prose-invert max-w-none font-medium text-gray-800 dark:text-white qa-content tamil-text",style:j,dangerouslySetInnerHTML:{__html:zt(i.title)}})}),a.jsxs("div",{className:"flex items-center shrink-0 mt-1",children:[m&&a.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity mr-4",onClick:S=>S.stopPropagation(),children:[a.jsxs("button",{onClick:S=>{S.stopPropagation(),o(i)},className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500",title:"Edit Q&A",children:[a.jsx(oa,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline ml-1",children:"Edit"})]}),a.jsxs("button",{onClick:S=>{S.stopPropagation(),d(i._id)},className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 hover:text-red-600",title:"Delete Q&A",children:[a.jsx(et,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline ml-1",children:"Delete"})]})]}),a.jsx("div",{className:`p-1 rounded-full bg-gray-100 dark:bg-gray-700 transition-transform duration-200 ${f?"rotate-90":""}`,children:a.jsx(Ka,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})]})]}),f&&a.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50/30 to-indigo-50/30 dark:from-gray-800/50 dark:to-gray-700/50 animate-fade-in",children:a.jsx("div",{className:"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 qa-content tamil-text",style:j,dangerouslySetInnerHTML:{__html:zt(i.body)}})})]})},yb=({lessonId:i,user:f})=>{var U;const[x,o]=u.useState(0),{data:d,isLoading:m}=Ce(()=>tt(i,["qa"]),[i,x]),[g,b]=u.useState({isOpen:!1,content:null}),[k,j]=u.useState({isOpen:!1,onConfirm:null}),[S,p]=u.useState(null),T=((U=d==null?void 0:d[0])==null?void 0:U.docs)||[],y="qa",v=f.role==="admin"||!!f.canEdit,z=async w=>{g.content?await $a(g.content._id,w):await Ut({...w,lessonId:i,type:y}),o(N=>N+1),b({isOpen:!1,content:null})},C=w=>{j({isOpen:!0,onConfirm:async()=>{await Qt(w),o(D=>D+1),j({isOpen:!1,onConfirm:null})}})},E=w=>{p(N=>N===w?null:w)};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex flex-col h-full overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(sc,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Q&A"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(uc,{}),v&&a.jsxs("button",{onClick:()=>b({isOpen:!0,content:null}),className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Add New Q&A",children:[a.jsx(ct,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Add New"})]})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 pb-8",children:[m&&a.jsx("div",{className:"text-center py-12",children:"Loading Q&A..."}),!m&&T.length>0&&a.jsx("div",{className:"space-y-6",children:T.map(w=>a.jsx(bb,{item:w,isOpen:S===w._id,onToggle:()=>E(w._id),onEdit:N=>b({isOpen:!0,content:N}),onDelete:C,isAdmin:v},w._id))}),!m&&T.length===0&&a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(sc,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-4 text-gray-500",children:"No Q&A available for this chapter."})]})]}),a.jsx(xb,{isOpen:g.isOpen,onClose:()=>b({isOpen:!1,content:null}),onSave:z,contentToEdit:g.content}),a.jsx(Mt,{isOpen:k.isOpen,onClose:()=>j({isOpen:!1,onConfirm:null}),onConfirm:k.onConfirm,title:"Delete Q&A",message:"Are you sure you want to delete this Q&A?"})]})},Nf=({isOpen:i,onClose:f,onImport:x})=>{const[o,d]=u.useState(""),[m,g]=u.useState(!1),[b,k]=u.useState(null),[j,S]=u.useState("json"),p=Vt.useRef(null);if(u.useEffect(()=>{i&&(d(""),k(null))},[i]),!i)return null;const T=U=>{const w=U.split(`
`).filter(D=>D.trim()),N=[];for(let D=0;D<w.length;D++){const _=w[D].trim();if(!_)continue;const K=y(_);K.length>=2&&N.push({title:K[0].trim(),body:K[1].trim()})}return N},y=U=>{const w=[];let N="",D=!1;for(let _=0;_<U.length;_++){const K=U[_],X=U[_+1];K==='"'&&X==='"'?(N+='"',_++):K==='"'?D=!D:K===","&&!D?(w.push(N),N=""):N+=K}return w.push(N),w},v=U=>{var N;const w=(N=U.target.files)==null?void 0:N[0];if(w)if(w.type==="text/csv"||w.name.endsWith(".csv")){const D=new FileReader;D.onload=_=>{var X;const K=(X=_.target)==null?void 0:X.result;d(K),S("csv"),k(null)},D.readAsText(w)}else k("Please select a CSV file.")},z=()=>o.includes("&quot;")||o.includes("&#39;")||o.includes("&amp;")||o.includes("&lt;")||o.includes("&gt;"),C=()=>{k(null),console.log("[Format] Original text:",o.substring(0,200)+"...");const U=o.trim().replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#38;/g,"&").replace(/&#60;/g,"<").replace(/&#62;/g,">").replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'");console.log("[Format] Cleaned text:",U.substring(0,200)+"...");try{const w=JSON.parse(U);if(Array.isArray(w)){const N=JSON.stringify(w,null,2);console.log("[Format] Successfully formatted JSON"),d(N),k(null);return}else k("JSON must be an array of objects.")}catch(w){console.log("[Format] Parse error:",w.message),k(`Invalid JSON syntax after fixing entities: ${w.message}`)}},E=async()=>{if(m||!o.trim())return;g(!0),k(null);let U=[];if(j==="csv")U=T(o);else try{const w=JSON.parse(o.trim());Array.isArray(w)&&(U=w.filter(N=>N&&(N.f||N.front||N.title)&&(N.b||N.back||N.body)).map(N=>({title:(N.f||N.front||N.title||"").trim(),body:(N.b||N.back||N.body||"").trim()})))}catch{let N=o.trim();N=N.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'");try{const D=JSON.parse(N);Array.isArray(D)&&(U=D.filter(_=>_&&(_.f||_.front||_.title)&&(_.b||_.back||_.body)).map(_=>({title:(_.f||_.front||_.title||"").trim(),body:(_.b||_.back||_.body||"").trim()})))}catch{U=N.split(`
`).map(K=>K.split(";")).filter(K=>K.length>=2&&K[0].trim()&&K[1].trim()).map(K=>({title:K[0].trim(),body:K.slice(1).join(";").trim()}))}}U.length>0?(await x(U),f()):k(j==="csv"?"Could not parse any cards from CSV. Please ensure the format is: Question,Answer":'Could not parse any cards. Please ensure JSON is an array of objects (e.g., [{"f":"Question", "b":"Answer"}]) or use "Question;Answer" format per line.'),g(!1)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-3xl flex flex-col max-h-[90vh]",onClick:U=>U.stopPropagation(),children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:"Import Flashcards"}),a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx("button",{onClick:()=>S("json"),className:`px-3 py-1 text-sm rounded-md ${j==="json"?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"}`,children:"JSON/Text"}),a.jsx("button",{onClick:()=>S("csv"),className:`px-3 py-1 text-sm rounded-md ${j==="csv"?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"}`,children:"CSV File"})]}),a.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4 space-y-2",children:j==="json"?a.jsx(a.Fragment,{children:a.jsx("ul",{className:"list-disc list-inside text-xs space-y-1",children:a.jsxs("li",{children:[a.jsx("b",{children:"JSON Array:"})," ",a.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 p-1 rounded-sm select-all",children:'[{"f":"Question HTML","b":"Answer HTML"}]'})," (Use 'Format' button to clean quotes)."]})})}):a.jsx(a.Fragment,{children:a.jsx("ul",{className:"list-disc list-inside text-xs space-y-1",children:a.jsxs("li",{children:[a.jsx("b",{children:"First column:"})," Front - ",a.jsx("b",{children:"Second column:"})," Back"]})})})}),j==="csv"&&a.jsxs("div",{className:"mb-4",children:[a.jsx("input",{ref:p,type:"file",accept:".csv",onChange:v,className:"hidden"}),a.jsx("button",{onClick:()=>{var U;return(U=p.current)==null?void 0:U.click()},className:"px-4 py-2 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-md hover:bg-green-200 dark:hover:bg-green-800 text-sm font-medium",children:"Choose CSV File"})]}),a.jsx("textarea",{value:o,rows:15,onChange:U=>{d(U.target.value),k(null)},placeholder:j==="json"?`[
  {
    "f": "What is <b>HTML</b>?",
    "b": "HyperText Markup Language"
  }
]`:`Question 1,Answer 1
Question 2,Answer 2
Question 3,Answer 3`,className:"flex-1 w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-mono text-xs resize-none",autoFocus:!0}),b&&a.jsx("p",{className:"text-sm text-red-500 dark:text-red-400 mt-2",children:b}),z()&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md"}),a.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[j==="json"&&a.jsx("button",{onClick:C,className:"px-4 py-2 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 rounded-md hover:bg-yellow-200 dark:hover:bg-yellow-800 font-medium text-sm",children:z()?"Fix HTML Entities":"Format & Preview"}),a.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 rounded-md text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-sm",disabled:m,children:"Cancel"}),a.jsx("button",{onClick:E,className:"px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-wait text-sm font-medium",disabled:m||!o.trim(),children:m?"Importing...":`Import ${j==="csv"?"from CSV":"Cards"}`})]})]})})},Xf=()=>{const i=u.useRef(null);return u.useEffect(()=>{const f=i.current;if(!f)return;const x=["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff"],o=[];for(let m=0;m<30;m++){const g=document.createElement("div");g.style.position="absolute",g.style.width="5px",g.style.height="5px",g.style.borderRadius="50%",g.style.backgroundColor=x[Math.floor(Math.random()*x.length)],g.style.left=`${40+Math.random()*20}%`,g.style.top=`${40+Math.random()*20}%`,f.appendChild(g),o.push(g);const b=Math.random()*Math.PI*2,k=50+Math.random()*150,j=1+Math.random()*1;g.animate([{transform:"translate(0, 0) scale(1)",opacity:1},{transform:`translate(${Math.cos(b)*k}px, ${Math.sin(b)*k}px) scale(0)`,opacity:0}],{duration:j*1e3,easing:"cubic-bezier(0.215, 0.61, 0.355, 1)",delay:Math.random()*500})}const d=setTimeout(()=>{o.forEach(m=>m.remove())},2500);return()=>{clearTimeout(d),o.forEach(m=>{m.parentElement&&m.remove()})}},[]),a.jsx("div",{ref:i,className:"absolute inset-0 pointer-events-none"})},kf=()=>({bg:"linear-gradient(135deg, #000000, #333333)",textClass:"text-white",borderClass:"border-gray-400"}),Sf=()=>({bg:"linear-gradient(135deg, #ffffff, #f5f5f5)",textClass:"text-gray-900",borderClass:"border-gray-800 dark:border-gray-700"}),Cf=({isOpen:i,onClose:f,onSave:x,cardToEdit:o})=>{const[d,m]=u.useState("front"),[g,b]=u.useState(""),[k,j]=u.useState(""),[S,p]=u.useState(!1),[T,y]=u.useState(!1),v=u.useRef(null),z=u.useRef(null);u.useEffect(()=>{if(i&&v.current&&!z.current){const w=new Quill(v.current,{theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{color:[]},{background:[]}],["clean"]]},placeholder:"Enter content..."});w.on("text-change",()=>{const N=w.root.innerHTML;d==="front"?b(N):j(N)}),z.current=w,y(!0)}return()=>{i||(z.current=null,y(!1))}},[i]),u.useEffect(()=>{if(i){const w=o?o.title:"",N=o?o.body:"";console.log("[FlashcardEditor] Loading content for edit:",o),console.log("[FlashcardEditor] Front content:",w.substring(0,100)+"..."),console.log("[FlashcardEditor] Back content:",N.substring(0,100)+"..."),b(w),j(N),m("front"),z.current&&(z.current.root.innerHTML=w)}else b(""),j(""),m("front")},[i,o]),u.useEffect(()=>{if(z.current&&i){const w=d==="front"?g:k;z.current.root.innerHTML!==w&&(z.current.root.innerHTML=w)}},[d,i,g,k]);const C=w=>{if(w===d||!z.current)return;const N=z.current.root.innerHTML;d==="front"?b(N):j(N),m(w)},E=async()=>{if(S)return;let w=g,N=k;if(z.current){const D=z.current.root.innerHTML;d==="front"?w=D:N=D}if(console.log("[FlashcardEditor] Save attempt:",{front:w.substring(0,100)+"...",back:N.substring(0,100)+"...",frontLength:w.length,backLength:N.length,isEditing:!!o}),!w.trim()||!N.trim()){alert("Both Front and Back sides must have content.");return}p(!0);try{await x({title:w,body:N}),console.log("[FlashcardEditor] Save successful")}catch(D){console.error("[FlashcardEditor] Save error:",D),alert("Failed to save flashcard: "+D.message)}finally{p(!1),U()}},U=()=>{b(""),j(""),m("front"),z.current&&(z.current.root.innerHTML=""),f()};return i?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:o?"Edit Flashcard":"Add New Flashcard"}),a.jsx("button",{onClick:U,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:a.jsx("span",{className:"text-2xl",children:""})})]}),a.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[a.jsx("button",{className:`flex-1 py-3 text-sm font-medium text-center transition-colors ${d==="front"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 border-t-2 border-blue-500":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>C("front"),children:"Front (Question)"}),a.jsx("button",{className:`flex-1 py-3 text-sm font-medium text-center transition-colors ${d==="back"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 border-t-2 border-blue-500":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>C("back"),children:"Back (Answer)"})]}),a.jsx("div",{className:"flex-1 flex flex-col p-4 overflow-hidden bg-white dark:bg-gray-800",children:a.jsx("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 flex-1 flex flex-col overflow-hidden text-gray-900 dark:text-gray-100",children:a.jsx("div",{ref:v,className:"flex-1 overflow-y-auto",style:{minHeight:"200px"}})})}),a.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex justify-end gap-3",children:[a.jsx("button",{onClick:U,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600",disabled:S,children:"Cancel"}),a.jsx("button",{onClick:E,className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-blue-400",disabled:S,children:S?"Saving...":"Save Card"})]})]})}):null},pb=({card:i,frontTheme:f,backTheme:x,isCurrent:o,onEdit:d,onDelete:m,isAdmin:g})=>{const[b,k]=u.useState(!1);u.useEffect(()=>{k(!1)},[i]);const j="w-full max-h-full overflow-y-auto prose prose-lg max-w-none text-center px-4 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent";return a.jsx("div",{className:"w-full h-full [perspective:1500px]",onClick:()=>k(!b),children:a.jsxs("div",{className:`relative w-full h-full transition-transform duration-700 [transform-style:preserve-3d] ${b?"[transform:rotateY(180deg)]":""} ease-in-out`,children:[a.jsxs("div",{className:`absolute w-full h-full rounded-2xl shadow-2xl flex flex-col items-center justify-center p-8 [backface-visibility:hidden] ${f.textClass} ${f.borderClass} border-2 cursor-pointer`,style:{background:f.bg},children:[a.jsx("div",{className:"text-5xl mb-6 opacity-80 shrink-0",children:""}),a.jsx("div",{className:j,style:{color:"inherit"},dangerouslySetInnerHTML:{__html:zt(i.title)}}),a.jsx("p",{className:"absolute bottom-6 text-xs uppercase tracking-widest opacity-60 animate-pulse shrink-0",children:"Tap to Flip"}),g&&o&&a.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 z-10",onClick:S=>S.stopPropagation(),children:[a.jsx("button",{onClick:S=>{S.stopPropagation(),d()},className:"p-2 rounded-full bg-white/30 hover:bg-white/50 backdrop-blur-md shadow-sm transition-all",title:"Edit Card",children:a.jsx(oa,{className:"w-5 h-5 text-current"})}),a.jsx("button",{onClick:S=>{S.stopPropagation(),m()},className:"p-2 rounded-full bg-white/30 hover:bg-white/50 backdrop-blur-md shadow-sm transition-all",title:"Delete Card",children:a.jsx(et,{className:"w-5 h-5 text-current"})})]})]}),a.jsxs("div",{className:`absolute w-full h-full rounded-2xl shadow-2xl flex flex-col items-center justify-center p-8 [transform:rotateY(180deg)] [backface-visibility:hidden] ${x.textClass} ${x.borderClass} border-2 cursor-pointer`,style:{background:x.bg},children:[a.jsx("div",{className:"text-5xl mb-6 opacity-80 shrink-0",children:""}),a.jsx("div",{className:j,style:{color:"inherit"},dangerouslySetInnerHTML:{__html:zt(i.body)}})]})]})})},vb=({onRetry:i})=>a.jsxs("div",{className:"absolute inset-0 bg-gray-900/80 backdrop-blur-sm z-20 flex flex-col items-center justify-center p-4 text-center",children:[a.jsx(Xf,{}),a.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:"Great Job!"}),a.jsx("p",{className:"text-lg text-gray-300 mb-8",children:"You've reviewed all the flashcards."}),a.jsx("button",{onClick:i,className:"px-8 py-3 bg-blue-600 text-white font-semibold rounded-full hover:bg-blue-700 transition-transform transform hover:scale-105 shadow-lg",children:"Start Over"})]}),jb=({lessonId:i,user:f})=>{const[x,o]=u.useState(0);u.useEffect(()=>{console.log("[FlashcardView] LessonId changed:",i)},[i]);const{data:d,isLoading:m}=Ce(()=>tt(i,["flashcard"]),[i,x]);u.useEffect(()=>{console.log("[FlashcardView] Grouped content response:",d),console.log("[FlashcardView] Response structure:",{hasResponse:!!d,length:d==null?void 0:d.length,firstGroup:d==null?void 0:d[0]})},[d]);const[g,b]=u.useState(0),[k,j]=u.useState(!1),[S,p]=u.useState(kf),[T,y]=u.useState(Sf),[v,z]=u.useState({isOpen:!1,content:null}),[C,E]=u.useState({isOpen:!1,onConfirm:null}),[U,w]=u.useState(!1),{showToast:N}=Xe(),D=u.useMemo(()=>{var q;return((q=d==null?void 0:d[0])==null?void 0:q.docs)||[]},[d]),_="flashcard",K=f.role==="admin"||!!f.canEdit;u.useEffect(()=>{console.log("[FlashcardView] Flashcards array:",D),console.log("[FlashcardView] Flashcards count:",D.length)},[D]),u.useEffect(()=>{b(0),j(!1),p(kf()),y(Sf())},[i]);const X=u.useCallback(()=>{g<D.length-1?b(q=>q+1):j(!0)},[g,D.length]),L=u.useCallback(()=>{j(!1),g>0&&b(q=>q-1)},[g]),M=q=>{b(q),j(!1)},B=()=>{b(0),j(!1)};u.useEffect(()=>{const q=J=>{J.key==="ArrowRight"&&X(),J.key==="ArrowLeft"&&L()};return window.addEventListener("keydown",q),()=>window.removeEventListener("keydown",q)},[X,L]);const I=async q=>{try{if(console.log("[FlashcardView] Saving flashcard content with lessonId:",i),console.log("[FlashcardView] Content data received:",{title:q.title.substring(0,100)+"...",body:q.body.substring(0,100)+"...",titleLength:q.title.length,bodyLength:q.body.length,isEditing:!!v.content}),!i)throw new Error("No lesson selected");if(!q.title.trim()||!q.body.trim())throw new Error("Both front and back content are required");if(v.content)console.log("[FlashcardView] Updating existing flashcard:",v.content._id),await $a(v.content._id,q),N("Card updated successfully!","success");else{const J={...q,lessonId:i,type:_};console.log("[FlashcardView] Creating new flashcard:",{...J,title:J.title.substring(0,100)+"...",body:J.body.substring(0,100)+"..."}),await Ut(J),N("Card created successfully!","success")}o(J=>J+1),z({isOpen:!1,content:null})}catch(J){throw console.error("[FlashcardView] Save error:",J),N(`Failed to save card: ${J.message}`,"error"),J}},G=q=>{E({isOpen:!0,onConfirm:async()=>{try{await Qt(q),o(le=>le+1),N("Card deleted.","error")}catch{N("Failed to delete card.","error")}E({isOpen:!1,onConfirm:null})}})},ee=async q=>{try{const J=q.map(le=>({...le,lessonId:i,type:_}));await Zg(J),o(le=>le+1),N(`${q.length} cards imported successfully!`,"success")}catch{N("Failed to import cards.","error")}w(!1)},V=D[g],O=D.length>0?(g+1)/D.length*100:0;return m?a.jsx("div",{className:"text-center py-10",children:"Loading flashcards..."}):D.length===0?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(jr,{className:"w-6 h-6 sm:w-8 sm:h-8 mr-2 sm:mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Flashcards"})]}),K&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>z({isOpen:!0,content:null}),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-sm transition-colors",title:"Add Card",children:[a.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Add New"})]}),a.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 shadow-sm transition-colors",title:"Import Cards",children:[a.jsx(lc,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Import"})]})]})]}),a.jsxs("div",{className:"flex-1 text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg flex flex-col justify-center items-center shadow-inner",children:[a.jsx(jr,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-4 text-gray-500",children:"No flashcards available for this chapter."})]}),a.jsx(Cf,{isOpen:v.isOpen,onClose:()=>z({isOpen:!1,content:null}),onSave:I,cardToEdit:v.content}),a.jsx(Nf,{isOpen:U,onClose:()=>w(!1),onImport:ee})]}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex flex-col h-full overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(jr,{className:"w-6 h-6 sm:w-8 sm:h-8 mr-2 sm:mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Flashcards"})]}),K&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>z({isOpen:!0,content:null}),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-sm transition-colors",title:"Add Card",children:[a.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Add New"})]}),a.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 shadow-sm transition-colors",title:"Import",children:[a.jsx(lc,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Import"})]})]})]}),a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative min-h-0 w-full pb-4",children:[a.jsx("div",{className:"w-full max-w-3xl flex-1 mb-6 relative z-10",children:a.jsx("div",{className:"absolute w-full h-full transition-all duration-500 ease-in-out",children:a.jsx(pb,{card:V,frontTheme:S,backTheme:T,isCurrent:!0,onEdit:()=>z({isOpen:!0,content:V}),onDelete:()=>G(V._id),isAdmin:K})})}),a.jsxs("div",{className:"w-full max-w-3xl flex flex-col items-center z-10",children:[a.jsxs("div",{className:"flex items-center justify-between w-full mb-3 px-2",children:[a.jsxs("button",{onClick:L,disabled:g===0,className:"px-4 py-2 sm:px-6 rounded-full bg-white dark:bg-gray-800 shadow-md text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[a.jsx(ux,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Previous"})]}),a.jsxs("span",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400",children:[g+1," / ",D.length]}),a.jsxs("button",{onClick:X,className:"px-4 py-2 sm:px-6 rounded-full bg-blue-600 text-white shadow-md hover:bg-blue-700 transition-colors flex items-center gap-2",children:[a.jsx("span",{className:"hidden sm:inline",children:g===D.length-1?"Finish":"Next"}),a.jsx(Ka,{className:"w-5 h-5"})]})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full cursor-pointer overflow-hidden",onClick:q=>{const J=q.currentTarget.getBoundingClientRect(),le=q.clientX-J.left,te=Math.floor(le/J.width*D.length);M(te)},children:a.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${O}%`}})})]}),k&&a.jsx(vb,{onRetry:B})]}),a.jsx(Cf,{isOpen:v.isOpen,onClose:()=>z({isOpen:!1,content:null}),onSave:I,cardToEdit:v.content}),a.jsx(Mt,{isOpen:C.isOpen,onClose:()=>E({isOpen:!1,onConfirm:null}),onConfirm:C.onConfirm,title:"Delete Flashcard",message:"Are you sure you want to delete this flashcard?"}),a.jsx(Nf,{isOpen:U,onClose:()=>w(!1),onImport:ee})]})},fc=class fc{constructor(){this.files=new Map,this.fileIdCounter=0}generateFileId(){return`file_${Date.now()}_${++this.fileIdCounter}`}async uploadFile(f,x,o,d,m){const g=this.generateFileId(),b=new FormData;b.append("file",f),b.append("lessonId",x),b.append("type",o),b.append("title",d),m&&b.append("metadata",JSON.stringify(m));try{const k=await fetch("/api/upload",{method:"POST",body:b});if(!k.ok){let p=k.statusText;try{const T=await k.json();T.message&&(p=T.message)}catch{}throw new Error(`Upload failed: ${p}`)}const j=await k.json(),S={id:g,name:f.name,type:f.type,size:f.size,path:j.fileInfo.path,uploadDate:new Date,apiResponse:j};return this.files.set(g,S),S}catch(k){throw console.error("File upload error:",k),k}}getFile(f){return this.files.get(f)}getFileUrl(f){var d,m;const x=this.files.get(f);if(!x)return null;const o=(m=(d=x.apiResponse)==null?void 0:d.fileInfo)==null?void 0:m.filename;return o?`/api/files/${o}`:null}getDownloadUrl(f){return this.getFileUrl(f)}async deleteFile(f){if(this.files.get(f))try{return(await fetch(`/api/content/${f}`,{method:"DELETE"})).ok?(this.files.delete(f),!0):(console.error("Failed to delete file via API"),!1)}catch(o){return console.error("File deletion error:",o),!1}return!1}getAllFiles(){return Array.from(this.files.values())}getFilesByPath(f){return Array.from(this.files.values()).filter(x=>x.path.includes(f))}static fastClean(f){if(!f)return"";let x="";for(let o=0;o<f.length;o++){const d=f[o];(d>="a"&&d<="z"||d>="A"&&d<="Z"||d>="0"&&d<="9"||d===" "||d==="/"||d==="."||d==="-")&&(x+=d)}return x}static generateFilePath(f,x,o){const d=this.folderMap[f]||"Files",m=this.fastClean(x),g=this.fastClean(o);return`${m}/${d}/${g}`}getStorageStats(){const f=Array.from(this.files.values()),x=f.reduce((d,m)=>d+m.size,0),o={};return f.forEach(d=>{const m=d.type;o[m]||(o[m]={count:0,size:0}),o[m].count++,o[m].size+=d.size}),{totalFiles:f.length,totalSize:x,byType:o}}};fc.folderMap={worksheet:"Worksheets",book:"Books",video:"Videos",audio:"Audios",questionPaper:"QuestionPapers",notes:"Notes",flashcard:"Flashcards",qa:"QAPapers",activity:"Activities",quiz:"Quizzes"};let ic=fc;const Ws=new ic,oc={async uploadFile(i,f,x,o,d){var p,T;const m=new FormData;m.append("file",i),m.append("lessonId",f),m.append("type",x),m.append("title",o),d&&m.append("metadata",JSON.stringify(d));const g=await fetch("/api/upload",{method:"POST",body:m});if(!g.ok){let y=g.statusText;try{const v=await g.json();v.message&&(y=v.message)}catch{}throw new Error(`Upload failed: ${y}`)}const b=await g.json(),k=(p=b.content)==null?void 0:p._id;if(!k)throw new Error("Upload response missing content ID");const j=`content_${k}`,S={id:j,name:i.name,type:i.type,size:i.size,path:((T=b.fileInfo)==null?void 0:T.path)||"",uploadDate:new Date,apiResponse:b};return Ws.files.set(j,S),{fileId:j,path:S.path,apiResponse:b}},getFileUrl(i){var f,x;try{if(console.log(" Getting file URL for:",i),i.startsWith("content_")){const g=`/api/content/${i.replace("content_","")}/file`;return console.log(" Content ID format URL:",g),g}if(i.match(/^[0-9a-fA-F]{24}$/)){const m=`/api/content/${i}/file`;return console.log(" MongoDB ObjectId format URL:",m),m}const o=Ws.getFile(i);if(!o)return console.warn(" File not found in storage:",i),null;const d=(x=(f=o.apiResponse)==null?void 0:f.fileInfo)==null?void 0:x.filename;if(d){const m=`/api/files/${d}`;return console.log(" Legacy format URL:",m),m}return console.warn(" No filename found for file:",i),null}catch(o){return console.error(" Error getting file URL:",o),null}},getDownloadUrl(i){return this.getFileUrl(i)},async deleteFile(i){try{if(i.startsWith("content_")){const f=i.replace("content_","");return(await fetch(`/api/content/${f}`,{method:"DELETE"})).ok}return i.match(/^[0-9a-fA-F]{24}$/)?(await fetch(`/api/content/${i}`,{method:"DELETE"})).ok:await Ws.deleteFile(i)}catch(f){return console.error("File deletion error:",f),!1}},fileExists(i){return i.startsWith("content_")?!0:Ws.getFile(i)!==void 0},getFileInfoByContentId(i){const f=`content_${i}`;return Ws.getFile(f)}},wb=({isOpen:i,onClose:f,onSave:x,contentToEdit:o,resourceLabel:d,resourceType:m})=>{const[g,b]=u.useState("title"),[k,j]=u.useState(""),[S,p]=u.useState(""),[T,y]=u.useState(!1),[v,z]=u.useState(!1),C=u.useRef(null),E=u.useRef(null),U=m==="activity"||m==="extra",w=U?"Question":"Title",N=U?"Answer":"Content";u.useEffect(()=>{var I;if(!i)return;console.log("[GenericEditor] Initializing for edit:",o?"existing content":"new content"),console.log("[GenericEditor] Full contentToEdit object:",o),console.log("[GenericEditor] Title content:",o!=null&&o.title?o.title.substring(0,100)+"...":"(empty/null)"),console.log("[GenericEditor] Body content:",o!=null&&o.body?o.body.substring(0,100)+"...":"(empty/null)"),console.log("[GenericEditor] Body content length:",((I=o==null?void 0:o.body)==null?void 0:I.length)||0),console.log("[GenericEditor] Body content type:",typeof(o==null?void 0:o.body)),console.log("[GenericEditor] Body content exists:",!!(o!=null&&o.body)),z(!1),b("title");const X=o?o.title:"",L=o?o.body:"";let M="",B="";if(U?(M=X,B=L,X&&L&&X.length>0&&L.length>0&&X.trim()===L.trim()&&console.warn("[GenericEditor] WARNING: Question and Answer content are identical!")):(M=X,B=L),console.log("[GenericEditor] Content mapping for activity:",U),console.log("[GenericEditor] Raw titleContent:",X?X.substring(0,100)+"...":"(empty)"),console.log("[GenericEditor] Raw bodyContent:",L?L.substring(0,100)+"...":"(empty)"),console.log("[GenericEditor] Mapped Question content:",M?M.substring(0,100)+"...":"(empty)"),console.log("[GenericEditor] Mapped Answer content:",B?B.substring(0,100)+"...":"(empty)"),console.log("[GenericEditor] Setting titleHtml (Question) state, length:",M.length),console.log("[GenericEditor] Setting bodyHtml (Answer) state, length:",B.length),j(M),p(B),console.log("[GenericEditor] States set. Question:",M.length,"Answer:",B.length),C.current&&!E.current){console.log("[GenericEditor] Initializing Quill editor");const G=new Quill(C.current,{theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{color:[]},{background:[]}],["image","video","formula"],["clean"]]},placeholder:"Enter content..."}),ee=g==="title"?M:B;console.log("[GenericEditor] Setting initial content for",g,":",ee?ee.substring(0,100)+"...":"(empty)"),console.log("[GenericEditor] Question content available:",!!M,"Answer content available:",!!B),G.root.innerHTML=ee||"",E.current=G,z(!0),console.log("[GenericEditor] Editor initialized successfully"),setTimeout(()=>{if(E.current&&i){const V=g==="title"?M:B;E.current.root.innerHTML!==V&&(console.log("[GenericEditor] Correcting initial content load"),E.current.root.innerHTML=V||"")}},100)}},[i,o]),u.useEffect(()=>()=>{i||(console.log("[GenericEditor] Cleaning up editor"),E.current=null,z(!1))},[i]),u.useEffect(()=>{if(E.current&&v&&i){const X=g==="title"?k:S,L=E.current.root.innerHTML;console.log("[GenericEditor] Tab changed to",g),console.log("[GenericEditor] Content to load:",X?X.substring(0,100)+"...":"(empty)"),console.log("[GenericEditor] Current content:",L?L.substring(0,100)+"...":"(empty)"),console.log("[GenericEditor] BodyHtml state:",S?S.substring(0,100)+"...":"(empty)"),L!==X&&(console.log("[GenericEditor] Loading content into Quill editor"),E.current.root.innerHTML=X||"")}},[g,v,k,S,i]),u.useEffect(()=>{if(E.current&&v&&i&&(g==="title"||g==="content")){const X=g==="title"?k:S;X&&E.current.root.innerHTML!==X&&(console.log("[GenericEditor] Ensuring content is loaded for tab:",g),E.current.root.innerHTML=X)}},[v,g,k,S,i]);const D=X=>{if(X===g||!E.current||!v)return;console.log("[GenericEditor] Switching from",g,"to",X);const L=E.current.root.innerHTML;console.log("[GenericEditor] Saving current content before switch:",L.substring(0,100)+"..."),g==="title"?(j(L),console.log("[GenericEditor] Saved title content")):(p(L),console.log("[GenericEditor] Saved body content")),b(X),console.log("[GenericEditor] Tab switched to:",X),setTimeout(()=>{if(E.current){let M="",B="";X==="title"?(M=k,B="Question",console.log("[GenericEditor] Force loading",B,"content, length:",M.length)):(M=S,B="Answer",console.log("[GenericEditor] Force loading",B,"content, length:",M.length),console.log("[GenericEditor] Answer content preview:",M.substring(0,100)+"...")),E.current.root.innerHTML=M,console.log("[GenericEditor]",B,"content set in editor, current length:",E.current.root.innerHTML.length)}},50)},_=async()=>{if(T)return;let X=k,L=S;if(E.current){const M=E.current.root.innerHTML;g==="title"?X=M:L=M}if(!X.trim()||!L.trim()){alert(`Both ${w} and ${N} are required.`);return}y(!0),await x({title:X,body:L}),j(""),p(""),E.current&&(E.current.root.innerHTML=""),y(!1)},K=()=>{j(""),p(""),f()};return i?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl flex flex-col max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:o?`Edit ${d}`:`Add New ${d}`}),a.jsx("button",{onClick:K,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:a.jsx("span",{className:"text-2xl",children:""})})]}),a.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[a.jsx("button",{className:`flex-1 py-3 text-sm font-medium text-center transition-colors ${g==="title"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 border-t-2 border-blue-500":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>D("title"),children:w}),a.jsx("button",{className:`flex-1 py-3 text-sm font-medium text-center transition-colors ${g==="content"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 border-t-2 border-blue-500":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>D("content"),children:N})]}),a.jsx("div",{className:"flex-1 flex flex-col p-4 overflow-hidden bg-white dark:bg-gray-800",children:a.jsx("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 flex-1 flex flex-col overflow-hidden text-gray-900 dark:text-gray-100",children:a.jsx("div",{ref:C,className:"flex-1 overflow-y-auto",style:{minHeight:"200px"}})})}),a.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex justify-end gap-3",children:[a.jsx("button",{onClick:K,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600",disabled:T,children:"Cancel"}),a.jsx("button",{onClick:_,className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-blue-400",disabled:T,children:T?"Saving...":`Save ${d}`})]})]})}):null},Nb=({item:i,onEdit:f,onDelete:x,isAdmin:o,onExpandPdf:d})=>{var T;const[m,g]=u.useState(!1),b=i.type==="worksheet"&&((T=i.metadata)==null?void 0:T.fileId),{session:k}=Rt(),j={fontSize:`${k.fontSize}px`},p=b?(()=>{var y;try{if((y=i.metadata)!=null&&y.fileId){const v=oc.getFileUrl(i.metadata.fileId);if(v)return console.log("Generated PDF URL for worksheet:",v),v}if(i.body&&i.body.startsWith("data:application/pdf"))return console.log("Using base64 PDF data"),i.body;if(i.filePath){const C=`/api/files/${require("path").basename(i.filePath)}`;return console.log("Generated PDF URL from filePath:",C),C}return console.warn("No valid PDF URL found for item:",i._id,i.metadata),null}catch(v){return console.error("Error generating PDF URL:",v),null}})():null;return b?a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden cursor-pointer hover:shadow-lg transition-shadow border border-gray-200 dark:border-gray-700 flex flex-col h-64 sm:h-80 hover:scale-[1.02] transition-transform",onClick:()=>d&&d(p||""),children:[a.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-gray-900 flex items-center justify-center overflow-hidden relative",children:[p?a.jsx("div",{className:"w-full h-full pointer-events-none",children:a.jsx(hl,{url:p,initialScale:.4})}):a.jsxs("div",{className:"text-center p-3 sm:p-4",children:[a.jsx("div",{className:"text-red-400 text-xs sm:text-sm mb-2",children:"Failed to load PDF"}),a.jsx("div",{className:"text-xs text-gray-500",children:"Click to retry or delete"})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/0 hover:bg-black/10 transition-colors"})]}),a.jsxs("div",{className:"p-2 sm:p-3 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center bg-white dark:bg-gray-800 shrink-0",children:[a.jsx("h3",{className:"font-medium text-sm text-gray-800 dark:text-white truncate flex-1 pr-2",title:i.title,children:i.title}),o&&a.jsx("div",{className:"flex items-center gap-1 shrink-0",onClick:y=>y.stopPropagation(),children:a.jsxs("button",{onClick:()=>x(i._id),className:"p-1.5 rounded-full hover:bg-red-50 dark:hover:bg-red-900/30 text-gray-400 hover:text-red-500 transition-colors",title:"Delete",children:[a.jsx(et,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline ml-1 text-xs",children:"Delete"})]})})]})]}):a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden mb-3 sm:mb-4",children:[a.jsxs("div",{className:"w-full text-left p-3 sm:p-4 flex justify-between items-center group cursor-pointer",onClick:()=>g(!m),children:[a.jsx("div",{className:"flex-1 pr-4",children:a.jsx("div",{className:"font-semibold text-gray-800 dark:text-white prose prose-sm dark:prose-invert max-w-none",style:j,dangerouslySetInnerHTML:{__html:zt(i.title)}})}),a.jsxs("div",{className:"flex items-center shrink-0",children:[o&&a.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity mr-2 sm:mr-4",onClick:y=>y.stopPropagation(),children:[a.jsxs("button",{onClick:()=>f(i),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",title:"Edit",children:[a.jsx(oa,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"}),a.jsx("span",{className:"hidden sm:inline sm:ml-2 text-xs",children:"Edit"})]}),a.jsxs("button",{onClick:()=>x(i._id),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",title:"Delete",children:[a.jsx(et,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"}),a.jsx("span",{className:"hidden sm:inline sm:ml-2 text-xs",children:"Delete"})]})]}),a.jsx(Ka,{className:`w-5 h-5 text-gray-400 transition-transform ${m?"rotate-90":""}`})]})]}),m&&a.jsx("div",{className:"p-3 sm:p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:a.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none text-gray-600 dark:text-gray-400",style:j,dangerouslySetInnerHTML:{__html:zt(i.body)}})})]})},kb=({onSave:i,onCancel:f,lessonId:x})=>{const[o,d]=u.useState("Loading title..."),[m,g]=u.useState(null),[b,k]=u.useState(!1),[j,S]=u.useState(null),[p,T]=u.useState(""),{showToast:y}=Xe();u.useEffect(()=>{x?(async()=>{try{console.log("=== FAST PATH GENERATION START ===");const E=await Wa(x);if(E&&E.trim()){const _=E.split(" > ").filter(K=>K.trim());if(_.length>=2){const K=_[_.length-1],L=`${_.join("/")}/Worksheet/${K}.pdf`;console.log("Fast path from breadcrumbs:",L),d(K),T(L);return}}console.log("Breadcrumbs failed, trying fast search...");let U=!1,w=[],N="New Worksheet";const D=await cl();for(const _ of D){const K=await dl(_._id);for(const X of K){const L=await ul(X._id),M=L.find(B=>B._id===x);if(M){w=[_.name,X.name,M.name],N=M.name,U=!0;break}for(const B of L){const I=await fl(B._id),G=I.find(ee=>ee._id===x);if(G){w=[_.name,X.name,B.name,G.name],N=G.name,U=!0;break}if(!U)for(const ee of I){const O=(await ml(ee._id)).find(q=>q._id===x);if(O){w=[_.name,X.name,B.name,ee.name,O.name],N=O.name,U=!0;break}}}if(U)break}if(U)break}if(U&&w.length>0){const K=`${w.join("/")}/Worksheet/${N}.pdf`;console.log("Fast path from search:",K),d(N),T(K)}else{console.log("Quick fallback for:",x);const _=`Worksheet_${x.slice(-4)}`,K=`Class/Worksheet/${_}.pdf`;d(_),T(K)}}catch(E){console.error("Fast path generation error:",E),d("New Worksheet"),T("Default/Worksheet/New Worksheet.pdf")}})():(d("Select a lesson/unit first"),T("Worksheets/Pending Selection"))},[x]),u.useEffect(()=>()=>{j&&URL.revokeObjectURL(j)},[j]);const v=C=>{var U;const E=(U=C.target.files)==null?void 0:U[0];if(E&&E.type==="application/pdf"){g(E);const w=URL.createObjectURL(E);S(w)}else E&&y("Please select a valid PDF file.","error")},z=async C=>{if(C.preventDefault(),!(!m||!o||b)){k(!0);try{const E=await oc.uploadFile(m,x,"worksheet",o,{folderPath:p,fileName:m.name}),U={title:o,body:oc.getFileUrl(E.fileId)||"",metadata:{fileId:E.fileId,filePath:E.path,fileName:m.name,fileSize:m.size,uploadDate:new Date().toISOString()}};await i(U),y("Worksheet saved successfully!","success")}catch(E){console.error("Save failed",E),y("Failed to save worksheet.","error")}finally{k(!1)}}};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800 dark:text-white",children:"Upload Worksheet (PDF)"}),a.jsxs("form",{onSubmit:z,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Title"}),a.jsx("input",{type:"text",value:o,onChange:C=>d(C.target.value),className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 text-gray-900 dark:text-gray-100",required:!0}),a.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 font-mono truncate",title:p,children:["Virtual Path: ",p]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"PDF File"}),a.jsx("div",{className:"mt-1 flex items-center justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Pa,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("div",{className:"flex text-sm text-gray-600 dark:text-gray-400 justify-center",children:a.jsxs("label",{htmlFor:"worksheet-upload",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[a.jsx("span",{children:"Upload a file"}),a.jsx("input",{id:"worksheet-upload",name:"worksheet-upload",type:"file",className:"sr-only",onChange:v,accept:".pdf"})]})}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:m?m.name:"PDF up to 10MB"})]})})]}),j&&a.jsx("div",{className:"h-64 border rounded overflow-hidden",children:a.jsx(hl,{url:j,initialScale:.6})}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-200",disabled:b,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md disabled:bg-blue-400",disabled:b||!m,children:b?"Uploading...":"Save Worksheet"})]})]})]})},Sb=({lessonId:i,user:f,resourceType:x})=>{var K;const[o,d]=u.useState(0),{data:m,isLoading:g}=Ce(()=>tt(i,[x]),[i,o,x]),[b,k]=u.useState({isOpen:!1,content:null}),[j,S]=u.useState({isOpen:!1,onConfirm:null}),[p,T]=u.useState(!1),[y,v]=u.useState(null),{showToast:z}=Xe(),C=((K=m==null?void 0:m[0])==null?void 0:K.docs)||[],E=dc.find(X=>X.key===x)||{key:x,label:x,Icon:()=>null},U=f.role==="admin"||!!f.canEdit,w=x==="worksheet",N=async X=>{try{if(b.content){const L={...X};b.content.metadata&&b.content.metadata.fileId&&(L.metadata=b.content.metadata),await $a(b.content._id,L)}else w&&X.metadata?await Ut({title:X.title,body:X.body||"",metadata:X.metadata,lessonId:i,type:x}):await Ut({...X,lessonId:i,type:x});d(L=>L+1),z(`${E.label} saved successfully!`,"success")}catch{z("Failed to save content.","error")}k({isOpen:!1,content:null}),T(!1)},D=X=>{S({isOpen:!0,onConfirm:async()=>{try{await Qt(X),d(M=>M+1),z(`${E.label} deleted.`,"error")}catch{z("Failed to delete content.","error")}S({isOpen:!1,onConfirm:null})}})},_=()=>{w?T(!0):k({isOpen:!0,content:null})};return a.jsxs("div",{className:"p-2 sm:p-4 lg:p-6 xl:p-8 h-full flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(E.Icon,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:E.label})]}),a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[!w&&a.jsx(uc,{}),U&&!p&&a.jsxs("button",{onClick:_,className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:`Add New ${E.label}`,children:[a.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Add New"})]})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[g&&a.jsx("div",{className:"text-center py-10",children:"Loading content..."}),p&&a.jsx(kb,{onSave:N,onCancel:()=>T(!1),lessonId:i}),!g&&!p&&C.length>0&&a.jsx("div",{className:w?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-6 lg:gap-8 pb-6":"space-y-3 sm:space-y-4 pb-6",children:C.map(X=>{var L,M,B;return console.log("[GenericContentView] Content item:",{id:X._id,title:((L=X.title)==null?void 0:L.substring(0,50))+"...",body:((M=X.body)==null?void 0:M.substring(0,50))+"...",bodyLength:((B=X.body)==null?void 0:B.length)||0,type:X.type}),a.jsx(Nb,{item:X,onEdit:I=>{var G,ee,V;console.log("[GenericContentView] Edit clicked for item:",{id:I._id,title:((G=I.title)==null?void 0:G.substring(0,50))+"...",body:((ee=I.body)==null?void 0:ee.substring(0,50))+"...",bodyLength:((V=I.body)==null?void 0:V.length)||0}),k({isOpen:!0,content:I})},onDelete:D,isAdmin:U,onExpandPdf:v},X._id)})}),!g&&!p&&C.length===0&&a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(E.Icon,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsxs("p",{className:"mt-4 text-gray-500",children:["No ",E.label.toLowerCase()," available for this chapter."]})]})]}),a.jsx(wb,{isOpen:b.isOpen,onClose:()=>k({isOpen:!1,content:null}),onSave:N,contentToEdit:b.content,resourceLabel:E.label,resourceType:x}),a.jsx(Mt,{isOpen:j.isOpen,onClose:()=>S({isOpen:!1,onConfirm:null}),onConfirm:j.onConfirm,title:`Delete ${E.label}`,message:`Are you sure you want to delete this ${E.label.toLowerCase()}?`}),y&&a.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex flex-col animate-fade-in h-screen w-screen",children:[a.jsx("div",{className:"flex justify-end p-2 bg-black/50 absolute top-0 right-0 z-50 rounded-bl-lg",children:a.jsx("button",{onClick:()=>v(null),className:"p-2 rounded-full bg-white/20 hover:bg-white/40 text-white transition-colors","aria-label":"Close fullscreen PDF viewer",children:a.jsx(ia,{className:"w-6 h-6"})})}),a.jsx("div",{className:"w-full h-full",children:a.jsx(hl,{url:y,initialScale:2.5})})]})]})},Ps=i=>{if(!i)return null;const f=i.trim();if(!f.startsWith("http://")&&!f.startsWith("https://"))return null;if(f.includes("youtube.com/embed/"))return f;try{const x=new URL(f),o=x.hostname.replace(/^www\./,"");let d=null;return o==="youtu.be"?(d=x.pathname.split("/")[1]||null,d&&(d=d.split("?")[0].split("/")[0])):o.includes("youtube.com")&&(x.pathname==="/watch"?d=x.searchParams.get("v"):(x.pathname.startsWith("/shorts/")||x.pathname.startsWith("/embed/")||x.pathname.startsWith("/v/"))&&(d=x.pathname.split("/")[2]||null)),d?(d=d.replace(/[^a-zA-Z0-9_-]/g,""),`https://www.youtube.com/embed/${d}?rel=0`):null}catch{return null}},Cb=({content:i,onRemove:f,isAdmin:x})=>{const[o,d]=u.useState(null),[m,g]=u.useState(!0),[b,k]=u.useState(""),j=()=>{var z,C,E,U;console.log("[VideoView] Getting video source for content:",{id:i._id,type:i.type,title:i.title,hasFilePath:!!i.filePath,filePath:i.filePath,hasBody:!!i.body,bodyLength:((z=i.body)==null?void 0:z.length)||0,bodyPreview:((C=i.body)==null?void 0:C.substring(0,100))+(((E=i.body)==null?void 0:E.length)>100?"...":""),bodyStartsWith:(U=i.body)==null?void 0:U.substring(0,50)});const y=(i.body||"").trim(),v=Ps(y);if(v)return console.log("[VideoView] YouTube video detected:",v),v;if(i.filePath&&i.filePath.trim()!==""){const w=`/api/content/${i._id}/file`;return console.log("[VideoView] Using uploaded file:",w),w}if(y&&y!==""){if(y.startsWith("http://")||y.startsWith("https://"))return console.log("[VideoView] Using external URL:",y),y;if(y.startsWith("data:video/"))return console.log("[VideoView] Using base64 video data"),y;try{const w=JSON.parse(y);if(w&&typeof w=="object")return console.log("[VideoView] Body contains JSON metadata, not using as video source:",w),""}catch{console.log("[VideoView] Body is not JSON, checking if it might be a direct URL")}}return console.warn("[VideoView] No valid video source found for content:",i._id),""};u.useEffect(()=>{const y=j();k(y);const v=y&&y.includes("youtube.com/embed/");g(v?!1:!!y),d(null)},[i]);const S=()=>{console.log("[VideoView] Video loading started"),g(!0),d(null)},p=()=>{console.log("[VideoView] Video can play"),g(!1),d(null)},T=y=>{const v=y.currentTarget.error,z=y.currentTarget;let C="Unknown video error";if(console.error("[VideoView] Video playback error details:",{error:v,src:b,currentSrc:z.currentSrc,networkState:z.networkState,readyState:z.readyState,duration:z.duration,errorCode:v==null?void 0:v.code,errorMessage:v==null?void 0:v.message}),v)switch(v.code){case MediaError.MEDIA_ERR_ABORTED:C="Video loading was aborted";break;case MediaError.MEDIA_ERR_NETWORK:C="Network error while loading video. Please check your internet connection.";break;case MediaError.MEDIA_ERR_DECODE:C="Video file is corrupted or unsupported format. Please try converting to MP4 or WebM.";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:C="Video format not supported or file not found. Supported formats: MP4, WebM, OGV, AVI, MOV.";break;default:C=`Video error: ${v.message}`}b.includes("/api/content/")&&!b.endsWith("/file")&&(C+=" (Invalid API endpoint format)"),console.error("[VideoView] Final error message:",C),g(!1),d(C)};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 relative w-full",children:[x&&a.jsx("div",{className:"absolute top-4 right-4 z-10",children:a.jsx("button",{onClick:f,className:"p-2 rounded-full bg-white/50 dark:bg-black/50 hover:bg-white/80 dark:hover:bg-black/80 backdrop-blur-sm shadow-md",title:"Remove Video",children:a.jsx(et,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})}),a.jsx("h2",{className:"text-xl font-semibold mb-4 pr-12 truncate",children:i.title}),a.jsxs("div",{className:"w-full",children:[m&&a.jsxs("div",{className:"flex items-center justify-center py-4",children:[a.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mr-2"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading video..."})]}),b&&b.includes("youtube.com/embed/")&&a.jsx("div",{className:"aspect-video w-full bg-black rounded-lg overflow-hidden",children:a.jsx("iframe",{src:b,className:"w-full h-full",title:i.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,onError:()=>d(!0)},b)}),b&&!b.includes("youtube.com/embed/")&&a.jsx("div",{className:"aspect-video w-full bg-black rounded-lg overflow-hidden",children:a.jsx("video",{controls:!0,className:"w-full h-full",src:b,onLoadStart:S,onCanPlay:p,onError:T,style:{display:m?"none":"block"},children:"Your browser does not support the video element."})}),o&&a.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Video Playback Error"}),a.jsxs("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:[a.jsx("p",{children:o}),a.jsxs("p",{className:"mt-1 text-xs",children:[a.jsx("strong",{children:"Debug Info:"})," Source: ",b||"None"," | File Path: ",i.filePath||"None"]})]}),a.jsx("div",{className:"mt-3",children:a.jsx("button",{onClick:()=>{d(null),g(!0);const y=j();k(y)},className:"text-xs bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 px-2 py-1 rounded hover:bg-red-200 dark:hover:bg-red-700",children:"Retry"})})]})]})}),!b&&!o&&!m&&a.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"No Video Source"}),a.jsxs("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:[a.jsx("p",{children:"No valid video source found for this content."}),a.jsxs("p",{className:"mt-1 text-xs",children:[a.jsx("strong",{children:"Content Info:"})," ID: ",i._id," | Type: ",i.type," | File Path: ",i.filePath||"None"]})]})]})]})})]})]})},Eb=({lessonId:i,onAdd:f,onCancel:x})=>{const[o,d]=u.useState("upload"),[m,g]=u.useState("Loading title..."),[b,k]=u.useState(""),[j,S]=u.useState(""),[p,T]=u.useState(!1),[y,v]=u.useState(null),[z,C]=u.useState(null),[E,U]=u.useState(null),[w,N]=u.useState(""),{showToast:D}=Xe(),_=async L=>{var M;try{console.log("[VIDEO DEBUG] generateUniqueTitle called with:",{baseTitle:L,lessonId:i});const B=await tt(i,["video"]),I=((M=B==null?void 0:B[0])==null?void 0:M.docs)||[];console.log("[VIDEO DEBUG] Existing videos found:",I.length);const G=I.map(O=>O.title.replace(/\s*\(\d+\)\s*$/,"").trim());if(console.log("[VIDEO DEBUG] Existing titles:",G),!G.includes(L))return console.log("[VIDEO DEBUG] No duplicate found, using baseTitle as both display and filename"),{displayTitle:L,fileName:L};let ee=2,V=`${L} (${ee})`;for(;G.includes(V);)ee++,V=`${L} (${ee})`;return console.log("[VIDEO DEBUG] Duplicate found, using:",{displayTitle:V,fileName:L}),{displayTitle:V,fileName:L}}catch(B){return console.error("[VIDEO DEBUG] Error generating unique title:",B),{displayTitle:L,fileName:L}}};u.useEffect(()=>{i?(async()=>{try{console.log("=== FAST VIDEO PATH GENERATION START ===");const M=await Wa(i);if(M&&M.trim()){const V=M.split(" > ").filter(O=>O.trim());if(V.length>=2){const O=V[V.length-1],q=V.join("/"),{displayTitle:J,fileName:le}=await _(O),te=`${q}/Video/${le}.mp4`;console.log("Fast video path from breadcrumbs:",te),g(J),S(le),k(te);return}}console.log("Breadcrumbs failed, trying fast search...");let B=!1,I=[],G="New Video";const ee=await cl();for(const V of ee){const O=await dl(V._id);for(const q of O){const J=await ul(q._id),le=J.find(te=>te._id===i);if(le){I=[V.name,q.name,le.name],G=le.name,B=!0;break}for(const te of J){const ne=await fl(te._id),se=ne.find(re=>re._id===i);if(se){I=[V.name,q.name,te.name,se.name],G=se.name,B=!0;break}if(!B)for(const re of ne){const ae=(await ml(re._id)).find(pe=>pe._id===i);if(ae){I=[V.name,q.name,te.name,re.name,ae.name],G=ae.name,B=!0;break}}}if(B)break}if(B)break}if(B&&I.length>0){const V=I.join("/"),{displayTitle:O,fileName:q}=await _(G),J=`${V}/Video/${q}.mp4`;console.log("Fast video path from search:",J),g(O),S(q),k(J)}else{console.log("Quick video fallback for:",i);const V=`Video_${i.slice(-4)}`,{displayTitle:O,fileName:q}=await _(V),J=`Class/Video/${q}.mp4`;g(O),S(q),k(J)}}catch(M){console.error("Fast video path generation error:",M);const B="New Video";g(B),S(B),k(`Default/Video/${B}.mp4`)}})():(g("Select a lesson/unit first"),S("Video"),k("Video/Pending Selection"))},[i]),u.useEffect(()=>()=>{E&&E.startsWith("blob:")&&URL.revokeObjectURL(E)},[E]);const K=L=>{var B;const M=(B=L.target.files)==null?void 0:B[0];if(M&&M.type.startsWith("video/")){C(M),v(null);const I=URL.createObjectURL(M);U(I)}else D("Please select a valid video file.","error"),C(null),U(null)},X=async L=>{if(L.preventDefault(),p||!m.trim()){v("Please provide a title.");return}T(!0),v(null);try{if(o==="upload"){if(!z){v("Please select a file to upload.");return}const M=new FormData;M.append("file",z),M.append("lessonId",i),M.append("type","video"),M.append("title",m.trim()),M.append("customFileName",j||m.trim());const B=await fetch("/api/upload",{method:"POST",body:M});if(!B.ok){const G=await B.json().catch(()=>({}));throw new Error(G.message||`Upload failed: ${B.statusText}`)}const I=await B.json();console.log("Video uploaded successfully:",I)}else{if(!Ps(w)){v("Please enter a valid YouTube URL."),D("Invalid YouTube URL","error");return}await Ut({title:m.trim(),body:w,lessonId:i,type:"video",metadata:{category:"External",subCategory:"External Link",videoUrl:w}})}D("Video added successfully","success"),f()}catch(M){console.error("Video upload error:",M),v(M instanceof Error?M.message:"Failed to save video. Please try again."),D("Failed to save video","error")}finally{T(!1)}};return a.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-white dark:bg-gray-800/50 p-8 rounded-lg shadow-md mt-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-center mb-6 text-gray-800 dark:text-white",children:"Add New Video"}),a.jsxs("div",{className:"mb-6 flex border-b border-gray-200 dark:border-gray-700",children:[a.jsx("button",{onClick:()=>d("upload"),className:`px-4 py-2 text-sm font-medium ${o==="upload"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Upload File"}),a.jsx("button",{onClick:()=>d("url"),className:`px-4 py-2 text-sm font-medium ${o==="url"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Add from URL"})]}),a.jsxs("form",{onSubmit:X,className:"grid md:grid-cols-2 gap-8 items-start",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"videoTitle",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Video Title"}),a.jsx("input",{id:"videoTitle",type:"text",value:m,onChange:L=>g(L.target.value),required:!0,className:"mt-1 w-full px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 font-mono truncate",title:b,children:["Path: ",b]})]}),o==="upload"&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"videoFile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Video File"}),a.jsx("div",{className:"mt-1 flex items-center justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Pa,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:a.jsxs("label",{htmlFor:"videoFile",className:"relative cursor-pointer bg-transparent rounded-md font-medium text-blue-600 hover:text-blue-500",children:[a.jsx("span",{children:z?"Change file":"Upload a file"}),a.jsx("input",{id:"videoFile",name:"videoFile",type:"file",className:"sr-only",onChange:K,accept:"video/*"})]})}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:z?z.name:"MP4, WebM, etc."})]})})]}),o==="url"&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"videoUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"YouTube URL"}),a.jsx("input",{id:"videoUrl",type:"url",value:w,onChange:L=>N(L.target.value),required:!0,placeholder:"https://www.youtube.com/watch?v=... or https://youtu.be/...",className:"mt-1 w-full px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),y&&a.jsx("p",{className:"text-sm text-red-500 dark:text-red-400",children:y}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"button",onClick:x,className:"px-3 py-2 sm:px-4 bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors disabled:opacity-50",disabled:p,children:[a.jsx("span",{className:"hidden sm:inline",children:"Cancel"}),a.jsx("span",{className:"sm:hidden",children:""})]}),a.jsx("button",{type:"submit",disabled:p,className:"px-3 py-2 sm:px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors",children:p?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin sm:mr-2 inline-block align-middle"}),a.jsx("span",{className:"hidden sm:inline",children:"Saving..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:"Save Video"}),a.jsx("span",{className:"sm:hidden",children:""})]})})]})]}),a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Preview"}),a.jsxs("div",{className:"aspect-video w-full bg-black rounded-lg border dark:border-gray-600 overflow-hidden shadow-inner",children:[o==="upload"&&E&&a.jsx("video",{src:E,controls:!0,className:"w-full h-full"}),o==="url"&&w&&Ps(w)&&a.jsx("iframe",{src:Ps(w)||"",className:"w-full h-full",title:"YouTube Preview",allowFullScreen:!0}),(o==="upload"&&!E||o==="url"&&!w||!Ps(w))&&a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500 dark:text-gray-400",children:[a.jsx(Sr,{className:"w-12 h-12 mb-2"}),a.jsx("p",{children:"Video preview will appear here"})]})]})]})]})]})},Ab=({lessonId:i,user:f})=>{var z;const[x,o]=u.useState(0),{data:d,isLoading:m}=Ce(()=>tt(i,["video"]),[i,x]),[g,b]=u.useState({isOpen:!1,onConfirm:null}),[k,j]=u.useState(!1),{showToast:S}=Xe(),p=((z=d==null?void 0:d[0])==null?void 0:z.docs)||[],T=f.role==="admin"||!!f.canEdit,y=C=>{b({isOpen:!0,onConfirm:async()=>{try{await Qt(C),o(U=>U+1),S("Video deleted successfully","success")}catch{S("Failed to delete video","error")}b({isOpen:!1,onConfirm:null})}})},v=()=>{o(C=>C+1),j(!1)};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Sr,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Video"})]}),T&&!k&&a.jsxs("button",{onClick:()=>j(!0),className:"flex items-center justify-center p-2.5 w-10 h-10 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors sm:px-4 sm:w-auto sm:h-auto",title:"Add New Video",children:[a.jsx(ct,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline sm:ml-2",children:"Add New"})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[m&&a.jsx("div",{className:"text-center py-10",children:"Loading videos..."}),!m&&k&&a.jsx(Eb,{lessonId:i,onAdd:v,onCancel:()=>j(!1)}),!m&&!k&&p.length>0&&a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 pb-6",children:p.map(C=>a.jsx(Cb,{content:C,onRemove:()=>y(C._id),isAdmin:T},C._id))}),!m&&!k&&p.length===0&&a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(Sr,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsxs("p",{className:"mt-4 text-gray-500",children:["No videos available for this chapter.",T&&" Click 'Add New Video' to get started."]})]})]}),a.jsx(Mt,{isOpen:g.isOpen,onClose:()=>b({isOpen:!1,onConfirm:null}),onConfirm:g.onConfirm,title:"Remove Video",message:"Are you sure you want to remove this video?"})]})},Tb=({content:i,onRemove:f,isAdmin:x})=>{const[o,d]=u.useState(null),[m,g]=u.useState(!0),[b,k]=u.useState(""),j=()=>{var y,v,z,C;if(console.log("[AudioView] Getting audio source for content:",{id:i._id,type:i.type,title:i.title,hasFilePath:!!i.filePath,filePath:i.filePath,hasBody:!!i.body,bodyLength:((y=i.body)==null?void 0:y.length)||0,bodyPreview:((v=i.body)==null?void 0:v.substring(0,100))+(((z=i.body)==null?void 0:z.length)>100?"...":""),bodyStartsWith:(C=i.body)==null?void 0:C.substring(0,50)}),i.filePath&&i.filePath.trim()!==""){const E=`/api/content/${i._id}/file`;return console.log("[AudioView] Using uploaded file:",E),E}if(i.body&&i.body.trim()!==""){if(i.body.startsWith("http://")||i.body.startsWith("https://"))return console.log("[AudioView] Using external URL:",i.body),i.body;if(i.body.startsWith("data:audio/"))return console.log("[AudioView] Using base64 audio data"),i.body;try{const E=JSON.parse(i.body);if(E&&typeof E=="object")return console.log("[AudioView] Body contains JSON metadata, not using as audio source:",E),""}catch{console.log("[AudioView] Body is not JSON, checking if it might be a direct URL")}}return i.body&&i.body.startsWith("data:audio/")?(console.log("[AudioView] Using base64 audio data"),i.body):(console.warn("[AudioView] No valid audio source found for content:",i._id),"")};u.useEffect(()=>{const y=j();k(y),g(!!y),d(null)},[i]);const S=()=>{console.log("[AudioView] Audio loading started"),g(!0),d(null)},p=()=>{console.log("[AudioView] Audio can play"),g(!1),d(null)},T=y=>{const v=y.currentTarget.error,z=y.currentTarget;let C="Unknown audio error";if(console.error("[AudioView] Audio playback error details:",{error:v,src:b,currentSrc:z.currentSrc,networkState:z.networkState,readyState:z.readyState,buffered:z.buffered,duration:z.duration,errorCode:v==null?void 0:v.code,errorMessage:v==null?void 0:v.message}),v)switch(v.code){case MediaError.MEDIA_ERR_ABORTED:C="Audio loading was aborted";break;case MediaError.MEDIA_ERR_NETWORK:C="Network error while loading audio. Please check your internet connection.";break;case MediaError.MEDIA_ERR_DECODE:C="Audio file is corrupted or unsupported format. Please try converting to MP3 or WAV.";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:C="Audio format not supported or file not found. Supported formats: MP3, WAV, M4A, OGG, AAC, FLAC.";break;default:C=`Audio error: ${v.message}`}b.includes("/api/content/")&&!b.endsWith("/file")&&(C+=" (Invalid API endpoint format)"),console.error("[AudioView] Final error message:",C),g(!1),d(C)};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 relative w-full",children:[x&&a.jsx("div",{className:"absolute top-4 right-4 z-10",children:a.jsx("button",{onClick:f,className:"p-2 rounded-full bg-white/50 dark:bg-black/50 hover:bg-white/80 dark:hover:bg-black/80 backdrop-blur-sm shadow-md",title:"Remove Audio",children:a.jsx(et,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})}),a.jsx("h2",{className:"text-xl font-semibold mb-4 pr-12 truncate",children:i.title}),a.jsxs("div",{className:"w-full",children:[m&&a.jsxs("div",{className:"flex items-center justify-center py-4",children:[a.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mr-2"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading audio..."})]}),b&&a.jsx("audio",{controls:!0,className:"w-full",src:b,onLoadStart:S,onCanPlay:p,onError:T,style:{display:m?"none":"block"},children:"Your browser does not support the audio element."}),o&&a.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Audio Playback Error"}),a.jsxs("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:[a.jsx("p",{children:o}),a.jsxs("p",{className:"mt-1 text-xs",children:[a.jsx("strong",{children:"Debug Info:"})," Source: ",b||"None"," | File Path: ",i.filePath||"None"]})]}),a.jsx("div",{className:"mt-3",children:a.jsx("button",{onClick:()=>{d(null),g(!0);const y=j();k(y)},className:"text-xs bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 px-2 py-1 rounded hover:bg-red-200 dark:hover:bg-red-700",children:"Retry"})})]})]})}),!b&&!o&&!m&&a.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"No Audio Source"}),a.jsxs("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:[a.jsx("p",{children:"No valid audio source found for this content."}),a.jsxs("p",{className:"mt-1 text-xs",children:[a.jsx("strong",{children:"Content Info:"})," ID: ",i._id," | Type: ",i.type," | File Path: ",i.filePath||"None"]})]})]})]})})]})]})},zb=({lessonId:i,onAdd:f,onCancel:x})=>{const[o,d]=u.useState("upload"),[m,g]=u.useState("Loading title..."),[b,k]=u.useState(""),[j,S]=u.useState(""),[p,T]=u.useState(!1),[y,v]=u.useState(null),[z,C]=u.useState(null),[E,U]=u.useState(null),[w,N]=u.useState(""),{showToast:D}=Xe(),_=async L=>{var M;try{console.log("[AUDIO DEBUG] generateUniqueTitle called with:",{baseTitle:L,lessonId:i});const B=await tt(i,["audio"]),I=((M=B==null?void 0:B[0])==null?void 0:M.docs)||[];console.log("[AUDIO DEBUG] Existing audios found:",I.length);const G=I.map(O=>O.title.replace(/\s*\(\d+\)\s*$/,"").trim());if(console.log("[AUDIO DEBUG] Existing titles:",G),!G.includes(L))return console.log("[AUDIO DEBUG] No duplicate found, using baseTitle as both display and filename"),{displayTitle:L,fileName:L};let ee=2,V=`${L} (${ee})`;for(;G.includes(V);)ee++,V=`${L} (${ee})`;return console.log("[AUDIO DEBUG] Duplicate found, using:",{displayTitle:V,fileName:L}),{displayTitle:V,fileName:L}}catch(B){return console.error("[AUDIO DEBUG] Error generating unique title:",B),{displayTitle:L,fileName:L}}};u.useEffect(()=>{i?(async()=>{try{console.log("=== FAST AUDIO PATH GENERATION START ===");const M=await Wa(i);if(M&&M.trim()){const V=M.split(" > ").filter(O=>O.trim());if(V.length>=2){const O=V[V.length-1],q=V.join("/"),{displayTitle:J,fileName:le}=await _(O),te=`${q}/Audio/${le}.mp3`;console.log("Fast audio path from breadcrumbs:",te),g(J),S(le),k(te);return}}console.log("Breadcrumbs failed, trying fast search...");let B=!1,I=[],G="New Audio";const ee=await cl();for(const V of ee){const O=await dl(V._id);for(const q of O){const J=await ul(q._id),le=J.find(te=>te._id===i);if(le){I=[V.name,q.name,le.name],G=le.name,B=!0;break}for(const te of J){const ne=await fl(te._id),se=ne.find(re=>re._id===i);if(se){I=[V.name,q.name,te.name,se.name],G=se.name,B=!0;break}if(!B)for(const re of ne){const ae=(await ml(re._id)).find(pe=>pe._id===i);if(ae){I=[V.name,q.name,te.name,re.name,ae.name],G=ae.name,B=!0;break}}}if(B)break}if(B)break}if(B&&I.length>0){const V=I.join("/"),{displayTitle:O,fileName:q}=await _(G),J=`${V}/Audio/${q}.mp3`;console.log("Fast audio path from search:",J),g(O),S(q),k(J)}else{console.log("Quick audio fallback for:",i);const V=`Audio_${i.slice(-4)}`,{displayTitle:O,fileName:q}=await _(V),J=`Class/Audio/${q}.mp3`;g(O),S(q),k(J)}}catch(M){console.error("Fast audio path generation error:",M);const B="New Audio";g(B),S(B),k(`Default/Audio/${B}.mp3`)}})():(g("Select a lesson/unit first"),S("Audio"),k("Audio/Pending Selection"))},[i]);const K=L=>{var B;const M=(B=L.target.files)==null?void 0:B[0];if(M&&M.type.startsWith("audio/")){C(M),v(null);const I=new FileReader;I.onloadend=()=>U(I.result),I.readAsDataURL(M)}else v("Please select a valid audio file."),C(null),U(null)},X=async L=>{if(L.preventDefault(),p||!m.trim()){v("Please provide a title.");return}T(!0),v(null);try{if(o==="upload"){if(!z){v("Please select a file to upload.");return}const M=new FormData;M.append("file",z),M.append("lessonId",i),M.append("type","audio"),M.append("title",m.trim()),M.append("customFileName",j||m.trim());const B=await fetch("/api/upload",{method:"POST",body:M});if(!B.ok){const G=await B.json().catch(()=>({}));throw new Error(G.message||`Upload failed: ${B.statusText}`)}const I=await B.json();console.log("Audio uploaded successfully:",I)}else{if(!w.trim().startsWith("http")){v("Please enter a valid URL.");return}await Ut({title:m.trim(),body:w,lessonId:i,type:"audio",metadata:{category:"External",subCategory:"External Link",audioUrl:w}})}D("Audio added successfully","success"),f()}catch(M){console.error("Audio upload error:",M),v(M instanceof Error?M.message:"Failed to save audio. Please try again."),D("Failed to save audio","error")}finally{T(!1)}};return a.jsxs("div",{className:"w-full max-w-xl mx-auto bg-white dark:bg-gray-800/50 p-8 rounded-lg shadow-md mt-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-center mb-6 text-gray-800 dark:text-white",children:"Add New Audio"}),a.jsxs("div",{className:"mb-6 flex border-b border-gray-200 dark:border-gray-700",children:[a.jsx("button",{onClick:()=>d("upload"),className:`px-4 py-2 text-sm font-medium ${o==="upload"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Upload File"}),a.jsx("button",{onClick:()=>d("url"),className:`px-4 py-2 text-sm font-medium ${o==="url"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Add from URL"})]}),a.jsxs("form",{onSubmit:X,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"audioTitle",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Audio Title"}),a.jsx("input",{id:"audioTitle",type:"text",value:m,onChange:L=>g(L.target.value),required:!0,className:"mt-1 w-full px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm"}),a.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 font-mono truncate",title:b,children:["Path: ",b]})]}),o==="upload"&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"audioFile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Audio File"}),a.jsx("div",{className:"mt-1 flex items-center justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Pa,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:a.jsxs("label",{htmlFor:"audioFile",className:"relative cursor-pointer bg-transparent rounded-md font-medium text-blue-600 hover:text-blue-500",children:[a.jsx("span",{children:z?"Change file":"Upload an audio file"}),a.jsx("input",{id:"audioFile",name:"audioFile",type:"file",className:"sr-only",onChange:K,accept:"audio/*,.m4a,.mp3,.wav,.ogg,.aac,.flac,.opus,.webm,.3gp,.3ga,.wma,.aiff,.au,.gsm,.ra,.rm"})]})}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:z?z.name:"MP3, WAV, M4A, OGG, AAC, FLAC, etc."})]})})]}),o==="url"&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"audioUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Audio URL"}),a.jsx("input",{id:"audioUrl",type:"url",value:w,onChange:L=>N(L.target.value),required:!0,placeholder:"https://example.com/audio.mp3",className:"mt-1 w-full px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm"})]}),E&&o==="upload"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Preview"}),a.jsx("audio",{controls:!0,src:E,className:"w-full",children:"Your browser does not support the audio element."})]}),y&&a.jsx("p",{className:"text-sm text-red-500 dark:text-red-400",children:y}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("button",{type:"button",onClick:x,className:"flex items-center items-center justify-center p-2 w-10 h-10 bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-500 transition-colors sm:w-full sm:px-4 sm:h-auto sm:justify-start",children:[a.jsx("svg",{className:"w-5 h-5 sm:hidden",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),a.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]}),a.jsxs("button",{type:"submit",disabled:p,className:"flex items-center justify-center p-2 w-10 h-10 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors sm:w-full sm:px-4 sm:h-auto sm:justify-start",children:[p?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin sm:mr-2"}):a.jsx("svg",{className:"w-5 h-5 sm:hidden",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),a.jsx("span",{className:"hidden sm:inline",children:p?"Saving...":"Save Audio"})]})]})]})]})},Ub=({lessonId:i,user:f})=>{var z;const[x,o]=u.useState(0),{data:d,isLoading:m}=Ce(()=>tt(i,["audio"]),[i,x]),[g,b]=u.useState({isOpen:!1,onConfirm:null}),[k,j]=u.useState(!1),{showToast:S}=Xe(),p=((z=d==null?void 0:d[0])==null?void 0:z.docs)||[],T=f.role==="admin"||!!f.canEdit,y=C=>{b({isOpen:!0,onConfirm:async()=>{try{await Qt(C),o(U=>U+1),S("Audio deleted successfully","success")}catch{S("Failed to delete audio","error")}b({isOpen:!1,onConfirm:null})}})},v=()=>{o(C=>C+1),j(!1)};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 h-full flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(nc,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Audio"})]}),T&&!k&&a.jsxs("button",{onClick:()=>j(!0),className:"flex items-center justify-center p-2.5 w-10 h-10 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors sm:px-4 sm:w-auto sm:h-auto",title:"Add New Audio",children:[a.jsx(ct,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline sm:ml-2",children:"Add New"})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[m&&a.jsx("div",{className:"text-center py-10",children:"Loading audio..."}),!m&&k&&a.jsx(zb,{lessonId:i,onAdd:v,onCancel:()=>j(!1)}),!m&&!k&&p.length>0&&a.jsx("div",{className:"flex flex-col gap-6 pb-6 w-full",children:p.map(C=>a.jsx(Tb,{content:C,onRemove:()=>y(C._id),isAdmin:T},C._id))}),!m&&!k&&p.length===0&&a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(nc,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsxs("p",{className:"mt-4 text-gray-500",children:["No audio available for this chapter.",T&&" Click 'Add New Audio' to get started."]})]})]}),a.jsx(Mt,{isOpen:g.isOpen,onClose:()=>b({isOpen:!1,onConfirm:null}),onConfirm:g.onConfirm,title:"Remove Audio",message:"Are you sure you want to remove this audio file?"})]})},vr=({label:i,value:f,colorClass:x,bgClass:o})=>a.jsxs("div",{className:`${o} p-4 rounded-xl flex flex-col items-center justify-center shadow-sm border border-opacity-10 transition-transform hover:scale-105`,children:[a.jsx("span",{className:`text-3xl font-bold ${x}`,children:f}),a.jsx("span",{className:"text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mt-1 tracking-wider",children:i})]}),Mb=({percentage:i,color:f})=>{const o=2*Math.PI*50,d=o-i/100*o;return a.jsxs("div",{className:"relative w-32 h-32 flex items-center justify-center group",children:[a.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 120 120",children:[a.jsx("circle",{cx:"60",cy:"60",r:50,fill:"none",stroke:"currentColor",strokeWidth:"10",className:"text-gray-200 dark:text-gray-700 opacity-30"}),a.jsx("circle",{cx:"60",cy:"60",r:50,fill:"none",stroke:f,strokeWidth:"10",strokeDasharray:o,strokeDashoffset:d,strokeLinecap:"round",className:"transition-all duration-1000 ease-out drop-shadow-md"})]}),a.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[a.jsxs("span",{className:"text-2xl font-bold text-gray-800 dark:text-white group-hover:scale-110 transition-transform",children:[Math.round(i),"%"]}),a.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 font-medium uppercase",children:"Accuracy"})]})]})},Lb=({correct:i,wrong:f,skipped:x})=>{const o=i+f+x;if(o===0)return null;const d=i/o*360,m=f/o*360,g=`conic-gradient(#22c55e 0deg ${d}deg, #ef4444 ${d}deg ${d+m}deg, #9ca3af ${d+m}deg 360deg)`;return a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-32 h-32 rounded-full shadow-inner border-4 border-white dark:border-gray-800 transition-transform hover:scale-105",style:{background:g}}),a.jsxs("div",{className:"mt-4 flex gap-3 text-xs font-medium text-gray-600 dark:text-gray-300",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"})," Correct"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"})," Wrong"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"})," Skipped"]})]})]})},Ef=({question:i,index:f,totalQuestions:x,userAnswerIndex:o,onAnswerSelect:d,readOnly:m,showRationale:g})=>{var S;const[b,k]=u.useState(!1),j=(p,T)=>{const y="w-full text-left p-4 rounded-lg border-2 transition-all duration-200 relative group ";return o!==null?T?y+"bg-green-100 dark:bg-green-900/40 border-green-500 text-green-800 dark:text-green-100":o===p&&!T?y+"bg-red-100 dark:bg-red-900/40 border-red-500 text-red-800 dark:text-red-100 opacity-90":y+"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 opacity-50":y+"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 md:p-8 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:["Question ",f+1," ",a.jsx("span",{className:"text-gray-300 dark:text-gray-600",children:"/"})," ",x]}),o!==null&&a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${i.answerOptions[o].isCorrect?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"}`,children:i.answerOptions[o].isCorrect?"Correct":"Incorrect"})]}),a.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-gray-800 dark:text-white mb-8 leading-relaxed",dangerouslySetInnerHTML:{__html:zt(i.question)}}),a.jsx("div",{className:"space-y-4 mb-6",children:i.answerOptions.map((p,T)=>a.jsx("div",{children:a.jsx("button",{onClick:()=>!m&&o===null&&d(T),disabled:m||o!==null,className:j(T,p.isCorrect),children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:`flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center mt-0.5 transition-colors ${o!==null?p.isCorrect?"border-green-500 text-green-500":o===T?"border-red-500 text-red-500":"border-gray-300 dark:border-gray-600":"border-gray-300 dark:border-gray-600 group-hover:border-blue-500"}`,children:[o!==null&&p.isCorrect&&a.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),o===T&&!p.isCorrect&&a.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})]}),a.jsx("div",{className:"flex-1",dangerouslySetInnerHTML:{__html:zt(p.text)}})]})})},T))}),g&&o!==null&&a.jsxs("div",{className:`mt-4 p-4 rounded-lg text-sm animate-fade-in ${i.answerOptions[o].isCorrect?"bg-green-50 border border-green-100 text-green-800 dark:bg-green-900/20 dark:border-green-900 dark:text-green-300":"bg-red-50 border border-red-100 text-red-800 dark:bg-red-900/20 dark:border-red-900 dark:text-red-300"}`,children:[a.jsx("strong",{className:"block mb-2",children:i.answerOptions[o].isCorrect?" Good job!":" Not quite right."}),a.jsx("div",{dangerouslySetInnerHTML:{__html:zt(((S=i.answerOptions.find(p=>p.isCorrect))==null?void 0:S.rationale)||"No explanation provided.")}})]}),a.jsx("div",{className:"min-h-[2rem]",children:o===null&&i.hint&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>k(!b),className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1 transition-colors",children:[a.jsx("span",{className:"text-lg",children:""})," ",b?"Hide Hint":"Show Hint"]}),b&&a.jsx("div",{className:"mt-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-100 dark:border-yellow-900/50 rounded-lg animate-fade-in",children:a.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",dangerouslySetInnerHTML:{__html:zt(i.hint)}})})]})})]})},Ob=({lessonId:i,user:f})=>{const[x,o]=u.useState(0),{data:d,isLoading:m}=Ce(()=>tt(i,["quiz"]),[i,x]),[g,b]=u.useState([]),[k,j]=u.useState(null),[S,p]=u.useState([]),[T,y]=u.useState(0),[v,z]=u.useState([]),[C,E]=u.useState("list");u.useEffect(()=>{var B;const M=((B=d==null?void 0:d[0])==null?void 0:B.docs)||[];b(M),M.length===1?U(M[0]):(E("list"),j(null))},[d]);const U=M=>{if(j(M),M.body)try{const B=JSON.parse(M.body.replace(/&quot;/g,'"'));p(B),z(new Array(B.length).fill(null)),y(0),E("question")}catch(B){console.error("Failed to parse quiz JSON:",B),p([])}else p([])},w=M=>{if(v[T]!==null)return;const B=[...v];B[T]=M,z(B)},N=()=>{T<S.length-1?y(M=>M+1):E("result")},D=()=>{T>0&&y(M=>M-1)},_=()=>{y(0),z(new Array(S.length).fill(null)),E("question")},K=()=>{E("review")},X=()=>{E("list"),j(null)},L=u.useMemo(()=>{let M=0,B=0,I=0;v.forEach((V,O)=>{V===null?I++:S[O].answerOptions[V].isCorrect?M++:B++});const G=S.length,ee=G>0?M/G*100:0;return{correct:M,wrong:B,skipped:I,total:G,accuracy:ee}},[v,S]);if(m)return a.jsx("div",{className:"text-center p-8 text-gray-500",children:"Loading Quiz..."});if(g.length===0)return a.jsxs("div",{className:"p-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ja,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Quiz"})]})}),a.jsxs("div",{className:"text-center py-20 bg-white dark:bg-gray-800/50 rounded-lg shadow-inner",children:[a.jsx(Ja,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-4 text-gray-500",children:"No quiz available for this chapter."})]})]});if(C==="list")return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ja,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Select a Quiz"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(M=>a.jsxs("button",{onClick:()=>U(M),className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md hover:shadow-lg transition-all border border-gray-100 dark:border-gray-700 text-left group",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform",children:a.jsx(Ja,{className:"w-8 h-8"})}),a.jsx(Ka,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-500 transition-colors"})]}),a.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-2",children:M.title}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Click to start this quiz."})]},M._id))})]});if(C==="result"){const M=L.accuracy>=80,B=M?"#22c55e":L.accuracy>=50?"#eab308":"#ef4444";return a.jsx("div",{className:"p-4 sm:p-6 lg:p-8 flex items-center justify-center h-full overflow-y-auto",children:a.jsxs("div",{className:"max-w-4xl w-full bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl text-center relative overflow-hidden animate-fade-in",children:[M&&a.jsx(Xf,{}),a.jsx("h2",{className:"text-3xl font-extrabold mb-2 text-gray-800 dark:text-white",children:M?" Outstanding Performance!":"Quiz Completed!"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-8",children:"Here is the summary of your results."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[a.jsx("div",{className:"flex flex-col items-center justify-center space-y-6 bg-gray-50 dark:bg-gray-900/50 p-6 rounded-xl",children:a.jsxs("div",{className:"flex justify-around w-full items-center",children:[a.jsx(Mb,{percentage:L.accuracy,color:B}),a.jsx(Lb,{correct:L.correct,wrong:L.wrong,skipped:L.skipped})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 content-center",children:[a.jsx(vr,{label:"Total",value:L.total,bgClass:"bg-blue-50 dark:bg-blue-900/20",colorClass:"text-blue-600 dark:text-blue-400"}),a.jsx(vr,{label:"Correct",value:L.correct,bgClass:"bg-green-50 dark:bg-green-900/20",colorClass:"text-green-600 dark:text-green-400"}),a.jsx(vr,{label:"Wrong",value:L.wrong,bgClass:"bg-red-50 dark:bg-red-900/20",colorClass:"text-red-600 dark:text-red-400"}),a.jsx(vr,{label:"Skipped",value:L.skipped,bgClass:"bg-gray-100 dark:bg-gray-700/40",colorClass:"text-gray-600 dark:text-gray-400"})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[a.jsx("button",{onClick:K,className:"px-8 py-3 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white font-semibold rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Review Answers"}),a.jsx("button",{onClick:_,className:"px-8 py-3 bg-blue-600 text-white font-semibold rounded-xl hover:bg-blue-700 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1",children:"Try Again"}),g.length>1&&a.jsx("button",{onClick:X,className:"px-8 py-3 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 font-semibold rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Other Quizzes"})]})]})})}return C==="review"?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1 shrink-0 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Review Answers"}),a.jsx("button",{onClick:()=>E("result"),className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors",children:"Back to Results"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto max-w-4xl mx-auto w-full pb-10",children:[S.map((M,B)=>a.jsx(Ef,{question:M,index:B,totalQuestions:S.length,userAnswerIndex:v[B],onAnswerSelect:()=>{},readOnly:!0,showRationale:!0},B)),a.jsx("div",{className:"flex justify-center mt-8",children:a.jsx("button",{onClick:()=>E("result"),className:"px-8 py-3 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white font-semibold rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600",children:"Back to Summary"})})]})]}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex flex-col h-full",children:[a.jsx("div",{className:"flex justify-between items-center mb-1 shrink-0",children:a.jsxs("div",{className:"flex items-center",children:[g.length>1&&a.jsx("button",{onClick:X,className:"mr-4 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",title:"Back to Quiz List",children:a.jsx(Ka,{className:"w-5 h-5 transform rotate-180 text-gray-500"})}),a.jsx(Ja,{className:"w-8 h-8 mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:(k==null?void 0:k.title)||"Quiz"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsx(Ef,{question:S[T],index:T,totalQuestions:S.length,userAnswerIndex:v[T],onAnswerSelect:w,readOnly:!1,showRationale:!0}),a.jsxs("div",{className:"flex justify-between items-center pt-2 pb-10",children:[a.jsx("button",{onClick:D,disabled:T===0,className:"px-6 py-2.5 rounded-xl text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors shadow-sm",children:"Previous"}),a.jsxs("button",{onClick:N,className:`flex items-center gap-2 px-8 py-2.5 rounded-xl text-white font-semibold transition-all shadow-md hover:shadow-lg transform active:scale-95 ${v[T]!==null?"bg-blue-600 hover:bg-blue-700":"bg-gray-500 hover:bg-gray-600"}`,children:[a.jsx("span",{children:T===S.length-1?"Finish Quiz":"Next Question"}),a.jsx(Ka,{className:"w-4 h-4"})]})]})]})})]})},Db=["January","February","March","April","May","June","July","August","September","October","November","December"],Rb=["First Summative","Second Summative","Annual Summative"],_b=i=>i===0?"bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600 text-gray-600 dark:text-gray-300":i<=5?"bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-800 dark:to-blue-700 text-blue-700 dark:text-blue-300":i<=15?"bg-gradient-to-r from-green-100 to-green-200 dark:from-green-800 dark:to-green-700 text-green-700 dark:text-green-300":i<=30?"bg-gradient-to-r from-yellow-100 to-yellow-200 dark:from-yellow-800 dark:to-yellow-700 text-yellow-700 dark:text-yellow-300":i<=50?"bg-gradient-to-r from-orange-100 to-orange-200 dark:from-orange-800 dark:to-orange-700 text-orange-700 dark:text-orange-300":"bg-gradient-to-r from-red-100 to-red-200 dark:from-red-800 dark:to-red-700 text-red-700 dark:text-red-300",Bb=i=>i===0?"No views yet":i===1?"1 view":i<=5?`${i} views`:i<=15?`${i} views  Popular`:i<=30?`${i} views  Trending`:i<=50?`${i} views  Hot`:`${i} views  Viral`,Hb=({viewCount:i})=>{const f=_b(i),x=Bb(i);return a.jsxs("span",{className:`inline-flex items-center gap-1 text-xs px-3 py-1 rounded-full font-medium ${f} shadow-sm transition-all duration-200 hover:shadow-md transform hover:scale-105`,children:[a.jsxs("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),a.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}),a.jsx("span",{children:x})]})},qb=i=>{switch(i){case"Monthly":return"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 border-green-200 dark:border-green-800 hover:border-green-300 dark:hover:border-green-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1";case"Term Exam":return"bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/30 dark:to-cyan-900/30 border-blue-200 dark:border-blue-800 hover:border-blue-300 dark:hover:border-blue-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1";case"Model Exam":return"bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 border-purple-200 dark:border-purple-800 hover:border-purple-300 dark:hover:border-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1";case"SSLC Exam":return"bg-gradient-to-br from-red-50 to-pink-50 dark:from-red-900/30 dark:to-pink-900/30 border-red-200 dark:border-red-800 hover:border-red-300 dark:hover:border-red-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1";default:return"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 shadow-lg hover:shadow-xl transform hover:-translate-y-1"}},Vb=i=>{switch(i){case"Monthly":return"bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/50 dark:to-emerald-900/50 text-green-600 dark:text-green-400 shadow-md";case"Term Exam":return"bg-gradient-to-br from-blue-100 to-cyan-100 dark:from-blue-900/50 dark:to-cyan-900/50 text-blue-600 dark:text-blue-400 shadow-md";case"Model Exam":return"bg-gradient-to-br from-purple-100 to-violet-100 dark:from-purple-900/50 dark:to-violet-900/50 text-purple-600 dark:text-purple-400 shadow-md";case"SSLC Exam":return"bg-gradient-to-br from-red-100 to-pink-100 dark:from-red-900/50 dark:to-pink-900/50 text-red-600 dark:text-red-400 shadow-md";default:return"bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/50 dark:to-indigo-900/50 text-blue-600 dark:text-blue-400 shadow-md"}},Qb=({isOpen:i,onClose:f,onSave:x,paperToEdit:o})=>{const[d,m]=u.useState(""),[g,b]=u.useState("Monthly"),[k,j]=u.useState(""),[S,p]=u.useState(null),[T,y]=u.useState(null),[v,z]=u.useState(!1),[C,E]=u.useState("");if(u.useEffect(()=>{var D,_;i&&(o?(m(o.title),b(((D=o.metadata)==null?void 0:D.category)||"Monthly"),j(((_=o.metadata)==null?void 0:_.subCategory)||""),y(o.body)):(m(""),b("Monthly"),j(""),p(null),y(null),E("")))},[i,o]),u.useEffect(()=>{j("")},[g]),!i)return null;const U=D=>{var K;const _=(K=D.target.files)==null?void 0:K[0];if(_&&_.type==="application/pdf"){p(_),E("");const X=new FileReader;X.onloadend=()=>y(X.result),X.readAsDataURL(_)}else E("Please select a valid PDF file."),p(null),y(null)},w=async D=>{if(D.preventDefault(),!d.trim()||!T){E("Title and a PDF file are required.");return}if(g!=="SSLC Exam"&&!k.trim()){E("Please fill in the sub-category details.");return}z(!0),E("");try{const _={category:g};g!=="SSLC Exam"&&(_.subCategory=k.trim()),await x({title:d.trim(),body:T,metadata:_}),f()}catch{E("Failed to save. Please try again.")}finally{z(!1)}},N=()=>{const D="mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600";switch(g){case"Monthly":return a.jsxs(a.Fragment,{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Month"}),a.jsxs("select",{value:k,onChange:_=>j(_.target.value),required:!0,className:D,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Month"}),Db.map(_=>a.jsx("option",{value:_,children:_},_))]})]});case"Term Exam":return a.jsxs(a.Fragment,{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Term"}),a.jsxs("select",{value:k,onChange:_=>j(_.target.value),required:!0,className:D,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Term"}),Rb.map(_=>a.jsx("option",{value:_,children:_},_))]})]});case"Model Exam":return a.jsxs(a.Fragment,{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Model Name"}),a.jsx("input",{type:"text",value:k,onChange:_=>j(_.target.value),placeholder:"e.g., Model 1",required:!0,className:D})]});case"Custom":return a.jsxs(a.Fragment,{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Custom Name"}),a.jsx("input",{type:"text",value:k,onChange:_=>j(_.target.value),placeholder:"e.g., Special Test Series",required:!0,className:D})]});case"SSLC Exam":return null;default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-lg max-h-full overflow-y-auto",onClick:D=>D.stopPropagation(),children:[a.jsxs("h2",{className:"text-xl font-bold mb-4",children:[o?"Edit":"Add"," Question Paper"]}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Title"}),a.jsx("input",{type:"text",value:d,onChange:D=>m(D.target.value),required:!0,className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Category"}),a.jsxs("select",{value:g,onChange:D=>b(D.target.value),className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600",children:[a.jsx("option",{value:"Monthly",children:"Monthly"}),a.jsx("option",{value:"Term Exam",children:"Term Exam"}),a.jsx("option",{value:"Model Exam",children:"Model Exam"}),a.jsx("option",{value:"SSLC Exam",children:"SSLC Exam"}),a.jsx("option",{value:"Custom",children:"Custom"})]})]}),N(),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"PDF File"}),a.jsx("input",{type:"file",onChange:U,accept:".pdf",className:"mt-1 w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900/50 dark:file:text-blue-300 dark:hover:file:bg-blue-900"}),T&&!S&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Current PDF is retained. Upload a new file to replace it."}),S&&a.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:["New PDF selected: ",S.name]})]}),C&&a.jsx("p",{className:"text-sm text-red-500",children:C}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-md",disabled:v,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md disabled:bg-blue-400",disabled:v,children:v?"Saving...":"Save"})]})]})]})})},Fb=({lessonId:i,user:f})=>{var w;const[x,o]=u.useState(0),{data:d,isLoading:m}=Ce(()=>tt(i,["questionPaper"]),[i,x]),[g,b]=u.useState({isOpen:!1,paper:null}),[k,j]=u.useState({isOpen:!1,onConfirm:null}),[S,p]=u.useState(null),{showToast:T}=Xe(),y=((w=d==null?void 0:d[0])==null?void 0:w.docs)||[],v=f.role==="admin"||!!f.canEdit,z=u.useMemo(()=>{const N={};return[...y].sort((_,K)=>_.title.localeCompare(K.title)).forEach(_=>{const K=_.metadata,X=(K==null?void 0:K.category)||"Uncategorized",L=(K==null?void 0:K.subCategory)||"General";N[X]||(N[X]={}),N[X][L]||(N[X][L]=[]),N[X][L].push(_)}),N},[y]),C=async N=>{try{g.paper?await $a(g.paper._id,N):await Ut({...N,lessonId:i,type:"questionPaper"}),o(D=>D+1),T("Paper saved successfully!","success")}catch{T("Failed to save paper.","error")}},E=async N=>{if(!N.body.startsWith("data:application/pdf"))return;const D=N.metadata,_=(D==null?void 0:D.category)||"",K=(D==null?void 0:D.subCategory)||"",X=`${N.title} - ${_}${K?` - ${K}`:""}`;p({url:N.body,title:X});try{Jg(N._id).catch(console.error),o(L=>L+1)}catch(L){console.error("Failed to update view count",L)}},U=N=>{j({isOpen:!0,onConfirm:async()=>{try{await Qt(N),o(_=>_+1),T("Paper deleted.","error")}catch{T("Failed to delete paper.","error")}j({isOpen:!1,onConfirm:null})}})};return a.jsxs("div",{className:"p-2 sm:p-4 lg:p-6 h-full overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(wr,{className:"w-6 h-6 sm:w-8 sm:h-8 mr-2 sm:mr-3 text-blue-500"}),a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Question Papers"})]}),v&&a.jsxs("button",{onClick:()=>b({isOpen:!0,paper:null}),className:"flex items-center gap-1 sm:gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Add Paper",children:[a.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Add New"})]})]}),m&&a.jsx("div",{className:"text-center py-10",children:"Loading papers..."}),!m&&y.length===0&&a.jsxs("div",{className:"text-center py-10 bg-white dark:bg-gray-800/50 rounded-lg",children:[a.jsx(wr,{className:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600"}),a.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"No question papers available for this chapter."})]}),!m&&y.length>0&&a.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:a.jsx("div",{className:"space-y-4",children:Object.entries(z).map(([N,D])=>a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-900 rounded-lg p-2.5 sm:p-4 mb-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:a.jsxs("h2",{className:"text-lg sm:text-2xl font-bold bg-gradient-to-r from-gray-700 to-gray-900 dark:from-gray-300 dark:to-gray-100 bg-clip-text text-transparent flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"w-2 sm:w-3 h-5 sm:h-8 bg-gradient-to-b from-blue-500 to-purple-500 rounded-full"}),N]})}),a.jsx("div",{className:"space-y-3 sm:space-y-4",children:Object.entries(D).map(([_,K])=>a.jsx("div",{children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4",children:K.map(X=>{const L=X.body.startsWith("data:application/pdf"),M=X.metadata,B=(M==null?void 0:M.category)||"",I=(M==null?void 0:M.subCategory)||"",G=`${X.title} - ${B}${I?` - ${I}`:""}`,ee=qb(B),V=Vb(B);return a.jsxs("div",{className:`${ee} rounded-lg p-3 sm:p-4 lg:p-6 flex justify-between items-center group border-2 hover:shadow-2xl transition-all duration-300 animate-fade-in-up`,children:[a.jsxs("button",{onClick:()=>E(X),disabled:!L,className:"flex flex-row items-center gap-2 sm:gap-3 text-left flex-1 min-w-0 disabled:cursor-not-allowed disabled:opacity-60 w-full group-hover:scale-105 transition-transform duration-200",title:L?"View Paper":"Cannot open mock paper",children:[a.jsx("div",{className:`p-2 sm:p-3 ${V} rounded-full shrink-0 group-hover:rotate-12 transition-transform duration-200 shadow-lg`,children:a.jsx(wr,{className:"w-4 h-4 sm:w-6 sm:h-6"})}),a.jsxs("div",{className:"flex-1 min-w-0 w-full",children:[a.jsx("h3",{className:"font-bold text-sm sm:text-lg text-gray-800 dark:text-white truncate w-full leading-tight",children:G}),a.jsxs("div",{className:"flex gap-2 items-center mt-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-300 font-medium hidden sm:inline",children:"Click to view"}),X.viewCount!==void 0&&a.jsx(Hb,{viewCount:X.viewCount})]})]})]}),v&&a.jsxs("div",{className:"flex gap-1 shrink-0 opacity-0 group-hover:opacity-100 transition-all duration-300 transform group-hover:translate-x-0 translate-x-1 ml-2",children:[a.jsx("button",{onClick:()=>b({isOpen:!0,paper:X}),className:"p-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 rounded-full text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200",title:"Edit",children:a.jsx(oa,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("button",{onClick:()=>U(X._id),className:"p-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 rounded-full text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200",title:"Delete",children:a.jsx(et,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]},X._id)})})},_))})]},N))})}),a.jsx(Qb,{isOpen:g.isOpen,onClose:()=>b({isOpen:!1,paper:null}),onSave:C,paperToEdit:g.paper}),a.jsx(Mt,{isOpen:k.isOpen,onClose:()=>j({isOpen:!1,onConfirm:null}),onConfirm:k.onConfirm,title:"Delete Paper",message:"Are you sure you want to delete this question paper?"}),S&&a.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex flex-col animate-fade-in h-screen w-screen",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 bg-black/60 absolute top-0 left-0 right-0 z-50 backdrop-blur-md border-b border-white/10",children:[a.jsx("h2",{className:"text-white font-medium text-lg truncate px-4",children:S.title}),a.jsx("button",{onClick:()=>p(null),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors","aria-label":"Close fullscreen PDF viewer",children:a.jsx(ia,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"w-full h-full pt-16 pb-4 px-4",children:a.jsx(hl,{url:S.url,initialScale:1.2})})]})]})},ec=({message:i,subMessage:f})=>a.jsx("div",{className:"flex items-center justify-center h-full text-center text-gray-500 dark:text-gray-400 p-4",children:a.jsxs("div",{className:"p-8 bg-white dark:bg-gray-800/50 rounded-lg shadow-sm",children:[a.jsx("h2",{className:"text-xl font-medium",children:i}),a.jsx("p",{className:"mt-2 text-sm",children:f})]})}),Zf=({lessonId:i,selectedResourceType:f,user:x})=>{if(u.useEffect(()=>{console.log("[ContentDisplay] Props changed:",{lessonId:i,selectedResourceType:f})},[i,f]),!i)return a.jsx(ec,{message:"Select a chapter to begin",subMessage:"Use the selectors at the top to navigate to a chapter."});if(!f)return a.jsx(ec,{message:"Select a resource",subMessage:"Choose a resource type from the sidebar to view its content."});const o=()=>{switch(f){case"book":return a.jsx(Ix,{lessonId:i,user:x});case"worksheet":return a.jsx(cb,{lessonId:i,user:x});case"notes":return a.jsx(mb,{lessonId:i,user:x});case"qa":return a.jsx(yb,{lessonId:i,user:x});case"flashcard":return a.jsx(jb,{lessonId:i,user:x});case"video":return a.jsx(Ab,{lessonId:i,user:x});case"audio":return a.jsx(Ub,{lessonId:i,user:x});case"quiz":return a.jsx(Ob,{lessonId:i,user:x});case"questionPaper":return a.jsx(Fb,{lessonId:i,user:x});case"slide":return a.jsx(nb,{lessonId:i,user:x});case"activity":case"extra":return a.jsx(Sb,{lessonId:i,user:x,resourceType:f});default:return a.jsx(ec,{message:"Unknown resource type",subMessage:"This resource type is not supported."})}};return a.jsx("div",{className:"h-full overflow-hidden",children:o()})},Jf=(i,f,x=[])=>{const o=u.useRef(null),d=u.useRef(!1);u.useEffect(()=>{if(o.current&&i>0){d.current=!0,o.current.scrollTop=i;const g=setTimeout(()=>{d.current=!1},100);return()=>clearTimeout(g)}},[i,...x]);const m=u.useCallback(()=>{if(o.current&&!d.current){const g=o.current.scrollTop;g!==i&&f(g)}},[i,f]);return{scrollElementRef:o,handleScroll:m}},Kf=({className:i=""})=>{const{isNavigationRestored:f,session:x}=Rt(),[o,d]=u.useState(!1);return u.useEffect(()=>{if(f){d(!0);const g=setTimeout(()=>{d(!1)},3e3);return()=>clearTimeout(g)}},[f]),!o||!(()=>{const g=x.adminState,b=x.teacherState,k=g.classId||g.subjectId||g.unitId||g.subUnitId||g.lessonId,j=b.classId||b.subjectId||b.unitId||b.subUnitId||b.lessonId;return k||j})()||!f?null:a.jsx("div",{className:`fixed top-4 right-4 z-50 transition-all duration-300 ${i}`,children:a.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2 max-w-sm",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Selections Restored"}),a.jsx("p",{className:"text-xs opacity-90",children:"Your previous Class, Subject, Unit, and Chapter selections have been loaded."})]}),a.jsx("button",{onClick:()=>d(!1),className:"flex-shrink-0 ml-2 text-white hover:text-gray-200 transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})},Gb=()=>{const{session:i,logout:f,updateAdminState:x}=Rt(),{user:o,adminState:d}=i,m=typeof window<"u"&&window.innerWidth<640,[g,b]=u.useState(!m),[k,j]=u.useState(!m),[S,p]=u.useState(!1);u.useEffect(()=>{const L=()=>{window.innerWidth<640?(b(!1),j(!1)):(b(!0),j(!0))};return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]);const{scrollElementRef:T,handleScroll:y}=Jf(d.scrollPosition,L=>x({scrollPosition:L}),[d.classId,d.subjectId,d.unitId,d.subUnitId,d.lessonId,d.selectedResourceType,d.activePage]),v=u.useCallback(L=>{x({...L,scrollPosition:0})},[x]),z=u.useCallback(L=>{v({classId:L,subjectId:null,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null}),m&&(b(!1),j(!1))},[v,m]),C=u.useCallback(L=>{v({subjectId:L,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null}),m&&(b(!1),j(!1))},[v,m]),E=u.useCallback(L=>{v({unitId:L,subUnitId:null,lessonId:null,selectedResourceType:null}),m&&(b(!1),j(!1))},[v,m]),U=u.useCallback(L=>{v({subUnitId:L,lessonId:null,selectedResourceType:null}),m&&(b(!1),j(!1))},[v,m]),w=u.useCallback(L=>{v({lessonId:L,selectedResourceType:L?"book":null}),m&&(b(!1),j(!1))},[v,m]),N=u.useCallback(L=>{v({selectedResourceType:L}),m&&(b(!1),j(!1))},[v,m]),D=u.useCallback(L=>{v({activePage:L}),m&&(b(!1),j(!1))},[v,m]),_=u.useCallback(()=>{p(!S)},[S]);if(!o)return null;const K=o.role==="admin",X=()=>{if(S)return a.jsx("div",{className:"h-full overflow-y-auto",children:a.jsx(Vf,{user:o,onBack:()=>p(!1)})});switch(d.activePage){case"browser":return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx(cc,{classId:d.classId,subjectId:d.subjectId,unitId:d.unitId,subUnitId:d.subUnitId,lessonId:d.lessonId,onClassChange:z,onSubjectChange:C,onUnitChange:E,onSubUnitChange:U,onLessonChange:w}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(Zf,{lessonId:d.lessonId,selectedResourceType:d.selectedResourceType,user:o})})]});case"course-structure":return K?a.jsx(zx,{}):a.jsx("div",{className:"p-8 text-center",children:"Access Denied"});case"quiz-configuration":return a.jsx(Vx,{});case"user-management":return K?a.jsx(Hx,{}):a.jsx("div",{className:"p-8 text-center",children:"Access Denied"});case"collections-management":return K?a.jsx(Fx,{}):a.jsx("div",{className:"p-8 text-center",children:"Access Denied"});case"reports":return a.jsx(Qx,{});default:return a.jsx(Ax,{title:d.activePage})}};return a.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",children:[a.jsx(Bf,{user:o,onToggleSidebar:()=>b(!g),onToggleAdminSidebar:()=>j(!k),onLogout:f,onProfile:_}),a.jsx(Kf,{}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[d.activePage==="browser"&&a.jsx(_f,{lessonId:d.lessonId,selectedResourceType:d.selectedResourceType,onSelectResourceType:N,isOpen:g}),a.jsx("main",{ref:T,onScroll:y,className:"flex-1 flex flex-col bg-gray-100 dark:bg-gray-800 overflow-y-auto relative transition-all duration-300 border-l border-gray-200 dark:border-gray-700 h-full",children:X()}),a.jsx(Ex,{isOpen:k,activePage:d.activePage,setActivePage:D,userRole:o.role})]})]})},Yb=()=>{const{session:i,logout:f,updateTeacherState:x}=Rt(),{user:o,teacherState:d}=i,[m,g]=u.useState(!1),[b,k]=u.useState(!1);u.useEffect(()=>{console.log("[TeacherView] Navigation state changed:",{classId:d.classId,subjectId:d.subjectId,unitId:d.unitId,subUnitId:d.subUnitId,lessonId:d.lessonId,selectedResourceType:d.selectedResourceType})},[d]);const j=typeof window<"u"&&window.innerWidth<768,{scrollElementRef:S,handleScroll:p}=Jf(d.scrollPosition,N=>x({scrollPosition:N}),[d.classId,d.subjectId,d.unitId,d.subUnitId,d.lessonId,d.selectedResourceType]),T=u.useCallback(N=>{x({...N,scrollPosition:0})},[x]),y=u.useCallback(N=>{T({classId:N,subjectId:null,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null})},[T]),v=u.useCallback(N=>{T({subjectId:N,unitId:null,subUnitId:null,lessonId:null,selectedResourceType:null})},[T]),z=u.useCallback(N=>{T({unitId:N,subUnitId:null,lessonId:null,selectedResourceType:null})},[T]),C=u.useCallback(N=>{T({subUnitId:N,lessonId:null,selectedResourceType:null})},[T]),E=u.useCallback(N=>{console.log("[TeacherView] Lesson changed:",{newLessonId:N,previousLessonId:d.lessonId}),T({lessonId:N,selectedResourceType:N?"book":null})},[T,d.lessonId]),U=u.useCallback(N=>{T({selectedResourceType:N}),j&&g(!1)},[T,j]),w=u.useCallback(()=>{k(!b)},[b]);return o?a.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",children:[a.jsx(Bf,{user:o,onToggleSidebar:()=>g(!m),onLogout:f,onProfile:w}),a.jsx(Kf,{}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(_f,{lessonId:d.lessonId,selectedResourceType:d.selectedResourceType,onSelectResourceType:U,isOpen:m}),a.jsx("main",{ref:S,onScroll:p,className:"flex-1 flex flex-col bg-gray-100 dark:bg-gray-800 overflow-y-auto relative transition-all duration-300 border-l border-gray-200 dark:border-gray-700 h-full",children:b?a.jsx("div",{className:"h-full overflow-y-auto",children:a.jsx(Vf,{user:o,onBack:()=>k(!1)})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"shrink-0",children:a.jsx(cc,{classId:d.classId,subjectId:d.subjectId,unitId:d.unitId,subUnitId:d.subUnitId,lessonId:d.lessonId,onClassChange:y,onSubjectChange:v,onUnitChange:z,onSubUnitChange:C,onLessonChange:E})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(Zf,{lessonId:d.lessonId,selectedResourceType:d.selectedResourceType,user:o})})]})})]})]}):null},Xb=()=>{const{session:i,updateProfile:f}=Rt(),x=i.user,[o,d]=u.useState(""),[m,g]=u.useState(""),[b,k]=u.useState(""),[j,S]=u.useState(null),[p,T]=u.useState(!1),y=async z=>{if(z.preventDefault(),!x){S("User session not found.");return}if(o!==m){S("Passwords do not match.");return}if(o.length<3){S("Password must be at least 3 characters long.");return}if(!b||b.trim().length===0){S("Mobile number is required.");return}if(!/^\d{10}$/.test(b.trim())){S("Please enter a valid 10-digit mobile number.");return}S(null),T(!0);try{const C=await ex(x._id,{password:o,mobileNumber:b.trim()});f(C)}catch(C){C instanceof Error?S(C.message):S("An unknown error occurred.")}finally{T(!1)}},v="mt-1 w-full px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500";return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-800 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"w-full max-w-md p-6 sm:p-8 space-y-6 bg-white dark:bg-gray-900 rounded-2xl shadow-xl",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-800 dark:text-white",children:"Update Your Profile"}),a.jsx("p",{className:"mt-2 text-sm sm:text-base text-gray-500 dark:text-gray-400",children:"For security, please update your password and add a mobile number."})]}),a.jsxs("form",{className:"space-y-4",onSubmit:y,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),a.jsx("input",{type:"password",value:o,onChange:z=>d(z.target.value),required:!0,className:v,placeholder:"Enter new password"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),a.jsx("input",{type:"password",value:m,onChange:z=>g(z.target.value),required:!0,className:v,placeholder:"Re-enter password"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mobile Number"}),a.jsx("input",{type:"tel",value:b,onChange:z=>k(z.target.value),required:!0,className:v,placeholder:"Enter 10-digit mobile number",maxLength:10,pattern:"[0-9]{10}"})]}),j&&a.jsx("div",{className:"p-3 text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md",children:j}),a.jsx("button",{type:"submit",disabled:p,className:"w-full px-4 py-3 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-900 transition-transform transform hover:scale-105 disabled:bg-blue-400 disabled:cursor-wait disabled:transform-none",children:p?"Updating...":"Update and Continue"})]})]})})},Zb=()=>{["learningPlatformNavigation","learningPlatformLastActivity","learningPlatformRestartDetected"].forEach(f=>{try{localStorage.removeItem(f)}catch(x){console.warn(`Failed to remove ${f} from localStorage:`,x)}})},Jb=()=>{var i,f,x,o;try{const d=localStorage.getItem("learningPlatformNavigation"),m=localStorage.getItem("learningPlatformLastActivity");if(!d||!m)return{hasStoredState:!1,lastUpdated:0,sessionExpired:!1,hasValidIds:!1};const g=JSON.parse(d),b=parseInt(m,10),k=Date.now(),j=1800*1e3,S=k-b>j,p=!!((i=g==null?void 0:g.adminState)!=null&&i.classId||(f=g==null?void 0:g.teacherState)!=null&&f.classId||(x=g==null?void 0:g.adminState)!=null&&x.lessonId||(o=g==null?void 0:g.teacherState)!=null&&o.lessonId);return{hasStoredState:!0,lastUpdated:(g==null?void 0:g.lastUpdated)||0,sessionExpired:S,hasValidIds:p}}catch(d){return console.error("Failed to get navigation storage info:",d),{hasStoredState:!1,lastUpdated:0,sessionExpired:!0,hasValidIds:!1}}},Kb=()=>{Zb(),window.location.reload()},$b=()=>{const i=Jb();console.group(" Navigation State Debug Info"),console.log("Storage Info:",i);try{const f=localStorage.getItem("learningPlatformNavigation");if(f){const o=JSON.parse(f);console.log("Stored Navigation State:",o)}else console.log("No stored navigation state found");const x=localStorage.getItem("learningPlatformLastActivity");if(x){const o=new Date(parseInt(x,10));console.log("Last Activity:",o.toLocaleString())}}catch(f){console.error("Error reading navigation state:",f)}console.groupEnd()},Wb=()=>{const i=f=>{f.ctrlKey&&f.shiftKey&&f.key==="N"&&(f.preventDefault(),$b()),f.ctrlKey&&f.shiftKey&&f.key==="C"&&(f.preventDefault(),confirm("Clear all navigation data and reload page?")&&Kb())};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},Pb=()=>{const{session:i}=Rt(),f=i.user;return f?f.isFirstLogin?a.jsx(Xb,{}):f.role==="admin"||f.role==="teacher"&&f.canEdit?a.jsx(Gb,{}):a.jsx(Yb,{}):a.jsx(dx,{})},Ib=()=>(Vt.useEffect(()=>Wb(),[]),a.jsx(ox,{children:a.jsxs(Dx,{children:[" ",a.jsx(Pb,{})]})})),$f=document.getElementById("root");if(!$f)throw new Error("Could not find root element to mount to");const ey=Tg.createRoot($f);ey.render(a.jsx(Vt.StrictMode,{children:a.jsx(Ib,{})}));
